

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Le guide complet de l&#39;Architecture de Composants de Zope &mdash; Plone pour les développeurs 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/translations.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Recherchez dans Plone pour les développeurs 1.0.0 documentation"
          href="_static/opensearch.xml"/>
    <link rel="top" title="Plone pour les développeurs 1.0.0 documentation" href="index.html" />
    <link rel="next" title="Le langage ZCML" href="zcml/index.html" />
    <link rel="prev" title="Programmation ZODB" href="zodb/prog-zodb.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="Index général"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="zcml/index.html" title="Le langage ZCML"
             accesskey="N">suivant</a> |</li>
        <li class="right" >
          <a href="zodb/prog-zodb.html" title="Programmation ZODB"
             accesskey="P">précédent</a> |</li>
        <li><a href="index.html">Formation Plone</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="le-guide-complet-de-l-architecture-de-composants-de-zope">
<span id="guide-zca"></span><h1>Le guide complet de l'Architecture de Composants de Zope<a class="headerlink" href="#le-guide-complet-de-l-architecture-de-composants-de-zope" title="Lien permanent vers ce titre">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body">Baiju M</td>
</tr>
<tr class="field-even field"><th class="field-name">Version:</th><td class="field-body">0.5.8</td>
</tr>
<tr class="field-odd field"><th class="field-name">Printed Book:</th><td class="field-body"><a class="reference external" href="http://www.lulu.com/content/1561045">http://www.lulu.com/content/1561045</a></td>
</tr>
<tr class="field-even field"><th class="field-name">Online PDF:</th><td class="field-body"><a class="reference external" href="http://www.muthukadan.net/docs/zca.pdf">http://www.muthukadan.net/docs/zca.pdf</a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Traducteur:</th><td class="field-body">Christophe Combelles &lt;<a class="reference external" href="mailto:ccomb&#37;&#52;&#48;free&#46;fr">ccomb<span>&#64;</span>free<span>&#46;</span>fr</a>&gt;, Stéphane Klein &lt;<a class="reference external" href="mailto:stephane&#37;&#52;&#48;harobed&#46;org">stephane<span>&#64;</span>harobed<span>&#46;</span>org</a>&gt;</td>
</tr>
<tr class="field-even field"><th class="field-name">Révision:</th><td class="field-body"><a class="reference external" href="http://bazaar.launchpad.net/~ccomb/zcadoc/book-fr/revision/109">http://bazaar.launchpad.net/~ccomb/zcadoc/book-fr/revision/109</a></td>
</tr>
</tbody>
</table>
<p>Copyright (C) 2007,2008,2009 Baiju M &lt;baiju.m.mail AT gmail.com&gt;.</p>
<p>Chacun est autorisé à copier, distribuer et/ou modifier ce document
suivant les termes de la « GNU Free Documentation License », version 1.3
ou toute version ultérieure publiée par la Free Software
Foundation.</p>
<p>Le code source présent dans ce document est soumis aux conditions de
la « Zope Public License », Version 2.1 (ZPL).</p>
<p>THE SOURCE CODE IN THIS DOCUMENT AND THE DOCUMENT ITSELF IS PROVIDED
&quot;AS IS&quot; AND ANY AND ALL EXPRESS OR IMPLIED WARRANTIES ARE DISCLAIMED,
INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF TITLE,
MERCHANTABILITY, AGAINST INFRINGEMENT, AND FITNESS FOR A PARTICULAR
PURPOSE.</p>
<div class="sidebar">
<p class="first sidebar-title">Remerciements</p>
<p class="last">De nombreuses personnes m'ont aidé à écrire ce livre. Le brouillon initial a
été relu par mon collègue Brad Allen. Quand j'ai annoncé ce livre sur mon
blog, j'ai reçu de nombreux encouragements pour poursuivre ce travail. Kent
Tenney a modifié de nombreuses parties du livre et a également réécrit
l'application servant d'exemple. De nombreuses autres personnes m'ont envoyé
des corrections et des commentaires, dont Lorenzo Gil Sanchez, Michael
Haubenwallner, Nando Quintana, Stephane Klein, Tim Cook, Kamal Gill et Thomas
Herve. Lorenzo a traduit ce travail en espagnol et Stephane initié la
traduction en français. Merci à toutes ces personnes !</p>
</div>
<div class="section" id="mise-en-route">
<h2>Mise en route<a class="headerlink" href="#mise-en-route" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="introduction">
<h3>Introduction<a class="headerlink" href="#introduction" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le développement de grands systèmes logiciels est toujours une tâche ardue
L'expérience montre que l'approche orientée objet est bien appropriée à
l'analyse, à la modélisation et à la programmation des systèmes complexes. La
conception orientée composants et la programmation basée sur des composants
deviennent actuellement très populaires. L'approche basée composants est d'une
grande aide pour l'écriture et la maintenance de systèmes logiciels et
de leurs tests unitaires. Il existe de nombreux frameworks permettant la
conception basée sur des composants dans différents langages, certains étant
même indépendants du langage. On peut citer comme exemple : COM de Microsoft, ou
XPCOM de Mozilla.</p>
<p>La <strong>Zope Component Architecture (ZCA)</strong> est un framework en Python qui autorise
la conception et la programmation basée sur des composants. Elle est très bien
adaptée au développement de grands systèmes logiciels. La ZCA n'est
pas liée au serveur d'application Zope : elle peut être utilisée pour développer
n'importe quelle application en Python. Peut-être devrait-elle s'appeler la «
Python Component Architecture ».</p>
<p>Le but de la ZCA est d'utiliser des objets Python de manière efficace. Les
composants sont des objets réutilisables fournissant une interface que l'on peut
introspecter. Une interface est un objet qui décrit comment on peut travailler
avec un composant particulier. Autrement dit, un composant fournit une interface
implémentée dans une classe ou tout autre objet appelable (<em>callable</em>). La façon
dont le composant est implémenté n'a pas d'importance : ce qui compte est que
celui-ci soit en accord avec l'interface. Grâce à la ZCA, vous pouvez éclater la
complexité d'un système dans plusieurs composants travaillant ensemble. Elle
vous aide à créer notamment deux types de composants : les « adaptateurs » et les «
utilitaires ».</p>
<p>Trois paquets composent la ZCA :</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">zope.interface</span></tt> est utilisé pour la définition d'une interface.</li>
<li><tt class="docutils literal"><span class="pre">zope.event</span></tt> fournit un système simple d'événements.</li>
<li><tt class="docutils literal"><span class="pre">zope.component</span></tt> sert à la création, l'inscription et la récupération des
composants.</li>
</ul>
</div></blockquote>
<p>Souvenez-vous que la ZCA ne fournit pas de composants par elle-même. Elle n'a
pour but que de créer, inscrire et récupérer des composants. Gardez également à
l'esprit qu'un adaptateur est une classe Python tout à fait normale (en général
une fabrique) et qu'un utilitaire est un simple objet Python appelable.</p>
<p>Le framework ZCA est développé comme une partie du projet Zope 3. Comme
mentionné plus haut, c'est un framework purement Python et il peut être utilisé
dans n'importe quelle application Python. Actuellement, Zope 3, Zope 2 et Grok
l'utilisent abondamment. De nombreux autres projets l'utilisent, y compris des
applications non liées au web <a class="footnote-reference" href="#projects" id="id1">[1]</a>.</p>
<table class="docutils footnote" frame="void" id="projects" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><a class="reference external" href="http://wiki.zope.org/zope3/ComponentArchitecture">http://wiki.zope.org/zope3/ComponentArchitecture</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="petit-historique">
<h3>Petit historique<a class="headerlink" href="#petit-historique" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le développement de la ZCA a débuté en 2001 dans le cadre du projet Zope 3. Ce
framework est le fruit de l'expérience acquise pendant le développement
d'applications d'envergure avec Zope 2. Jim Fulton est le père de ce projet. De
nombreuses personnes ont participé à sa conception et à son implémentation,
notamment Stephan Richter, Philipp von Weitershausen, Guido van Rossum (<em>aka.
Python BDFL</em>), Tres Seaver, Phillip J Eby et Martijn Faassen.</p>
<p>À ses débuts, la ZCA définissait des types de composants supplémentaires : les
<em>services</em> et les <em>vues</em>, mais les développeurs ont fini par réaliser qu'un
<em>utilitaire</em> peut remplacer un <em>service</em> et qu'un <em>multi-adaptateur</em> peut
remplacer une <em>vue</em>. Aujourd'hui, la ZCA comporte un nombre très réduit de types
de composants de base : les <em>utilitaires</em> (en anglais <em>utilities</em>), les <em>adaptateurs</em>
(<em>adapters</em>), les <em>abonnés</em> (<em>subscribers</em>) et les <em>gestionnaires</em> (<em>handlers</em>).
Et encore, les <em>abonnés</em> et les <em>gestionnaires</em> sont des cas particuliers de
l'<em>adaptateur</em>.</p>
<p>Pendant le cycle de développement de Zope 3.2, Jim Fulton a proposé une
importante simplification de la ZCA <a class="footnote-reference" href="#proposal" id="id2">[2]</a>. Grâce à cette simplification,
une nouvelle interface unique (<cite>IComponentRegistry</cite>) a été créée pour
l'inscription des composants globaux et locaux.</p>
<table class="docutils footnote" frame="void" id="proposal" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[2]</a></td><td><a class="reference external" href="http://wiki.zope.org/zope3/LocalComponentManagementSimplification">http://wiki.zope.org/zope3/LocalComponentManagementSimplification</a></td></tr>
</tbody>
</table>
<p>Le paquet <tt class="docutils literal"><span class="pre">zope.component</span></tt> avait une longue liste de dépendances, dont une
grande partie n'était pas nécessaire pour une application non liée à Zope 3.
Pendant PyCon 2007, Jim Fulton a ajouté la fonctionnalité <cite>extras_require</cite> à
setuptools pour permettre d'extraire le cœur de la ZCA des fonctionnalités
annexes <a class="footnote-reference" href="#extras" id="id3">[3]</a>.</p>
<table class="docutils footnote" frame="void" id="extras" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[3]</a></td><td><a class="reference external" href="http://peak.telecommunity.com/DevCenter/setuptools#declaring-dependencies">http://peak.telecommunity.com/DevCenter/setuptools#declaring-dependencies</a></td></tr>
</tbody>
</table>
<p>En mars 2009, Tres Seaver a supprimé les dépendances à <tt class="docutils literal"><span class="pre">zope.deferredimport</span></tt> et
<tt class="docutils literal"><span class="pre">zope.proxy</span></tt>.</p>
<p>Aujourd'hui, le projet ZCA est indépendant et possède son propre cycle de
publications et son propre dépôt Subversion. Il est fourni avec le framework
Zope. <a class="footnote-reference" href="#framework" id="id4">[4]</a>. Cependant, les anomalies et les bogues sont toujours pris
en charge au travers du projet Zope 3 <a class="footnote-reference" href="#bugs" id="id5">[5]</a> et la liste de diffusion
zope-dev est utilisée pour débattre du développement <a class="footnote-reference" href="#discussions" id="id6">[6]</a>. Il existe
également une liste pour les utilisateurs de Zope 3 (<cite>zope3-users</cite>) qui peut
être utilisée pour toute demande au sujet de la ZCA <a class="footnote-reference" href="#z3users" id="id7">[7]</a>.</p>
<table class="docutils footnote" frame="void" id="framework" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[4]</a></td><td><a class="reference external" href="http://docs.zope.org/zopeframework/">http://docs.zope.org/zopeframework/</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="bugs" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[5]</a></td><td><a class="reference external" href="https://bugs.launchpad.net/zope3">https://bugs.launchpad.net/zope3</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="discussions" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[6]</a></td><td><a class="reference external" href="http://mail.zope.org/mailman/listinfo/zope-dev">http://mail.zope.org/mailman/listinfo/zope-dev</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="z3users" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[7]</a></td><td><a class="reference external" href="http://mail.zope.org/mailman/listinfo/zope3-users">http://mail.zope.org/mailman/listinfo/zope3-users</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les paquets <tt class="docutils literal"><span class="pre">zope.component</span></tt>, <tt class="docutils literal"><span class="pre">zope.interface</span></tt> et <tt class="docutils literal"><span class="pre">zope.event</span></tt> constituent
le cœur de la <em>Zope Component Architecture</em>. Ils fournissent des outils
permettant de définir, inscrire et rechercher des composants. Le paquet
<tt class="docutils literal"><span class="pre">zope.component</span></tt> et ses dépendances sont disponibles sous forme d'<em>egg</em> dans
l'index des paquets Python (PyPI) <a class="footnote-reference" href="#pypi" id="id8">[8]</a>.</p>
<table class="docutils footnote" frame="void" id="pypi" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[8]</a></td><td>Dépôt des paquets Python : <a class="reference external" href="http://pypi.python.org/pypi">http://pypi.python.org/pypi</a></td></tr>
</tbody>
</table>
<p>Vous pouvez installer <tt class="docutils literal"><span class="pre">zope.component</span></tt> et ses dépendances avec <cite>easy_install</cite>
<a class="footnote-reference" href="#easyinstall" id="id9">[9]</a></p>
<div class="highlight-python"><pre>$ easy_install zope.component</pre>
</div>
<table class="docutils footnote" frame="void" id="easyinstall" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[9]</a></td><td><a class="reference external" href="http://peak.telecommunity.com/DevCenter/EasyInstall">http://peak.telecommunity.com/DevCenter/EasyInstall</a></td></tr>
</tbody>
</table>
<p>Cette commande télécharge <tt class="docutils literal"><span class="pre">zope.component</span></tt> et ses dépendances depuis PyPI et
l'installe dans votre <em>Python path</em>.</p>
<p>Une autre manière de procéder est de télécharger <tt class="docutils literal"><span class="pre">zope.component</span></tt> et ses
dépendances depuis PyPI et de les installer. Il faut installer les paquets dans
l'ordre donné ci-dessous. Sous Windows, vous aurez probablement besoin du paquet
binaire de <tt class="docutils literal"><span class="pre">zope.interface</span></tt>.</p>
<blockquote>
<div><ol class="arabic simple">
<li><tt class="docutils literal"><span class="pre">zope.interface</span></tt></li>
<li><tt class="docutils literal"><span class="pre">zope.event</span></tt></li>
<li><tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
</ol>
</div></blockquote>
<p>Pour installer ces paquet, après téléchargement, vous pouvez utiliser la
commande <tt class="docutils literal"><span class="pre">easy_install</span></tt> avec les eggs comme argument (éventuellement en
fournissant tous les eggs sur la même ligne de commande)</p>
<div class="highlight-python"><pre>$ easy_install /path/to/zope.interface-3.x.x.tar.gz
$ easy_install /path/to/zope.event-3.x.x.tar.gz
$ easy_install /path/to/zope.component-3.x.x.tar.gz</pre>
</div>
<p>Vous pouvez aussi installer ces paquets en les décompressant séparément. Par
exemple</p>
<div class="highlight-python"><pre>$ tar zxvf /path/to/zope.interface-3.x.x.tar.gz
$ cd zope.interface-3.x.x
$ python setup.py build
$ python setup.py install</pre>
</div>
<p>Ces méthodes installeront la ZCA dans votre <em>Python système</em>, dans le dossier
<tt class="docutils literal"><span class="pre">site-packages</span></tt>, ce qui peut être problématique. Dans un message sur la liste
de diffusion Zope 3, Jim Fulton déconseille d'utiliser le Python système
<a class="footnote-reference" href="#systempython" id="id10">[10]</a>. Vous pouvez utiliser <tt class="docutils literal"><span class="pre">virtualenv</span></tt> ou <tt class="docutils literal"><span class="pre">zc.buildout</span></tt> pour
jouer avec n'importe quel paquet Python, et également pour les déploiements.</p>
<table class="docutils footnote" frame="void" id="systempython" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[10]</a></td><td><a class="reference external" href="http://article.gmane.org/gmane.comp.web.zope.zope3/21045">http://article.gmane.org/gmane.comp.web.zope.zope3/21045</a></td></tr>
</tbody>
</table>
<div class="admonition attention">
<p class="first admonition-title">Attention</p>
<p class="last">Cette installation n'est nécessaire que pour effectuer les exercices proposés
ci-après. Zope - donc Plone - intègre en standard les composants requis.</p>
</div>
</div>
<div class="section" id="methode-pour-experimenter">
<h3>Méthode pour expérimenter<a class="headerlink" href="#methode-pour-experimenter" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il existe deux approches populaires en Python pour construire un environnement
de travail isolé. La première est <tt class="docutils literal"><span class="pre">virtualenv</span></tt> créé par Ian Biking, la
deuxième est <tt class="docutils literal"><span class="pre">zc.buildout</span></tt> créé par Jim Fulton. Il est même possible
d'utiliser ces paquets ensemble. Ils vous aideront à installer
<tt class="docutils literal"><span class="pre">zope.component</span></tt> et d'autres dépendances dans un environnement de
développement isolé. Passer un peu de temps à se familiariser avec ces outils
vous sera bénéfique lors des développements et des déploiements.</p>
<p><strong>virtualenv</strong></p>
<p>Vous pouvez installer <tt class="docutils literal"><span class="pre">virtualenv</span></tt> grâce à <tt class="docutils literal"><span class="pre">easy_install</span></tt></p>
<div class="highlight-python"><pre>$ easy_install virtualenv</pre>
</div>
<p>Puis vous pouvez créer un nouvel environnement de cette façon</p>
<div class="highlight-python"><pre>$ virtualenv --no-site-packages myve</pre>
</div>
<p>Ceci crée un nouvel environnement virtuel dans le dossier <tt class="docutils literal"><span class="pre">myve</span></tt>.
Maintenant, depuis ce dossier, vous pouvez installer <tt class="docutils literal"><span class="pre">zope.component</span></tt> et ses
dépendances avec le script <tt class="docutils literal"><span class="pre">easy_install</span></tt> situé dans <tt class="docutils literal"><span class="pre">myve/bin</span></tt></p>
<div class="highlight-python"><pre>$ cd myve
$ ./bin/easy_install zope.component</pre>
</div>
<p>Ensuite vous pouvez importer <tt class="docutils literal"><span class="pre">zope.interface</span></tt> et <tt class="docutils literal"><span class="pre">zope.component</span></tt> depuis
le nouvel interprète <tt class="docutils literal"><span class="pre">python</span></tt> situé dans <tt class="docutils literal"><span class="pre">myve/bin</span></tt></p>
<div class="highlight-python"><pre>$ ./bin/python</pre>
</div>
<p>Cette commande démarre un interprète Python que vous pourrez utiliser pour
lancer le code de ce livre.</p>
<p><strong>zc.buildout</strong></p>
<p>En combinant <tt class="docutils literal"><span class="pre">zc.buildout</span></tt> et la recette <tt class="docutils literal"><span class="pre">zc.recipe.egg</span></tt>, vous pouvez créer
un interprète Python ayant accès aux eggs Python spécifiés. Tout d'abord,
installez <tt class="docutils literal"><span class="pre">zc.buildout</span></tt> grâce à la commande <tt class="docutils literal"><span class="pre">easy_install</span></tt> (vous pouvez le
faire à l'intérieur de l'environnement virtuel). Pour créer un nouveau
<em>buildout</em> servant à expérimenter des eggs Python, commencez par créer un
dossier, puis initialisez-le grâce à la commande <tt class="docutils literal"><span class="pre">buildout</span> <span class="pre">init</span></tt></p>
<div class="highlight-python"><pre>$ mkdir mybuildout
$ cd mybuildout
$ buildout init</pre>
</div>
<p>De cette façon, le dossier <tt class="docutils literal"><span class="pre">mybuildout</span></tt> devient un « buildout ». Le fichier de
configuration de buildout est par défaut <cite>buildout.cfg</cite>. Après initialisation,
il doit contenir les lignes suivantes</p>
<div class="highlight-python"><pre>[buildout]
parts =</pre>
</div>
<p>Vous pouvez le modifier pour qu'il corresponde à ceci</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="n">buildout</span><span class="p">]</span>
<span class="n">parts</span> <span class="o">=</span> <span class="n">py</span>

<span class="p">[</span><span class="n">py</span><span class="p">]</span>
<span class="n">recipe</span> <span class="o">=</span> <span class="n">zc</span><span class="o">.</span><span class="n">recipe</span><span class="o">.</span><span class="n">egg</span>
<span class="n">interpreter</span> <span class="o">=</span> <span class="n">python</span>
<span class="n">eggs</span> <span class="o">=</span> <span class="n">zope</span><span class="o">.</span><span class="n">component</span>
</pre></div>
</div>
<p>Si maintenant vous lancez la commande <tt class="docutils literal"><span class="pre">buildout</span></tt> disponible à l'intérieur du
dossier <tt class="docutils literal"><span class="pre">mybuildout/bin</span></tt>, vous obtiendrez un nouvel interprète Python dans le
dossier <tt class="docutils literal"><span class="pre">mybuildout/bin</span></tt></p>
<div class="highlight-python"><pre>$ ./bin/buildout
$ ./bin/python</pre>
</div>
<p>Cette commande démarre un interprète Python que vous pourrez utiliser pour
lancer le code de ce livre.</p>
</div>
</div>
<div class="section" id="un-exemple">
<h2>Un exemple<a class="headerlink" href="#un-exemple" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="id11">
<h3>Introduction<a class="headerlink" href="#id11" title="Lien permanent vers ce titre">¶</a></h3>
<p>Imaginez une application servant à enregistrer les clients d'un hôtel. En
Python, il est possible de faire ceci de différentes manières. Nous allons
commencer par étudier rapidement la méthode procédurale, puis nous diriger vers
une approche basique orientée objet. En examinant l'approche orientée objet,
nous verrons comment nous pouvons bénéficier des motifs de conception
<cite>adaptateur</cite> et <cite>interface</cite>. Cela nous fera entrer dans le monde de la Zope
Component Architecture.</p>
</div>
<div class="section" id="approche-procedurale">
<h3>Approche procédurale<a class="headerlink" href="#approche-procedurale" title="Lien permanent vers ce titre">¶</a></h3>
<p>Dans toute application professionnelle, le stockage des données est un point
critique. Pour une question de simplicité, cet exemple utilise un simple
dictionnaire Python comme méthode de stockage. Nous allons générer des
identifiants uniques pour le dictionnaire, la valeur associée sera elle-même un
dictionnaire contenant les détails de l'enregistrement.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">bookings_db</span> <span class="o">=</span> <span class="p">{}</span> <span class="c">#key: unique ID, value: details in a dictionary</span>
</pre></div>
</div>
<p>Une implémentation minimaliste nécessite une fonction à laquelle on transmet les
détails de l'enregistrement et une fonction annexe qui fournit les
identifiants uniques utilisés comme clés du dictionnaire de stockage.</p>
<p>Nous pouvons obtenir un identifiant unique de cette façon</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">get_next_id</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">db_keys</span> <span class="o">=</span> <span class="n">bookings_db</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">db_keys</span> <span class="o">==</span> <span class="p">[]:</span>
<span class="gp">... </span>        <span class="n">next_id</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">... </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">next_id</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">db_keys</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">next_id</span>
</pre></div>
</div>
<p>Comme vous pouvez voir, l'implémentation de la fonction <cite>get_next_id</cite> est très
simple. La fonction récupère une liste de clés et vérifie si la liste est vide.
Si c'est le cas, nous savons que nous en sommes au premier enregistrement et
nous renvoyons <cite>1</cite>. Sinon, nous ajoutons <cite>1</cite> à la valeur maximale de la liste et
nous renvoyons la nouvelle valeur en résultant.</p>
<p>Ensuite, pour créer des enregistrements dans le dictionnaire bookings_db, nous
utilisons la fonction suivante</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">book_room</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">place</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">next_id</span> <span class="o">=</span> <span class="n">get_next_id</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">bookings_db</span><span class="p">[</span><span class="n">next_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s">&#39;room&#39;</span><span class="p">:</span> <span class="n">place</span>
<span class="gp">... </span>    <span class="p">}</span>
</pre></div>
</div>
<p>Une application de gestion des enregistrements d'hôtel a besoin de données
supplémentaires :</p>
<blockquote>
<div><ul class="simple">
<li>les numéros de téléphone</li>
<li>les options des chambres</li>
<li>les méthodes de paiement</li>
<li>...</li>
</ul>
</div></blockquote>
<p>Et de code pour gérer les données :</p>
<blockquote>
<div><ul class="simple">
<li>annuler une réservation</li>
<li>Modifier une réservation</li>
<li>payer une chambre</li>
<li>stocker les données</li>
<li>assurer la sécurité des données</li>
<li>...</li>
</ul>
</div></blockquote>
<p>Si nous devions continuer l'exemple procédural, il faudrait créer plusieurs
fonctions, en renvoyant les données de l'une à l'autre. Au fur à mesure que les
fonctionnalités seraient ajoutées, le code deviendrait de plus en plus difficile
à maintenir et les bogues deviendraient difficiles à trouver et à corriger.</p>
<p>Nous n'irons pas plus loin dans l'approche procédurale. Il sera beaucoup plus
facile d'assurer la persistance des données, la flexibilité de la conception et
l'écriture de tests unitaires en utilisant des objets.</p>
</div>
<div class="section" id="approche-orientee-objet">
<h3>Approche orientée objet<a class="headerlink" href="#approche-orientee-objet" title="Lien permanent vers ce titre">¶</a></h3>
<p>Notre discussion sur la conception orientée objet nous amène à la notion de
« classe » qui sert à encapsuler les données et le code qui les gère.</p>
<p>Notre classe principale sera « FrontDesk ». Le FrontDesk et d'autres classes
auxquelles il délèguera du traitement, sauront comment gérer les données de
l'hôtel. Nous allons créer des instances de FrontDesk pour appliquer cette
connaissance au métier de la gestion d'hôtel.</p>
<p>L'expérience a montré qu'en consolidant le code et les contraintes sur les
données via des objets, on aboutit à un code qui est plus facile à comprendre, à
tester et à modifier.</p>
<p>Observons les détails d'implémentation de la classe FrontDesk</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FrontDesk</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">book_room</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">place</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">next_id</span> <span class="o">=</span> <span class="n">get_next_id</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">bookings_db</span><span class="p">[</span><span class="n">next_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;place&#39;</span><span class="p">:</span> <span class="n">place</span>
<span class="gp">... </span>        <span class="p">}</span>
</pre></div>
</div>
<p>Dans cette implémentation, l'objet <cite>frontdesk</cite> (une instance de la classe
FrontDesk) est capable de prendre en charge les réservations. Nous pouvons
l'utiliser de la façon suivante</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">frontdesk</span> <span class="o">=</span> <span class="n">FrontDesk</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frontdesk</span><span class="o">.</span><span class="n">book_room</span><span class="p">(</span><span class="s">&quot;Jack&quot;</span><span class="p">,</span> <span class="s">&quot;Bangalore&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Dans tout projet, on est confronté à des changements de besoins. Dans notre cas,
la direction a décidé que chaque client devait fournit un numéro de téléphone,
donc nous devons changer le code.</p>
<p>Nous pouvons satisfaire ce nouveau besoin en ajoutant un argument à la méthode
<cite>book_room</cite> qui sera ajouté au dictionnaire des valeurs</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FrontDesk</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">book_room</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">place</span><span class="p">,</span> <span class="n">phone</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">next_id</span> <span class="o">=</span> <span class="n">get_next_id</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">bookings_db</span><span class="p">[</span><span class="n">next_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;place&#39;</span><span class="p">:</span> <span class="n">place</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;phone&#39;</span><span class="p">:</span> <span class="n">phone</span>
<span class="gp">... </span>        <span class="p">}</span>
</pre></div>
</div>
<p>En plus de devoir migrer les données vers le nouveau schéma, nous devons changer
tous les appels à la classe <tt class="docutils literal"><span class="pre">FrontDesk</span></tt>. Si nous incorporons les coordonnées
de chaque client dans un objet et que nous utilisons cet objet pour les
réservations, les modifications de code pourront être minimisées. Nous pouvons
maintenant changer les détails de l'objet client sans avoir à changer les appels
à FrontDesk.</p>
<p>Nous avons donc</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FrontDesk</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">book_room</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guest</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">next_id</span> <span class="o">=</span> <span class="n">get_next_id</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">bookings_db</span><span class="p">[</span><span class="n">next_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;place&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">place</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;phone&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">phone</span>
<span class="gp">... </span>        <span class="p">}</span>
</pre></div>
</div>
<p>Nous devons toujours modifier le code pour répondre aux nouvelles demandes.
C'est inévitable, cependant notre but est de minimiser ces changements et donc
d'améliorer la maintenabilité.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Lors du développement il ne faut jamais hésiter à faire des changements sans
craindre de casser l'application. L'avertissement nécessaire doit être
immédiatement obtenu grâce à des tests automatisés. Avec des tests bien écrits
(et un bon contrôle de versions), vous pouvez faire impunément des changements
aussi importants que vous souhaitez. Une bonne source d'informations à propos de
cette philosophie de programmation est l'ouvrage <cite>Extreme Programming Explained</cite>
par Kent Beck.</p>
</div>
<p>En introduisant l'objet guest, vous avez économisé un peu de temps. Mais plus
important, l'abstraction apportée par l'objet guest a rendu le système plus
simple et mieux compréhensible. Par conséquent, le code est plus facile à
restructurer et à maintenir.</p>
</div>
<div class="section" id="le-motif-adaptateur">
<h3>Le motif <cite>adaptateur</cite><a class="headerlink" href="#le-motif-adaptateur" title="Lien permanent vers ce titre">¶</a></h3>
<p>Dans une vraie application, l'objet frontdesk devra gérer des fonctionnalités
comme les annulations et les modifications. Avec la conception actuelle, nous
devons transmettre l'objet <cite>guest</cite> au frontdesk à chaque fois que nous appelons
les méthodes <cite>cancel_booking</cite> et <cite>update_booking</cite>.</p>
<p>Nous pouvons éviter ceci si nous transmettons l'objet <cite>guest</cite> à
FrontDesk.__init__() et si nous le stockons en attribut de l'instance.</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FrontDeskNG</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guest</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">guest</span> <span class="o">=</span> <span class="n">guest</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">book_room</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">guest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">guest</span>
<span class="gp">... </span>        <span class="n">next_id</span> <span class="o">=</span> <span class="n">get_next_id</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">bookings_db</span><span class="p">[</span><span class="n">next_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;place&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">place</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;phone&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">phone</span>
<span class="gp">... </span>        <span class="p">}</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">cancel_booking</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">guest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">guest</span>
<span class="gp">... </span>        <span class="c">#code for cancellations goes here ...</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">update_booking</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">guest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">guest</span>
<span class="gp">... </span>        <span class="c">#code for updatiion goes here ...</span>
</pre></div>
</div>
<p>La solution que nous avons obtenue est un motif de conception courant appelé
<cite>adaptateur</cite>. Le <cite>Gang of Four</cite> <a class="footnote-reference" href="#patternbook" id="id12">[12]</a> résume ainsi l'<em>esprit</em> de
l'adaptateur</p>
<div class="highlight-python"><pre>« Convertir l'interface d'une classe en une autre interface
à laquelle le client s'attend. L'adaptateur permet à des
classes de fonctionner ensemble même si elles ont des
interfaces incompatibles. »</pre>
</div>
</div></blockquote>
<p>En général, un objet adaptateur <em>contient</em> un objet adapté</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Adapter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">adaptee</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">adaptee</span> <span class="o">=</span> <span class="n">adaptee</span>
</pre></div>
</div>
<p>Ce motif sera utile lorsqu'on sera confronté à des détails d'implémentation qui
dépendent de considérations telles que:</p>
<ul class="simple">
<li>modification des besoins client</li>
<li>modification des méthodes de stockage (ZODB, RDBM, XML)</li>
<li>modification des méthodes de sortie (HTML, PDF, texte pur)</li>
<li>modification de la source utilisée (ReST, Markdown, Textile)</li>
</ul>
<p>La ZCA utilise des adaptateurs et un <em>registre de composants</em> pour fournir la
capacité de changer les détails d'implémentation du code via de la
<em>configuration</em>.</p>
<p>Comme nous pouvons le constater dans la section sur les adaptateurs de la ZCA,
la capacité de configurer les détails d'implémentation fournit des avantages
intéressants :</p>
<ul class="simple">
<li>on peut interchanger les implémentations</li>
<li>on peut ajouter de nouvelles implémentations si besoin</li>
<li>on améliore les possibilités de réutilisation, aussi bien d'un code existant que
du code utilisant la ZCA.</li>
</ul>
<p>Ces possibilités mènent à du code qui est flexible, évolutif et réutilisable. Il
y a un cependant un coût : maintenir le registre de composants ajoute un niveau
de complexité à l'application. Si une application n'a pas besoin de ces
avantages, la ZCA n'est pas pas nécessaire.</p>
<p>Nous sommes maintenant prêts à étudier la Zope Component Architecture, en
commençant avec les interfaces.</p>
</div>
</div>
<div class="section" id="interfaces">
<h2>Interfaces<a class="headerlink" href="#interfaces" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="id13">
<h3>Introduction<a class="headerlink" href="#id13" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le fichier README.txt <a class="footnote-reference" href="#readmes" id="id14">[11]</a> dans chemin/vers/zope/interface définit les
interfaces de cette manière</p>
<div class="highlight-python"><pre>Les interfaces sont des objets qui spécifient (documentent) le
comportement externe des objets qui les « fournissent ».
Une interface spécifie un comportement au travers :

- de documentation informelle dans une docstring

- de définitions d'attributs

- d'invariants qui sont des conditions posées sur les objets
fournissant l'interface.</pre>
</div>
<p>L'ouvrage de référence <cite>Design Patterns</cite> <a class="footnote-reference" href="#patternbook" id="id15">[12]</a> par le <cite>Gang of Four</cite>
recommande que vous devez « programmer pour une interface, pas pour une
implémentation ». Définir une interface formelle est utile dans la compréhension
d'un système. De plus, les interfaces vous apportent tous les bénéfices de la
ZCA.</p>
<table class="docutils footnote" frame="void" id="readmes" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id14">[11]</a></td><td>L'arborescence du code de Zope contient de nombreux fichiers README.txt
qui offrent une très bonne documentation.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="patternbook" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[12]</td><td><em>(<a class="fn-backref" href="#id12">1</a>, <a class="fn-backref" href="#id15">2</a>)</em> <a class="reference external" href="http://en.wikipedia.org/wiki/Design_Patterns">http://en.wikipedia.org/wiki/Design_Patterns</a></td></tr>
</tbody>
</table>
<p>Une interface spécifie les caractéristiques d'un objet, son comportement et ses
capacités. Elle décrit le « quoi » d'un objet. Pour apprendre le « comment »,
vous devez regarder l'implémentation.</p>
<p>Les métaphores couramment utilisées pour les interfaces sont <cite>contrat</cite> ou
<cite>plan</cite>, des termes légaux et architecturaux pour représenter un jeu de
spécifications.</p>
<p>Dans certains langages de programmation comme Java, C# ou VB.NET, les
interfaces sont un aspect explicite du langage. Étant donné que Python ne
possède pas nativement d'interfaces, la ZCA les implémente comme des
meta-classes desquelles on hérite.</p>
<p>Voici un exemple classique de Hello World</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Host</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">goodmorning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Say good morning to guests&quot;&quot;&quot;</span>
<span class="gp">...</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;Good morning, </span><span class="si">%s</span><span class="s">!&quot;</span> <span class="o">%</span> <span class="n">name</span>
</pre></div>
</div>
<p>Dans la classe ci-dessus, on a défini une méthode <cite>goodmorning</cite>. Si vous appelez
cette méthode depuis un objet créé en utilisant cette classe, vous obtiendrez un
<cite>Good morning, ...!</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">host</span> <span class="o">=</span> <span class="n">Host</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">host</span><span class="o">.</span><span class="n">goodmorning</span><span class="p">(</span><span class="s">&#39;Jack&#39;</span><span class="p">)</span>
<span class="go">&#39;Good morning, Jack!&#39;</span>
</pre></div>
</div>
<p>Ici, <tt class="docutils literal"><span class="pre">host</span></tt> est l'objet réel que votre code utilise. Si vous voulez
examiner les détails d'implémentation, vous devez accéder à la classe <tt class="docutils literal"><span class="pre">Host</span></tt>,
soit via le code source, soit au travers d'un outil de documentation d'API
<a class="footnote-reference" href="#api" id="id16">[13]</a>.</p>
<table class="docutils footnote" frame="void" id="api" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id16">[13]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Application_programming_interface">http://en.wikipedia.org/wiki/Application_programming_interface</a></td></tr>
</tbody>
</table>
<p>Maintenant nous allons commencer à utiliser les interfaces de la ZCA. Pour la
classe ci-dessus, vous pouvez définir l'interface comme suit</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IHost</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">goodmorning</span><span class="p">(</span><span class="n">guest</span><span class="p">):</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Say good morning to guest&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Vous pouvez constater que l'interface hérite de zope.interface.Interface. C'est
de cette façon (abusive ?) que la ZCA définit des interfaces. Le préfixe « I »
pour le nom de la classe est une convention utile.</p>
</div>
<div class="section" id="declarer-des-interfaces">
<h3>Déclarer des interfaces<a class="headerlink" href="#declarer-des-interfaces" title="Lien permanent vers ce titre">¶</a></h3>
<p>Vous avez déjà vu comment déclarer une interface en utilisant <tt class="docutils literal"><span class="pre">zope.interface</span></tt>
dans la section précédente. Cette section va expliquer les concepts en détail.</p>
<p>Prenez cette exemple d'interface</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IHost</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;A host object&quot;&quot;&quot;</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;&quot;&quot;Name of host&quot;&quot;&quot;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">goodmorning</span><span class="p">(</span><span class="n">guest</span><span class="p">):</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Say good morning to guest&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>L'interface <tt class="docutils literal"><span class="pre">IHost</span></tt> possède deux attributs, <tt class="docutils literal"><span class="pre">name</span></tt> et <tt class="docutils literal"><span class="pre">goodmorning</span></tt>.
Rappelez-vous qu'en Python les méthodes des classes sont aussi des attributs.
L'attribut <tt class="docutils literal"><span class="pre">name</span></tt> est défini en utilisant la classe
<tt class="docutils literal"><span class="pre">zope.interface.Attribute</span></tt>. Quand vous ajoutez l'attribut <tt class="docutils literal"><span class="pre">name</span></tt> à
l'interface <tt class="docutils literal"><span class="pre">IHost</span></tt>, vous ne définissez pas de valeur initiale. La raison de
définir l'attribut <tt class="docutils literal"><span class="pre">name</span></tt> ici est simplement d'indiquer que toute
implémentation de cette interface doit fournir un attribut nommé <tt class="docutils literal"><span class="pre">name</span></tt>. Dans
ce cas, vous n'indiquez même pas de quel type doit être l'attribut ! Vous pouvez
juste fournir une chaîne de documentation comme premier argument à
<tt class="docutils literal"><span class="pre">Attribute</span></tt>.</p>
<p>L'autre attribut, <tt class="docutils literal"><span class="pre">goodmorning</span></tt> est une méthode définie en utilisant une
fonction. Notez bien que <tt class="docutils literal"><span class="pre">self</span></tt> n'est pas nécessaire dans les interfaces, car
<tt class="docutils literal"><span class="pre">self</span></tt> est un détail d'implémentation de la classe. Il est possible pour un
module d'implémenter cette interface. Si un module implémente cette interface,
cela signifiera qu'un attribut <tt class="docutils literal"><span class="pre">name</span></tt> et une fonction <tt class="docutils literal"><span class="pre">goodmorning</span></tt> seront
définis. Et la fonction <tt class="docutils literal"><span class="pre">goodmorning</span></tt> devra accepter un argument.</p>
<p>Nous allons maintenant voir comment effectuer le lien entre les objets, les
classes et les interfaces. Seuls les objets sont vivants : ce sont des instances
de classes. Et les interfaces représentent la définition des objets, donc les
classes ne sont qu'un détail d'implémentation. C'est pour cette raison que vous
devez programmer pour une interface, pas pour une implémentation.</p>
<p>Nous devons nous familiariser avec deux termes supplémentaires pour comprendre
les autres concepts. Le premier est <cite>fournir</cite>, le deuxième est <cite>implémenter</cite>.
Les objets fournissent des interfaces, tandis que les classes implémentent des
interfaces. Autrement dit, les objets fournissent les interfaces que les classes
implémentent. Dans l'exemple ci-dessus, l'objet <tt class="docutils literal"><span class="pre">host</span></tt> fournit l'interface
<tt class="docutils literal"><span class="pre">IHost</span></tt> et la classe <tt class="docutils literal"><span class="pre">Host</span></tt> implémente l'interface <tt class="docutils literal"><span class="pre">IHost</span></tt>. Un objet peut
fournir plusieurs interfaces. Les objets peuvent également fournir directement
des interfaces, en plus de celles implémentées par leur classe.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Les classes sont les détails d'implémentation des objets. En Python, les
classes sont des objets appelables (<cite>callable</cite>). Pourquoi un autre objet
appelable ne pourrait-il pas implémenter une interface ? En fait c'est possible.
Pour n'importe quel objet appelable, vous pouvez déclarer qu'il produit des
objets qui fournissent une interface donnée, en disant simplement que cet objet
appelable implémente l'interface. Ces objets appelables sont généralement
nommés des « fabriques ». Étant donné que les fonctions sont des objets
appelables, une fonction peut implémenter une interface.</p>
</div>
</div>
<div class="section" id="implementation-des-interfaces">
<h3>Implémentation des interfaces<a class="headerlink" href="#implementation-des-interfaces" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour déclarer qu'une classe implémente une interface donnée, utilisez la
fonction <tt class="docutils literal"><span class="pre">zope.interface.implements</span></tt> dans la déclaration de classe.</p>
<p>Considérons cet exemple. Ici, <tt class="docutils literal"><span class="pre">Host</span></tt> implémente <tt class="docutils literal"><span class="pre">IHost</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Host</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IHost</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="s">u&#39;&#39;</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">goodmorning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guest</span><span class="p">):</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Say good morning to guest&quot;&quot;&quot;</span>
<span class="gp">...</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;Good morning, </span><span class="si">%s</span><span class="s">!&quot;</span> <span class="o">%</span> <span class="n">guest</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Si vous vous demandez comment <tt class="docutils literal"><span class="pre">implements</span></tt> fonctionne, faites un tour sur
l'article de blog de James Henstridge
(<a class="reference external" href="http://blogs.gnome.org/jamesh/2005/09/08/python-class-advisors/">http://blogs.gnome.org/jamesh/2005/09/08/python-class-advisors/</a>) .
Dans la section sur les adaptateurs, vous allez voir une fonction <tt class="docutils literal"><span class="pre">adapts</span></tt>,
celle-ci fonctionne de manière similaire.</p>
</div>
<p>Comme <tt class="docutils literal"><span class="pre">Host</span></tt> implémente <tt class="docutils literal"><span class="pre">IHost</span></tt>, les instances de <tt class="docutils literal"><span class="pre">Host</span></tt> fournissent
<tt class="docutils literal"><span class="pre">IHost</span></tt>. Il existe des méthodes permettant d'introspecter les déclarations. La
déclaration peut également s'écrire en dehors de la classe. Au lieu d'écrire
<tt class="docutils literal"><span class="pre">interface.implements(IHost)</span></tt> comme dans l'exemple ci-dessus, vous pouvez
écrire la chose suivante après la déclaration de classe</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">classImplements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">classImplements</span><span class="p">(</span><span class="n">Host</span><span class="p">,</span> <span class="n">IHost</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="l-exemple-revisite">
<h3>L'exemple revisité<a class="headerlink" href="#l-exemple-revisite" title="Lien permanent vers ce titre">¶</a></h3>
<p>Maintenant retournons à notre application exemple. Voici comment définir
l'interface de l'objet frontdesk</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDesk</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;A frontdesk will register object&#39;s details&quot;&quot;&quot;</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Register object&#39;s details&quot;&quot;&quot;</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Nous avons d'abord importé la classe <tt class="docutils literal"><span class="pre">Interface</span></tt> depuis le module
<tt class="docutils literal"><span class="pre">zope.interface</span></tt>. Si vous définissez une sous-classe de cette classe
<tt class="docutils literal"><span class="pre">Interface</span></tt>, ce sera considéré comme une interface, du point de vue de
l'Architecture de Composants. Une interface peut être implémentée, comme nous
l'avons vu, dans une classe ou tout autre objet appelable.</p>
<p>L'interface de frontdesk ici définie est <tt class="docutils literal"><span class="pre">IDesk</span></tt>. La chaîne de documentation
de l'interface donne une idée sur la nature de l'objet. En définissant une
méthode dans l'interface, vous avez passé un contrat avec le composant, imposant
la présence d'une méthode du même nom. Dans la déclaration de la méthode côté
interface, le premier argument ne doit pas être <cite>self</cite>, car une interface ne
sera jamais instanciée et ses méthodes ne seront jamais appelées. Le rôle d'une
interface est simplement de documenter quels arguments et quelles méthodes
doivent apparaître dans une classe qui l'implémente, et le paramètre <cite>self</cite>
n'est qu'un détail d'implémentation qui n'a pas besoin d'être documenté.</p>
<p>Comme vous le savez, une interface peut aussi spécifier des attributs normaux</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IGuest</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of guest&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">place</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Place of guest&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Dans cette interface, l'objet guest a deux attributs contenant de la
documentation. Une interface peut spécifier à la fois des méthodes et des
attributs. Une interface peut être implémentée dans une classe, un module ou
tout autre objet. Par exemple une fonction peut créer dynamiquement le composant
et le renvoyer, auquel cas on dit que la fonction implémente l'interface.</p>
<p>Vous savez maintenant ce qu'est une interface, comment la créer et l'utiliser.
Dans le chapitre suivant nous allons voir comment une interface peut être
utilisée pour définir un composant adaptateur.</p>
</div>
<div class="section" id="interfaces-marqueurs">
<h3>Interfaces marqueurs<a class="headerlink" href="#interfaces-marqueurs" title="Lien permanent vers ce titre">¶</a></h3>
<p>Une interface peut être utilisée pour déclarer qu'un objet appartient à un
type donné. Une interface sans aucun attribut ni aucune méthode est appelée une
« interface marqueur ».</p>
<p>Voici une <cite>interface marqueur</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">ISpecialGuest</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;A special guest&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Cette interface peut être utilisée pour déclarer qu'un objet est un client
spécial.</p>
</div>
<div class="section" id="invariants">
<h3>Invariants<a class="headerlink" href="#invariants" title="Lien permanent vers ce titre">¶</a></h3>
<p>Parfois vous aurez besoin de définir des règles ou des contraintes sur les
attributs de vos composants. Ces types de règles sont appelés des <cite>invariants</cite>.
Vous pouvez utiliser <tt class="docutils literal"><span class="pre">zope.interface.invariant</span></tt> pour définir des
<tt class="docutils literal"><span class="pre">invariants</span></tt> sur vos objets dans leur interface.</p>
<p>Considérons un exemple simple, avec un objet <cite>person</cite>. Une objet <cite>person</cite> a un
attribut <cite>nom</cite>, un attribut <cite>email</cite> et un attribut <cite>phone</cite>. Comment peut-on
implémenter une règle de validation qui oblige à définir au choix le <cite>phone</cite> ou
l'<cite>email</cite> mais pas forcément les deux ?</p>
<p>Créez tout d'abord un objet appelable, soit une simple fonction soit une
instance appelable d'une classe de la façon suivante</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">contacts_invariant</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">email</span> <span class="ow">or</span> <span class="n">obj</span><span class="o">.</span><span class="n">phone</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
<span class="gp">... </span>            <span class="s">&quot;At least one contact info is required&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Ensuite définissez l'interface de l'objet <cite>person</cite> en utilisant la fonction
<tt class="docutils literal"><span class="pre">zope.interface.invariant</span></tt> pour définir l'invariant</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">invariant</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">email</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Email Address&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">phone</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Phone Number&quot;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">invariant</span><span class="p">(</span><span class="n">contacts_invariant</span><span class="p">)</span>
</pre></div>
</div>
<p>Maintenant, utilisez la méthode <cite>validateInvariants</cite> de l'interface pour
effectuer la validation</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IPerson</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">... </span>    <span class="n">email</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">... </span>    <span class="n">phone</span> <span class="o">=</span> <span class="bp">None</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Person</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">email</span> <span class="o">=</span> <span class="s">u&quot;jack@some.address.com&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IPerson</span><span class="o">.</span><span class="n">validateInvariants</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jill</span> <span class="o">=</span> <span class="n">Person</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IPerson</span><span class="o">.</span><span class="n">validateInvariants</span><span class="p">(</span><span class="n">jill</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">Exception</span>: <span class="n">At least one contact info is required</span>
</pre></div>
</div>
<p>Vous constatez que l'ojet <cite>jack</cite> est validé sans erreur. Mais l'objet <cite>jill</cite> n'a
pas pu valider la contrainte de l'invariant, il a donc levé une exception.</p>
</div>
</div>
<div class="section" id="adaptateurs">
<span id="guide-zca-adaptateur"></span><span id="index-0"></span><h2>Adaptateurs<a class="headerlink" href="#adaptateurs" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="implementation">
<h3>Implémentation<a class="headerlink" href="#implementation" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette section décrit les adaptateurs en détail. L'Architecture de Composants,
comme vous l'avez remarqué, fournit une aide dans l'utilisation efficace des objets
Python. Les composants adaptateurs sont l'un des composants basiques utilisés
par l'Architecture de Composants de Zope pour utiliser efficacement des objets
Python. Les adaptateurs sont aussi des objets Python, mais avec une interface bien
définie.</p>
<p>Pour déclarer qu'une classe est un adaptateur, utilisez la fonction <cite>adapts</cite>
définie dans le paquet <tt class="docutils literal"><span class="pre">zope.component</span></tt>. Voici un nouvel adaptateur
<cite>FrontDeskNG</cite> avec une déclaration explicite d'interface</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FrontDeskNG</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDesk</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guest</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">guest</span> <span class="o">=</span> <span class="n">guest</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">guest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">guest</span>
<span class="gp">... </span>        <span class="n">next_id</span> <span class="o">=</span> <span class="n">get_next_id</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">bookings_db</span><span class="p">[</span><span class="n">next_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;place&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">place</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;phone&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">phone</span>
<span class="gp">... </span>        <span class="p">}</span>
</pre></div>
</div>
<p>Ce que nous avons défini ici est un <cite>adaptateur</cite> pour <cite>IDesk</cite>, qui s'adapte à
l'objet <cite>IGuest</cite>. L'interface <cite>IDesk</cite> est implémentée par la classe
<cite>FrontDeskNG</cite>. Donc une instance de cette classe fournira l'interface <cite>IDesk</cite>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Guest</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">place</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">place</span> <span class="o">=</span> <span class="n">place</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Guest</span><span class="p">(</span><span class="s">&quot;Jack&quot;</span><span class="p">,</span> <span class="s">&quot;Bangalore&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack_frontdesk</span> <span class="o">=</span> <span class="n">FrontDeskNG</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">IDesk</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">jack_frontdesk</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p><cite>FrontDeskNG</cite> est juste un adaptateur que nous avons créé. Vous pouvez créer
d'autres adaptateurs qui prendront en charge le bureau d'enregistrement différemment.</p>
</div>
<div class="section" id="inscription">
<h3>Inscription<a class="headerlink" href="#inscription" title="Lien permanent vers ce titre">¶</a></h3>
<p>Pour utiliser ce composant adaptateur, vous devez l'inscrire dans un registre de
composants (appelé également « gestionnaire de site »). Un gestionnaire de site
réside normalement à l'intérieur d'un site. Le site et le gestionnaire de site
prendront leur importance lors du développement d'une application Zope 3. Pour
l'instant vous avez juste besoin de connaître les notions de site global et de
gestionnaire global de site (ou registre de composant). Un gestionnaire global
de site est situé en mémoire, alors qu'un gestionnaire de site local est
persistant.</p>
<p>Pour inscrire votre composant, commencez par récupérer le gestionnaire global de
site</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">FrontDeskNG</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="p">(</span><span class="n">IGuest</span><span class="p">,),</span> <span class="n">IDesk</span><span class="p">,</span> <span class="s">&#39;ng&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Pour récupérer le gestionnaire global de site, vous devez appeler la fonction
<tt class="docutils literal"><span class="pre">getGlobalSiteManager`</span> <span class="pre">disponible</span> <span class="pre">dans</span> <span class="pre">le</span> <span class="pre">paquet</span> <span class="pre">``zope.component</span></tt>.
En fait, le gestionnaire global de site est disponible dans un attribut
(<tt class="docutils literal"><span class="pre">globalSiteManager</span></tt>) du paquet <tt class="docutils literal"><span class="pre">zope.component</span></tt>. Vous pouvez donc utiliser
directement l'attribut <tt class="docutils literal"><span class="pre">zope.component.globalSiteManager</span></tt>.
Pour inscrire l'adaptateur comme un composant, utilisez la méthode
<tt class="docutils literal"><span class="pre">registerAdapter</span></tt> du registre de composants. Le premier argument doit être
votre classe ou fabrique d'adaptateur. Le deuxième argument est un tuple d'objets
adaptés, c'est à dire les objets sur lesquels vous vous adaptez. Dans cet
exemple, vous vous adaptez seulement à l'objet <cite>IGuest</cite>. Le troisième argument
est l'interface implémentée par le composant adaptateur. Le quatrième argument
est optionnel, il s'agit du nom de cet adaptateur particulier. Si vous donnez un
nom à l'adaptateur, celui devient un <cite>adaptateur nommé</cite>. Si aucun nom n'est
donné, la valeur transmise par défaut est une chaîne vide ('').</p>
<p>Dans l'inscription ci-dessus, vous avez donné l'interface de l'objet adapté et
l'interface fournie par l'adaptateur. Comme vous avez déjà donné ces
informations dans l'implémentation de l'adaptateur, il est inutile de les
spécifier à nouveau. En réalité, vous pouvez effectuer l'inscription de la
manière suivante</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">FrontDeskNG</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;ng&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Pour effectuer l'inscription, il existe d'anciennes API que vous devriez
éviter. Les fonctions de l'ancienne API commencent par <cite>provide</cite>, par exemple :
<tt class="docutils literal"><span class="pre">provideAdapter</span></tt>, <tt class="docutils literal"><span class="pre">provideUtility</span></tt>, etc. Si vous développez une application
Zope 3, vous pouvez utiliser le langage ZCML (Zope Configuration Markup
Language) pour effectuer les inscriptions des composants. Avec Zope 3, les
composants locaux (persistants) peut être inscrits depuis la ZMI (Zope
Management Interface), ou bien par programmation.</p>
<p>Vous avez inscrit <cite>FrontDeskNG</cite> avec le nom <cite>ng</cite>. De la même manière, vous
pouvez inscrire d'autre adaptateurs avec différents noms. Si un composant est
inscrit sans nom, son nom sera la chaîne vide par défaut.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Les composants locaux sont persistants mais les composants globaux sont en
mémoire. Les composants globaux sont inscrits en fonction de la configuration de
l'application. Les composants locaux sont récupérés dans la base de données au
démarrage de l'application.</p>
</div>
</div>
<div class="section" id="recuperation-d-un-adaptateur">
<h3>récupération d'un adaptateur<a class="headerlink" href="#recuperation-d-un-adaptateur" title="Lien permanent vers ce titre">¶</a></h3>
<p>La récupération des composants inscrits dans le registre est effectuée grâce à
deux fonctions disponibles dans le paquet <tt class="docutils literal"><span class="pre">zope.component</span></tt>. La première est
<tt class="docutils literal"><span class="pre">getAdapter</span></tt>, la deuxième <tt class="docutils literal"><span class="pre">queryAdapter</span></tt>. Les deux fonctions prennent les
mêmes arguments. <tt class="docutils literal"><span class="pre">getAdapter</span></tt> lève une exception <tt class="docutils literal"><span class="pre">ComponentLookupError</span></tt> si
la recherche de composant échoue, tandis que <tt class="docutils literal"><span class="pre">queryAdapter</span></tt> renvoie <cite>None</cite>.</p>
<p>Vous pouvez importer ces fonctions comme ceci</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getAdapter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">queryAdapter</span>
</pre></div>
</div>
<p>Dans la section précédente, nous avons inscrit un composant qui fournit
l'interface <cite>IDesk</cite> avec un nom <cite>ng</cite>, et qui s'adapte à l'objet guest.
Dans la première section nous avons créé un objet nommé <cite>jack</cite>.</p>
<p>Voici maintenant comment récupérer un composant qui s'adapte à l'interface de l'objet
<cite>jack</cite> (<cite>IGuest</cite>) et qui fournit l'interface <cite>IDesk</cite> également avec le nom <cite>ng</cite>.
Ici, <tt class="docutils literal"><span class="pre">getAdapter</span></tt> et <tt class="docutils literal"><span class="pre">queryAdapter</span></tt> fonctionnent de la même manière</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">getAdapter</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">IDesk</span><span class="p">,</span> <span class="s">&#39;ng&#39;</span><span class="p">)</span> 
<span class="go">&lt;FrontDeskNG object at ...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">queryAdapter</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">IDesk</span><span class="p">,</span> <span class="s">&#39;ng&#39;</span><span class="p">)</span> 
<span class="go">&lt;FrontDeskNG object at ...&gt;</span>
</pre></div>
</div>
<p>Vous pouvez constater que le premier argument doit être l'objet adapté, puis
l'interface qui doit être fournie par le composant et finalement le nom du
composant adaptateur.</p>
<p>Si vous essayez de récupérer le composant grâce à un nom inutilisé pour
l'inscription mais pour le même objet adapté et la même interface, la recherche
échouera. Voici dans ce cas comment fonctionnent les deux méthodes</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">getAdapter</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">IDesk</span><span class="p">,</span> <span class="s">&#39;not-exists&#39;</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ComponentLookupError</span>: <span class="n">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reg</span> <span class="o">=</span> <span class="n">queryAdapter</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span>
<span class="gp">... </span>          <span class="n">IDesk</span><span class="p">,</span> <span class="s">&#39;not-exists&#39;</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">reg</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">getAdapter</span></tt> a levé une exception <tt class="docutils literal"><span class="pre">ComponentLookupError</span></tt> mais
<tt class="docutils literal"><span class="pre">queryAdapter</span></tt> a renvoyé <cite>None</cite>.</p>
<p>Le troisième argument, le nom d'inscription, est optionnel. Si le troisième
argument n'est pas fourni, sa valeur par défaut est la chaîne vide (''). Comme
il n'y a aucun composant inscrit avec la chaîne vide comme nom, <tt class="docutils literal"><span class="pre">getAdapter</span></tt>
lève l'exception <tt class="docutils literal"><span class="pre">ComponentLookupError</span></tt>. De la même manière, <tt class="docutils literal"><span class="pre">queryAdapter</span></tt>
renvoie <cite>None</cite>. Voyez vous-même comment cela fonctionne</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">getAdapter</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">IDesk</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ComponentLookupError</span>: <span class="n">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reg</span> <span class="o">=</span> <span class="n">queryAdapter</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">IDesk</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">reg</span> <span class="ow">is</span> <span class="bp">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Dans cette section, vous avez appris à inscrire un simple adaptateur et à le
récupérer depuis le registre de composants. Ce type d'adaptateurs est appelé un
adaptateur simple, car il ne s'adapte qu'à un seul objet. Si un adaptateur
s'adapte à plusieurs objets, on l'appelle un multi-adaptateur.</p>
</div>
<div class="section" id="recuperer-un-adaptateur-en-utilisant-l-interface">
<h3>Récupérer un adaptateur en utilisant l'interface<a class="headerlink" href="#recuperer-un-adaptateur-en-utilisant-l-interface" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les adaptateurs peuvent être récupérés directement en utilisant les interfaces,
mais cela ne fonctionne qu'avec les adaptateurs simples. Le premier argument est
l'objet adapté, le deuxième argument est un argument mot-clé. Si la recheche
d'adaptateur échoue, le deuxième argument est renvoyé.</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">IDesk</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">alternate</span><span class="o">=</span><span class="s">&#39;default-output&#39;</span><span class="p">)</span>
<span class="go">&#39;default-output&#39;</span>
</pre></div>
</div>
<p>Le mot-clé peut être omis :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">IDesk</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="s">&#39;default-output&#39;</span><span class="p">)</span>
<span class="go">&#39;default-output&#39;</span>
</pre></div>
</div>
<p>Si le deuxième argument n'est pas fourni, une erreur <cite>TypeError</cite> est levée :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">IDesk</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">(&#39;Could not adapt&#39;,</span>
<span class="go">  &lt;Guest object at ...&gt;,</span>
<span class="go">  &lt;InterfaceClass __builtin__.IDesk&gt;)</span>
</pre></div>
</div>
<p>Ici, <cite>FrontDeskNG</cite> est inscrit sans nom :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">FrontDeskNG</span><span class="p">)</span>
</pre></div>
</div>
<p>Maintenant la récupération de l'adaptateur doit réussir :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">IDesk</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="s">&#39;default-output&#39;</span><span class="p">)</span> 
<span class="go">&lt;FrontDeskNG object at ...&gt;</span>
</pre></div>
</div>
</div></blockquote>
<p>Pour les cas simples, vous pouvez utiliser l'interface pour récupérer des
adaptateurs.</p>
</div>
<div class="section" id="motif-adaptateur">
<h3>Motif adaptateur<a class="headerlink" href="#motif-adaptateur" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le principe de l'adaptateur dans l'Architecture de Composants de Zope est très
similaire au <cite>motif adaptateur</cite> classique, tel que décrit dans le livre « Design
Patterns ». Mais l'objectif visé par l'utilisation des adaptateurs dans la ZCA
est plus large que le principe de l'adaptateur lui-même. Le but de l'adaptateur
est de convertir l'interface d'une classe en une autre interface attendue par le
client. Ceci permet de faire fonctionner des classes ensemble même si elles ont
des interfaces incompatibles entre elles. Mais dans la section <cite>motivations</cite> du
livre « Design Patterns », le GoF dit : « souvent, l'adaptateur est responsable
d'une fonctionnalité que la classe adaptée ne fournit pas ». Un adaptateur de la
ZCA se concentre effectivement plus sur l'ajout de fonctionnalités que sur la
création d'une nouvelle interface pour un objet adapté. L'adaptateur de la ZCA
permet aux classes adaptateurs d'étendre des fonctionnalités par ajout de
méthodes. (Il peut être intéressant de remarquer que l'adaptateur était appelé
<cite>Fonctionnalité</cite> (<cite>feature</cite>) dans les premières étapes de conception de la ZCA.) <a class="footnote-reference" href="#feature" id="id17">[14]</a></p>
<table class="docutils footnote" frame="void" id="feature" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id17">[14]</a></td><td>Thread discussing renaming of <cite>Feature</cite> to <cite>Adapter</cite>:
<a class="reference external" href="http://mail.zope.org/pipermail/zope3-dev/2001-December/000008.html">http://mail.zope.org/pipermail/zope3-dev/2001-December/000008.html</a></td></tr>
</tbody>
</table>
<p>La citation du Gang of Four dans le paragraphe ci-dessus se termine de la façon
suivante : « ... que la classe adaptée ne fournit pas ». Mais dans la phrase
suivante nous avons utilisé « objet adapté » plutôt que « classe adaptée », car
le GoF décrit deux variantes d'adaptateurs selon les implémentations.
Le premier est appelé <cite>adaptateur de classe</cite>, le deuxième <cite>adaptateur d'objet</cite>.
Un adaptateur de classe utilise l'héritage multiple pour adapter une interface à
une autre, alors que l'adaptateur d'objet se base sur la composition d'objet.
L'adaptateur de la ZCA utilise le principe de l'adaptateur d'objet, qui utilise
la délégation comme mécanisme de composition. Le second principe du GoF à propos
de la conception orientée objets est la suivante : « favorisez la composition
d'objets plutôt que l'héritage de classes ». Pour approfondir le sujet,
reportez-vous au livre « Design Patterns ».</p>
<p>Les principaux atouts des adaptateurs de la ZCA sont les interfaces explicites
et les registres de composants. Les composants adaptateurs de la ZCA sont inscrits
dans le registre de composants et sont récupérés par les objets clients via leur
interface et leur nom si besoin.</p>
</div>
</div>
<div class="section" id="utilitaires">
<h2>Utilitaires<a class="headerlink" href="#utilitaires" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="id18">
<h3>Introduction<a class="headerlink" href="#id18" title="Lien permanent vers ce titre">¶</a></h3>
<p>Vous connaissez maintenant le principe des interfaces, des adaptateurs et du
registre de composants. Parfois, il peut être utile d'inscrire un objet qui ne
s'adapte à rien du tout, par exemple une connexion à une base de données, un
analyseur XML ou un objet retournant des identifiants uniques. Ce type de
composant fourni par la ZCA est appelé un « utilitaire » (<em>utility</em>).</p>
<p>Les utilitaires sont simplement des objets qui fournissent une interface et qui sont
récupérés à partir de cette interface et d'un nom. Cette approche permet de créer
un registre global dans lequel des instances peuvent être inscrites et
récupérées à différents endroits de votre application, sans avoir besoin de
transmettre les instances comme paramètres.</p>
<p>Vous n'avez pas besoin d'inscrire toutes les instances de composants de cette
façon. Inscrivez seulement les composants que vous voulez rendre
interchangeables.</p>
</div>
<div class="section" id="utilitaire-simple">
<h3>Utilitaire simple<a class="headerlink" href="#utilitaire-simple" title="Lien permanent vers ce titre">¶</a></h3>
<p>Un utilitaire peut être inscrit avec ou sans nom. Un utilitaire inscrit avec un nom
est appelé un <cite>utilitaire nommé</cite>. Vous le verrez dans la prochaine section.
Avant d'implémenter l'utilitaire, comme d'habitude, définissez son interface.
Voici une interface qui dit bonjour</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IGreeter</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Say hello&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Comme un adaptateur, un utilitaire peut avoir plusieurs implémentations. Voici
une implémentation possible de l'interface ci-dessus</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Greeter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;Hello &quot;</span> <span class="o">+</span> <span class="n">name</span>
</pre></div>
</div>
<p>L'utilitaire réel sera une instance de cette classe. Pour utiliser cet
utilitaire, vous devez l'inscrire, puis vous pourrez la récupérer en
utilisant l'API de la ZCA. Vous pouvez inscrire une instance de cette classe
(<cite>utilitaire</cite>) grâce à <tt class="docutils literal"><span class="pre">registerUtility</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">greet</span> <span class="o">=</span> <span class="n">Greeter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerUtility</span><span class="p">(</span><span class="n">greet</span><span class="p">,</span> <span class="n">IGreeter</span><span class="p">)</span>
</pre></div>
</div>
<p>Dans cet exemple, vous avez inscrit l'utilitaire en fournissant l'interface
<cite>IGreeter</cite>. Vous pouvez récupérer l'utilitaire avec <cite>queryUtility</cite> ou
<cite>getUtility</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">queryUtility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getUtility</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">queryUtility</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">)</span><span class="o">.</span><span class="n">greet</span><span class="p">(</span><span class="s">&#39;Jack&#39;</span><span class="p">)</span>
<span class="go">&#39;Hello Jack&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">getUtility</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">)</span><span class="o">.</span><span class="n">greet</span><span class="p">(</span><span class="s">&#39;Jack&#39;</span><span class="p">)</span>
<span class="go">&#39;Hello Jack&#39;</span>
</pre></div>
</div>
<p>Comme vous pouvez le constater, alors que les adaptateurs sont habituellement
des classes, les utilitaires sont habituellement des instances de classes. vous
ne créez une instance d'utilitaire qu'une fois, alors que les instances
d'adaptateurs sont créées à chaque fois que vous les récupérez.</p>
</div>
<div class="section" id="utilitaire-nomme">
<h3>Utilitaire nommé<a class="headerlink" href="#utilitaire-nomme" title="Lien permanent vers ce titre">¶</a></h3>
<p>Lorsque vous inscrivez un composant utilitaire, de la même manière que pour les
adaptateurs, vous pouvez utiliser un nom. Comme mentionné dans la section
précédente, un utilitaire inscrit avec un nom est appelé un <cite>utilitaire nommé</cite>.</p>
<p>Voici comment inscrire l'utilitaire <cite>greeter</cite> avec un nom</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">greet</span> <span class="o">=</span> <span class="n">Greeter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerUtility</span><span class="p">(</span><span class="n">greet</span><span class="p">,</span> <span class="n">IGreeter</span><span class="p">,</span> <span class="s">&#39;new&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Dans cet exemple, nous avons inscrit l'utilitaire avec un nom en fournissant
l'interface <cite>IGreeter</cite>. Vous pouvez récupérer l'utilitaire avec <cite>queryUtility</cite>
ou <cite>getUtility</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">queryUtility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getUtility</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">queryUtility</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">,</span> <span class="s">&#39;new&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">greet</span><span class="p">(</span><span class="s">&#39;Jill&#39;</span><span class="p">)</span>
<span class="go">&#39;Hello Jill&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">getUtility</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">,</span> <span class="s">&#39;new&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">greet</span><span class="p">(</span><span class="s">&#39;Jill&#39;</span><span class="p">)</span>
<span class="go">&#39;Hello Jill&#39;</span>
</pre></div>
</div>
<p>Remarquez que vous devez utiliser le nom de l'utilitaire comme second argument
pour que la récupération fonctionne.</p>
<p>Appeler <cite>getUtility</cite> sans nom (comme second argument) est équivalent à l'appeler
avec un nom vide (''), car la valeur par défaut pour ce second argument est
justement la chaîne vide. Donc le mécanisme de recherche de composant essaiera
de trouver le composant ayant une chaîne vide comme nom et il échouera.
Lorsqu'une recherche de composant échoue, le résultat est une exception
<tt class="docutils literal"><span class="pre">ComponentLookupError</span></tt>. Souvenez-vous qu'aucun composant aléatoire avec un
autre nom ne sera renvoyé. Les fonctions de récupération d'adaptateurs,
<cite>getAdapter</cite> et <cite>queryUtility</cite> fonctionnent de manière similaire.</p>
</div>
<div class="section" id="fabrique">
<h3>Fabrique<a class="headerlink" href="#fabrique" title="Lien permanent vers ce titre">¶</a></h3>
<p>Une <tt class="docutils literal"><span class="pre">fabrique</span></tt> est un composant utilitaire qui fournit l'interface <tt class="docutils literal"><span class="pre">IFactory</span></tt>.</p>
<p>Pour créer une fabrique, commencez par définir l'interface de l'objet</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDatabase</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">getConnection</span><span class="p">():</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Return connection object&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Voici une implémentation factice de l'interface <cite>IDatabase</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FakeDb</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDatabase</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">getConnection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;connection&quot;</span>
</pre></div>
</div>
<p>Vous pouvez créer une fabrique en utilisant <tt class="docutils literal"><span class="pre">zope.component.factory.Factory</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.factory</span> <span class="kn">import</span> <span class="n">Factory</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">factory</span> <span class="o">=</span> <span class="n">Factory</span><span class="p">(</span><span class="n">FakeDb</span><span class="p">,</span> <span class="s">&#39;FakeDb&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Maintenant vous pouvez l'inscrire de cette façon</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.interfaces</span> <span class="kn">import</span> <span class="n">IFactory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerUtility</span><span class="p">(</span><span class="n">factory</span><span class="p">,</span> <span class="n">IFactory</span><span class="p">,</span> <span class="s">&#39;fakedb&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Pour utiliser la fabrique, vous pouvez faire comme ceci</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">queryUtility</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">queryUtility</span><span class="p">(</span><span class="n">IFactory</span><span class="p">,</span> <span class="s">&#39;fakedb&#39;</span><span class="p">)()</span> 
<span class="go">&lt;FakeDb object at ...&gt;</span>
</pre></div>
</div>
<p>Voici l'écriture simplifiée pour utiliser une fabrique</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">createObject</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">createObject</span><span class="p">(</span><span class="s">&#39;fakedb&#39;</span><span class="p">)</span> 
<span class="go">&lt;FakeDb object at ...&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="adaptateurs-avances">
<h2>Adaptateurs avancés<a class="headerlink" href="#adaptateurs-avances" title="Lien permanent vers ce titre">¶</a></h2>
<p>Ce chapître traite de concepts avancés comme les multi-adaptateurs, les
abonnés (subscribers) et les gestionnaires (handles).</p>
<div class="section" id="multi-adaptateur">
<h3>Multi-adaptateur<a class="headerlink" href="#multi-adaptateur" title="Lien permanent vers ce titre">¶</a></h3>
<p>Un adaptateur simple s'adapte normalement à un seul objet, mais un adaptateur
peut s'adapter à plusieurs objets. Si un adaptateur s'adapte à plus d'un objet,
il s'appelle un multi-adaptateur.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IAdapteeOne</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IAdapteeTwo</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IFunctionality</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyFunctionality</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IFunctionality</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IAdapteeOne</span><span class="p">,</span> <span class="n">IAdapteeTwo</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">one</span><span class="p">,</span> <span class="n">two</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">one</span> <span class="o">=</span> <span class="n">one</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">two</span> <span class="o">=</span> <span class="n">two</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">MyFunctionality</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">One</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IAdapteeOne</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Two</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IAdapteeTwo</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">one</span> <span class="o">=</span> <span class="n">One</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two</span> <span class="o">=</span> <span class="n">Two</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getMultiAdapter</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">getMultiAdapter</span><span class="p">((</span><span class="n">one</span><span class="p">,</span><span class="n">two</span><span class="p">),</span> <span class="n">IFunctionality</span><span class="p">)</span> 
<span class="go">&lt;MyFunctionality object at ...&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">myfunctionality</span> <span class="o">=</span> <span class="n">getMultiAdapter</span><span class="p">((</span><span class="n">one</span><span class="p">,</span><span class="n">two</span><span class="p">),</span> <span class="n">IFunctionality</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myfunctionality</span><span class="o">.</span><span class="n">one</span> 
<span class="go">&lt;One object at ...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myfunctionality</span><span class="o">.</span><span class="n">two</span> 
<span class="go">&lt;Two object at ...&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="adaptateur-d-abonnement">
<h3>Adaptateur d'abonnement<a class="headerlink" href="#adaptateur-d-abonnement" title="Lien permanent vers ce titre">¶</a></h3>
<p>À la différence des adaptateurs habituels, les adaptateurs d'abonnement sont
utilisés quand on veut récupérer tous les adaptateurs qui adaptent un objet à
une interface donnée. Un adaptateur d'abonnement est également appelé <cite>abonné</cite>.</p>
<p>Considérons un problème de validation. Nous avons des objets et nous voulons
vérifier s'ils satisfont à un certain critère. Nous définissons une interface
de validation</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IValidate</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="n">ob</span><span class="p">):</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Determine whether the object is valid</span>
<span class="gp">...</span><span class="sd"></span>
<span class="gp">... </span><span class="sd">        Return a string describing a validation problem.</span>
<span class="gp">... </span><span class="sd">        An empty string is returned to indicate that the</span>
<span class="gp">... </span><span class="sd">        object is valid.</span>
<span class="gp">... </span><span class="sd">        &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Nous avons également des documents</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDocument</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">summary</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Document summary&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">body</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Document text&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Document</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDocument</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">summary</span><span class="p">,</span> <span class="n">body</span>
</pre></div>
</div>
<p>Maintenant, nous pouvons avoir besoin de préciser différentes règles de
validation pour les documents. Par exemple, nous voulons que le résumé tienne
sur une seule ligne</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">SingleLineSummary</span><span class="p">:</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IDocument</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IValidate</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">summary</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="s">&#39;Summary should only have one line&#39;</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="s">&#39;&#39;</span>
</pre></div>
</div>
<p>Ou bien nous voulons que le corps du document fasse au moins 1000 caractères</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">AdequateLength</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IDocument</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IValidate</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="s">&#39;too short&#39;</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="s">&#39;&#39;</span>
</pre></div>
</div>
<p>Nous pouvons inscrire ces deux composants comme des adaptateurs d'abonnement</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerSubscriptionAdapter</span><span class="p">(</span><span class="n">SingleLineSummary</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerSubscriptionAdapter</span><span class="p">(</span><span class="n">AdequateLength</span><span class="p">)</span>
</pre></div>
</div>
<p>Nous pouvons ensuite utiliser ces abonnés pour valider les objets</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">subscribers</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="s">&quot;A</span><span class="se">\n</span><span class="s">Document&quot;</span><span class="p">,</span> <span class="s">&quot;blah&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">adapter</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<span class="gp">... </span> <span class="k">for</span> <span class="n">adapter</span> <span class="ow">in</span> <span class="n">subscribers</span><span class="p">([</span><span class="n">doc</span><span class="p">],</span> <span class="n">IValidate</span><span class="p">)</span>
<span class="gp">... </span> <span class="k">if</span> <span class="n">adapter</span><span class="o">.</span><span class="n">validate</span><span class="p">()]</span>
<span class="go">[&#39;Summary should only have one line&#39;, &#39;too short&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="s">&quot;A</span><span class="se">\n</span><span class="s">Document&quot;</span><span class="p">,</span> <span class="s">&quot;blah&quot;</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">adapter</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<span class="gp">... </span> <span class="k">for</span> <span class="n">adapter</span> <span class="ow">in</span> <span class="n">subscribers</span><span class="p">([</span><span class="n">doc</span><span class="p">],</span> <span class="n">IValidate</span><span class="p">)</span>
<span class="gp">... </span> <span class="k">if</span> <span class="n">adapter</span><span class="o">.</span><span class="n">validate</span><span class="p">()]</span>
<span class="go">[&#39;Summary should only have one line&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="s">&quot;A Document&quot;</span><span class="p">,</span> <span class="s">&quot;blah&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">adapter</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<span class="gp">... </span> <span class="k">for</span> <span class="n">adapter</span> <span class="ow">in</span> <span class="n">subscribers</span><span class="p">([</span><span class="n">doc</span><span class="p">],</span> <span class="n">IValidate</span><span class="p">)</span>
<span class="gp">... </span> <span class="k">if</span> <span class="n">adapter</span><span class="o">.</span><span class="n">validate</span><span class="p">()]</span>
<span class="go">[&#39;too short&#39;]</span>
</pre></div>
</div>
</div>
<div class="section" id="gestionnaire">
<h3>Gestionnaire<a class="headerlink" href="#gestionnaire" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les gestionnaires sont des fabriques d'abonnés qui ne
produisent rien du tout. Ils font la totalité de leur travail lorsqu'ils sont
appelés. Les gestionnaires sont typiquement utilisés pour gérer des événements.
Les gestionnaires sont aussi connus sous le nom d'<tt class="docutils literal"><span class="pre">abonnés</span>
<span class="pre">à</span> <span class="pre">des</span> <span class="pre">événements</span></tt> ou <tt class="docutils literal"><span class="pre">adaptateurs</span> <span class="pre">d'abonnement</span> <span class="pre">à</span> <span class="pre">des</span> <span class="pre">événements</span></tt>.</p>
<p>Les abonnés à des événements sont différents des autres abonnés car l'objet qui
appelle les abonnés ne s'attend pas à interagir avec eux d'une quelconque façon.
Par exemple, un publicateur d'événements ne s'attend pas à récupérer une valeur
de retour. Comme les abonnés n'ont pas besoin de fournir une API aux objets qui
les appellent, il est plus naturel de les définir avec des fonctions, plutôt
qu'avec des classes. Par exemple, dans un système de gestion de documents, nous
pouvons avoir besoin de gérer les heures de création des documents</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">documentCreated</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">event</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
</pre></div>
</div>
<p>Dans cet exemple, nous avons une fonction qui prend un événement et effectue un
traitement. La fonction ne retourne en fait rien du tout. C'est un cas
particulier de l'adaptateur d'abonnement qui s'adapte à un événement et ne
fournit rien. Tout le travail est effectué lorsque la fabrique de l'adaptateur
est appelée. Nous appelons les abonnés qui ne fabriquent rien des « gestionnaires ».
Il existe des APIs spécialisées dans leur inscription et leur récupération.</p>
<p>Pour inscrire l'abonné ci-dessus, nous définissons un événement « document créé
»</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDocumentCreated</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">doc</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;The document that was created&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">DocumentCreated</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDocumentCreated</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span>
</pre></div>
</div>
<p>Nous modifions également notre définition du gestionnaire</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">documentCreated</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">event</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapter</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nd">@adapter</span><span class="p">(</span><span class="n">IDocumentCreated</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">documentCreated</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">event</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>
</pre></div>
</div>
<p>Ceci marque le gestionnaire comme étant un adaptateur des événements
<cite>IDocumentCreated</cite>.</p>
<p>Nous inscrivons le gestionnaire</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerHandler</span><span class="p">(</span><span class="n">documentCreated</span><span class="p">)</span>
</pre></div>
</div>
<p>Il est maintenant possible de créer un événement et d'utiliser la fonction
<cite>handle</cite> pour appeler les gestionnaires inscrits à l'événement</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">handle</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span><span class="p">(</span><span class="n">DocumentCreated</span><span class="p">(</span><span class="n">doc</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">created</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span>
<span class="go">&#39;datetime&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="usage-de-la-zca-dans-zope">
<h2>Usage de la ZCA dans Zope<a class="headerlink" href="#usage-de-la-zca-dans-zope" title="Lien permanent vers ce titre">¶</a></h2>
<p>L'Architecture de Composants de Zope est utilisée dans Zope 2 et dans Zope 3. Ce
chapitre traite de l'usage de la ZCA dans Zope.</p>
<div class="section" id="zcml">
<h3>ZCML<a class="headerlink" href="#zcml" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le <strong>Zope Configuration Markup Language (ZCML)</strong> est un système de configuration
pour l'inscription des composants. Au lieu d'utiliser l'API Python pour les
inscriptions, vous pouvez utiliser le ZCML. Pour pouvoir utiliser le ZCML,
vous devez installer des paquets supplémentaires.</p>
<p>Vous pouvez installer <tt class="docutils literal"><span class="pre">zope.component</span></tt> avec la prise en charge du ZCML en
utilisant easy_install comme ceci</p>
<div class="highlight-python"><pre>$ easy_install "zope.component [zcml]"</pre>
</div>
<p>Un fichier ZCML doit commencer par une directive <tt class="docutils literal"><span class="pre">configure</span></tt> avec la
déclaration d'espace de nom appropriée</p>
<div class="highlight-python"><pre>&lt;configure xmlns="http://namespaces.zope.org/zope"&gt;
...
&lt;/configure&gt;</pre>
</div>
<p>La directive <cite>adapter</cite> peut être utilisée pour inscrire des adaptateurs</p>
<div class="highlight-python"><pre>&lt;adapter
    factory=".company.EmployeeSalary"
    provides=".interfaces.ISalary"
    for=".interfaces.IEmployee"
    /&gt;</pre>
</div>
<p>Les attributs <cite>provides</cite> et <cite>for</cite> sont optionnels, à condition que vous ayez
fait les déclaration correspondantes dans l'implémentation</p>
<div class="highlight-python"><pre>&lt;adapter
    factory=".company.EmployeeSalary"
    /&gt;</pre>
</div>
<p>Si vous voulez inscrire le composant comme un adaptateur nommé, vous pouvez
utiliser l'attribut <cite>name</cite></p>
<div class="highlight-python"><pre>&lt;adapter
    factory=".company.EmployeeSalary"
    name="salary"
    /&gt;</pre>
</div>
<p>Un utilitaire peut être inscrit avec la directive <cite>utility</cite></p>
<div class="highlight-python"><pre>&lt;utility
    component=".database.connection"
    provides=".interfaces.IConnection"
    /&gt;</pre>
</div>
<p>L'attribut <cite>provides</cite> est optionnel, à condition que vous ayez fait la
déclaration correspondante dans l'implémentation</p>
<div class="highlight-python"><pre>&lt;configure xmlns="http://namespaces.zope.org/zope"&gt;

&lt;utility
    component=".database.connection"
    /&gt;</pre>
</div>
<p>Si vous voulez inscrire le composant comme un utilitaire nommé, vous pouvez
utiliser l'attribut <cite>name</cite></p>
<div class="highlight-python"><pre>&lt;utility
    component=".database.connection"
    name="db_connection"
    /&gt;</pre>
</div>
<p>Plutôt que d'utiliser directement le composant, vous pouvez aussi fournir une
fabrique</p>
<div class="highlight-python"><pre>&lt;utility
    factory=".database.Connection"
    /&gt;</pre>
</div>
</div>
<div class="section" id="surchargements">
<h3>Surchargements<a class="headerlink" href="#surchargements" title="Lien permanent vers ce titre">¶</a></h3>
<p>Lorsque vous inscrivez des composants avec l'API Python (méthodes
<tt class="docutils literal"><span class="pre">register*</span></tt>), le dernier composant inscrit remplace le précédent, si les deux
sont inscrits avec les mêmes arguments. Considérons l'exemple suivant</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IA</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IP</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">AP</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IP</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IA</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="n">context</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">AP2</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IP</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IA</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="n">context</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IA</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ap</span> <span class="o">=</span> <span class="n">AP</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">AP</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">getAdapter</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">IP</span><span class="p">)</span> 
<span class="go">&lt;AP object at ...&gt;</span>
</pre></div>
</div>
<p>Si vous inscrivez un autre adaptateur, celui existant sera surchargé</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">AP2</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">getAdapter</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">IP</span><span class="p">)</span> 
<span class="go">&lt;AP2 object at ...&gt;</span>
</pre></div>
</div>
<p>Mais lorsque vous inscrivez des composants en ZCML, la deuxième inscription
provoquera un conflit. Ceci est fait pour éviter les surchargements accidentels
d'inscriptions, qui sont difficiles à retrouver et corriger.
L'utilisation de ZCML est donc un avantage pour votre application.</p>
<p>Parfois vous aurez besoin de surcharger une inscription existante. ZCML fournit
une directive <tt class="docutils literal"><span class="pre">includeOverrides</span></tt> à cet effet. Avec la directive ci-dessous,
vous pouvez écrire vos surcharges dans un fichier séparé</p>
<div class="highlight-python"><pre>&lt;includeOverrides file="overrides.zcml" /&gt;</pre>
</div>
</div>
<div class="section" id="namechooser">
<h3>NameChooser<a class="headerlink" href="#namechooser" title="Lien permanent vers ce titre">¶</a></h3>
<p>Emplacement : <cite>zope.app.container.contained.NameChooser</cite></p>
<p>C'est un adaptateur qui choisit un nom unique pour un objet dans un conteneur.</p>
<p>L'inscription de l'adaptateur ressemble à ceci</p>
<div class="highlight-python"><pre>&lt;adapter
    provides=".interfaces.INameChooser"
    for="zope.app.container.interfaces.IWriteContainer"
    factory=".contained.NameChooser"
    /&gt;</pre>
</div>
<p>Dans cette inscription, vous pouvez observer qu'on s'adapte à un
<tt class="docutils literal"><span class="pre">IWriteContainer</span></tt> et que l'adaptateur fournit <tt class="docutils literal"><span class="pre">INameChooser</span></tt>.</p>
<p>Cet adaptateur fournit une fonctionnalité très pratique pour les développeurs
Zope. Les implémentations principales de <tt class="docutils literal"><span class="pre">IWriteContainer</span></tt> dans Zope 3 sont
<cite>zope.app.container.BTreeContainer`</cite> et <tt class="docutils literal"><span class="pre">zope.app.folder.Folder</span></tt>. Normalement
vous hériterez de ces implémentations pour créer vos propres classes de
conteneurs. Supposez qu'il n'y ait pas d'interface <tt class="docutils literal"><span class="pre">INameChooser</span></tt> ni
d'adaptateur : vous seriez obligé de recréer cette fonctionnalité séparément
pour chaque implémentation.</p>
</div>
<div class="section" id="locationphysicallylocatable">
<h3>LocationPhysicallyLocatable<a class="headerlink" href="#locationphysicallylocatable" title="Lien permanent vers ce titre">¶</a></h3>
<p>Emplacement :
<tt class="docutils literal"><span class="pre">zope.location.traversing.LocationPhysicallyLocatable</span></tt></p>
<p>Cet adaptateur est fréquemment utilisé dans les applications Zope 3, mais
habituellement il est appelé au travers d'une API dans <tt class="docutils literal"><span class="pre">zope.traversing.api</span></tt>.
(Certains vieux codes utilisent même les fonctions <tt class="docutils literal"><span class="pre">zope.app.zapi</span></tt> qui ne sont
qu'une indirection supplémentaire).</p>
<p>L'inscription de l'adaptateur ressemble à ceci</p>
<div class="highlight-python"><pre>&lt;adapter
    factory="zope.location.traversing.LocationPhysicallyLocatable"
    /&gt;</pre>
</div>
<p>L'interface fournie et l'interface adaptée sont données dans l'implémentation,
dont voici le début</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">LocationPhysicallyLocatable</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Provide location information for location objects</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">zope</span><span class="o">.</span><span class="n">component</span><span class="o">.</span><span class="n">adapts</span><span class="p">(</span><span class="n">ILocation</span><span class="p">)</span>
    <span class="n">zope</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">implements</span><span class="p">(</span><span class="n">IPhysicallyLocatable</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Normalement, presque tous les objets persistants d'une application Zope 3
fournissent l'interface <tt class="docutils literal"><span class="pre">ILocation</span></tt>. Cette interface n'a que deux attributs,
<tt class="docutils literal"><span class="pre">__parent__</span></tt> et <tt class="docutils literal"><span class="pre">__name__</span></tt>. <tt class="docutils literal"><span class="pre">__parent__</span></tt> est le parent dans la hiérarchie
des objets et <tt class="docutils literal"><span class="pre">__name__</span></tt> est le nom, vu depuis le parent.</p>
<p>L'interface <tt class="docutils literal"><span class="pre">IPhysicallyLocatable</span></tt> a quatre méthodes:
<tt class="docutils literal"><span class="pre">getRoot</span></tt>, <tt class="docutils literal"><span class="pre">getPath</span></tt>, <tt class="docutils literal"><span class="pre">getName</span></tt>, et <tt class="docutils literal"><span class="pre">getNearestSite</span></tt>.</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">getRoot</span></tt> renvoie l'objet racine physique.</li>
<li><tt class="docutils literal"><span class="pre">getPath</span></tt> renvoie une chaîne donnant le chemin physique vers l'objet.</li>
<li><tt class="docutils literal"><span class="pre">getName</span></tt> renvoie le dernier segment du chemin physique.</li>
<li><tt class="docutils literal"><span class="pre">getNearestSite</span></tt> renvoie le site dans lequel l'objet est contenu. Si
l'objet est lui-même un site, il est renvoyé.</li>
</ul>
</div></blockquote>
<p>Si vous apprenez Zope 3, ce sont des choses importantes dont vous aurez besoin
très souvent.  Pour comprendre la beauté de ce système, vous devriez regarder
comment Zope 2 récupère l'objet racine physique et comment ceci est implémenté.
Il existe une méthode <tt class="docutils literal"><span class="pre">getPhysicalRoot</span></tt> virtuellement pour tous les objets
conteneurs.</p>
</div>
<div class="section" id="defaultsized">
<h3>DefaultSized<a class="headerlink" href="#defaultsized" title="Lien permanent vers ce titre">¶</a></h3>
<p>Emplacement : <tt class="docutils literal"><span class="pre">zope.size.DefaultSized</span></tt></p>
<p>Cet adaptateur n'est qu'une implémentation par défaut de l'interface <tt class="docutils literal"><span class="pre">ISized</span></tt>.
Il est inscrit pour tous les types d'objets. Si vous voulez inscrire cet
adaptateur pour une interface particulière, vous devez surcharger cette
inscription avec votre implémentation.</p>
<p>L'inscription de l'adaptateur ressemble à ceci</p>
<div class="highlight-python"><pre>&lt;adapter
    for="*"
    factory="zope.size.DefaultSized"
    provides="zope.size.interfaces.ISized"
    permission="zope.View"
    /&gt;</pre>
</div>
<p>Comme vous pouvez voir, l'interface adaptée est « * », pour pouvoir s'adapter à
tous les types d'objets.</p>
<p><tt class="docutils literal"><span class="pre">ISized</span></tt> est une interface simple possédant deux méthodes</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ISized</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">sizeForSorting</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;Returns a tuple (basic_unit, amount)</span>

<span class="sd">        Used for sorting among different kinds of sized objects.</span>
<span class="sd">        &#39;amount&#39; need only be sortable among things that share the</span>
<span class="sd">        same basic unit.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">sizeForDisplay</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;Returns a string giving the size.</span>
<span class="sd">        &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Vous pouvez trouver un autre adaptateur <tt class="docutils literal"><span class="pre">ISized</span></tt> pour <tt class="docutils literal"><span class="pre">IZPTPage</span></tt> dans le
paquet <tt class="docutils literal"><span class="pre">zope.app.zptpage</span></tt>.</p>
</div>
<div class="section" id="zopeversionutility">
<h3>ZopeVersionUtility<a class="headerlink" href="#zopeversionutility" title="Lien permanent vers ce titre">¶</a></h3>
<p>Emplacement : <tt class="docutils literal"><span class="pre">zope.app.applicationcontrol.ZopeVersionUtility</span></tt></p>
<p>Cet utilitaire donne la version de Zope en fonctionnement.</p>
<p>L'inscription est la suivante</p>
<div class="highlight-python"><pre>&lt;utility
    component=".zopeversion.ZopeVersionUtility"
    provides=".interfaces.IZopeVersion" /&gt;</pre>
</div>
<p>L'interface fournie, <tt class="docutils literal"><span class="pre">IZopeVersion</span></tt>, n'a qu'une méthode nommée
<tt class="docutils literal"><span class="pre">getZopeVersion</span></tt>. Cette méthode renvoie une chaîne contenant la version de
Zope (avec éventuellement un changeset SVN).</p>
<p>L'implémentation par défaut, <tt class="docutils literal"><span class="pre">ZopeVersionUtility</span></tt>, récupère le numéro de
version dans un fichier <tt class="docutils literal"><span class="pre">version.txt</span></tt> du répertoire <cite>zope/app</cite>. Si Zope
fonctionne depuis un espace de travail Subversion, il montre le dernier numéro
de révision. Si aucun des deux ne fonctionne il renvoie <cite>DevCenter/Unknown</cite>.</p>
</div>
</div>
<div class="section" id="etude-de-cas">
<h2>Étude de cas<a class="headerlink" href="#etude-de-cas" title="Lien permanent vers ce titre">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Ce chapitre n'est pas terminé. Merci d'envoyer vos suggestions !</p>
</div>
<div class="section" id="id19">
<h3>Introduction<a class="headerlink" href="#id19" title="Lien permanent vers ce titre">¶</a></h3>
<p>Ce chapitre est un exemple de création d'une application lourde avec la
bibliothèque d'interface graphique PyGTK et la ZCA. Cette application utilise
également deux types différents de mécanismes de persistance des données : le
premier est une base de données objet (ZODB), l'autre est une base de données
relationnelle (SQLite). Cependant, en pratique, un seul des deux mécanismes peut
être utilisé dans une installation donnée. L'utilisation de deux types de
persistance est là pour démontrer comment utiliser la ZCA pour brancher des
composants entre eux. La majorité de code de cette application est lié à PyGTK.</p>
<p>Lorsque l'application grossit, vous pouvez utiliser les composants de la ZCA aux
endroits où vous souhaitez fournir de la modularité ou de l'extensibilité.
Utilisez des objets Python classiques quand vous n'avez pas besoin de ces
propriétés.</p>
<p>Il n'y a pas de différence entre l'utilisation de la ZCA pour une application
web, pour une application graphique lourde, ou pour toute autre application ou
framework. Il est préférable de suivre une convention pour l'emplacement où vous
allez inscrire les composants. Cette application utilise une convention qui peut
être étendue en plaçant des inscriptions ou des composants similaires dans des
modules séparés et en les important plus tard depuis le module principal
d'inscription. Dans cette application, le module principal pour l'inscription
est <cite>register.py</cite>.</p>
<p>Le code source de cette application peut être téléchargé sur :
<a class="reference external" href="http://www.muthukadan.net/downloads/zcalib.tar.bz2">http://www.muthukadan.net/downloads/zcalib.tar.bz2</a></p>
</div>
<div class="section" id="cas-d-utilisation">
<h3>Cas d'utilisation<a class="headerlink" href="#cas-d-utilisation" title="Lien permanent vers ce titre">¶</a></h3>
<p>L'application que nous allons créer ici est un système de gestion de
bibliothèque avec des fonctionnalités minimales. Les besoins peuvent être
résumés comme ceci:</p>
<ul class="simple">
<li>Ajouter des membres avec un numéro et un nom uniques.</li>
<li>Ajouter des livres avec un code barre, un auteur et un titre.</li>
<li>Prêter des livres</li>
<li>Récupérer des livres</li>
</ul>
<p>L'application peut être conçue de telle façon que les grandes fonctionnalités
seront utilisées dans une fenêtre unique. La fenêtre principale peut être conçue
de cette façon :</p>
<img alt="_images/mainwindow.png" class="align-center" src="_images/mainwindow.png" />
<p>Depuis la fenêtre des membres, l'utilisateur devrait être capable de gérer des
membres. Donc il devrait être possible d'<em>ajouter</em>, <em>modifier</em> et <em>effacer</em> des
membres comme dans l'image ci-dessous :</p>
<img alt="_images/memberwindow.png" class="align-center" src="_images/memberwindow.png" />
<p>Similaire à la fenêtre des membres, la fenêtre du catalogue permet aux
utilisateurs d'<em>ajouter</em>, <em>modifier</em> et <em>effacer</em> des livres :</p>
<img alt="_images/catalogwindow.png" class="align-center" src="_images/catalogwindow.png" />
<p>La fenêtre de circulation doit avoir ce qu'il faut pour prêter et récupérer des
livres :</p>
<img alt="_images/circulationwindow.png" class="align-center" src="_images/circulationwindow.png" />
</div>
<div class="section" id="survol-du-code-pygtk">
<h3>Survol du code PyGTK<a class="headerlink" href="#survol-du-code-pygtk" title="Lien permanent vers ce titre">¶</a></h3>
<p>Vous pouvez constater que la majorité du code est en rapport avec PyGTK.
Sa structure est très similaire pour les différentes fenêtres. Les écrans
de cette application sont conçus avec le créateur d'interface graphiques Glade.
Vous devriez donner des noms appropriés aux widgets que vous allez utiliser dans
votre code. Dans la fenêtre principale, tous les éléments de menu ont des noms
du type : circulation, catalog, member, quit et about.</p>
<p>La classe <tt class="docutils literal"><span class="pre">gtk.glade.XML</span></tt> est utilisée pour analyser le fichier Glade, et donc
pour créer les objets widgets de l'interface graphique. Voici comment faire</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">gtk.glade</span>
<span class="n">xmlobj</span> <span class="o">=</span> <span class="n">gtk</span><span class="o">.</span><span class="n">glade</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="s">&#39;/path/to/file.glade&#39;</span><span class="p">)</span>
<span class="n">widget</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;widget_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Dans mainwindow.py, vous pouvez voir le code suivant</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">curdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span>
<span class="n">xml</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">curdir</span><span class="p">,</span> <span class="s">&#39;glade&#39;</span><span class="p">,</span> <span class="s">&#39;mainwindow.glade&#39;</span><span class="p">)</span>
<span class="n">xmlobj</span> <span class="o">=</span> <span class="n">gtk</span><span class="o">.</span><span class="n">glade</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">xml</span><span class="p">)</span>

<span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;mainwindow&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Le nom du widget fenêtre principal est <cite>mainwindow</cite>. Les autres widgets sont
créés de la même manière</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">circulation</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;circulation&#39;</span><span class="p">)</span>
<span class="n">member</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;member&#39;</span><span class="p">)</span>
<span class="n">quit</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;quit&#39;</span><span class="p">)</span>
<span class="n">catalog</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;catalog&#39;</span><span class="p">)</span>
<span class="n">about</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;about&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Ensuite ces widgets sont connectés à certains événements</p>
<div class="highlight-python"><div class="highlight"><pre><span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;delete_event&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_event</span><span class="p">)</span>
<span class="n">quit</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;activate&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_event</span><span class="p">)</span>
<span class="n">circulation</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;activate&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_circulation_activate</span><span class="p">)</span>
<span class="n">member</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;activate&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_member_activate</span><span class="p">)</span>
<span class="n">catalog</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;activate&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_catalog_activate</span><span class="p">)</span>
<span class="n">about</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;activate&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_about_activate</span><span class="p">)</span>
</pre></div>
</div>
<p>L'événement <cite>delete_event</cite> est celui correspondant à la fermeture de la fenêtre lors
de l'appui sur le bouton de fermeture. L'événement <cite>activate</cite> est émis lorsque
le menu est sélectionné. Les widgets sont connectés à des fonctions de rappel
pour certains événements.</p>
<p>Vous pouvez voir dans le code ci-dessus que la fenêtre principale est connectée
à la méthode <cite>on_delete_event</cite> pour l'événement <cite>delete_event</cite>. Le widget <cite>quit</cite>
est aussi connecté aux mêmes méthodes pour l'événement <cite>activate</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">on_delete_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">gtk</span><span class="o">.</span><span class="n">main_quit</span><span class="p">()</span>
</pre></div>
</div>
<p>La fonction de rappel lance juste la fonction <cite>main_quit</cite>.</p>
</div>
<div class="section" id="le-code">
<h3>Le code<a class="headerlink" href="#le-code" title="Lien permanent vers ce titre">¶</a></h3>
<p>Voici <cite>zcalib.py</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">registry</span>
<span class="kn">import</span> <span class="nn">mainwindow</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">registry</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">mainwindow</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
        <span class="kn">import</span> <span class="nn">sys</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Ici, deux modules sont importés : <cite>registry</cite> et <cite>mainwindow</cite>.
Ensuite le registre est initialisé et la fonction <cite>main</cite> de la fenêtre
principale est appelée. Si l'utilisateur essaye de fermer l'application en
appuyant sur <cite>Ctrl-C</cite>, celle-ci s'arrête normalement car nous avons intercepté
l'exception <cite>KeyboardInterrupt</cite>.</p>
<p>Voici <cite>registry.py</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>

<span class="kn">from</span> <span class="nn">interfaces</span> <span class="kn">import</span> <span class="n">IMember</span>
<span class="kn">from</span> <span class="nn">interfaces</span> <span class="kn">import</span> <span class="n">IBook</span>
<span class="kn">from</span> <span class="nn">interfaces</span> <span class="kn">import</span> <span class="n">ICirculation</span>
<span class="kn">from</span> <span class="nn">interfaces</span> <span class="kn">import</span> <span class="n">IDbOperation</span>


<span class="k">def</span> <span class="nf">initialize_rdb</span><span class="p">():</span>
    <span class="kn">from</span> <span class="nn">interfaces</span> <span class="kn">import</span> <span class="n">IRelationalDatabase</span>
    <span class="kn">from</span> <span class="nn">relationaldatabase</span> <span class="kn">import</span> <span class="n">RelationalDatabase</span>
    <span class="kn">from</span> <span class="nn">member</span> <span class="kn">import</span> <span class="n">MemberRDbOperation</span>
    <span class="kn">from</span> <span class="nn">catalog</span> <span class="kn">import</span> <span class="n">BookRDbOperation</span>
    <span class="kn">from</span> <span class="nn">circulation</span> <span class="kn">import</span> <span class="n">CirculationRDbOperation</span>

    <span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">RelationalDatabase</span><span class="p">()</span>
    <span class="n">gsm</span><span class="o">.</span><span class="n">registerUtility</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">IRelationalDatabase</span><span class="p">)</span>

    <span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">MemberRDbOperation</span><span class="p">,</span>
                        <span class="p">(</span><span class="n">IMember</span><span class="p">,),</span>
                        <span class="n">IDbOperation</span><span class="p">)</span>

    <span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">BookRDbOperation</span><span class="p">,</span>
                        <span class="p">(</span><span class="n">IBook</span><span class="p">,),</span>
                        <span class="n">IDbOperation</span><span class="p">)</span>

    <span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">CirculationRDbOperation</span><span class="p">,</span>
                        <span class="p">(</span><span class="n">ICirculation</span><span class="p">,),</span>
                        <span class="n">IDbOperation</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">initialize_odb</span><span class="p">():</span>
    <span class="kn">from</span> <span class="nn">interfaces</span> <span class="kn">import</span> <span class="n">IObjectDatabase</span>
    <span class="kn">from</span> <span class="nn">objectdatabase</span> <span class="kn">import</span> <span class="n">ObjectDatabase</span>
    <span class="kn">from</span> <span class="nn">member</span> <span class="kn">import</span> <span class="n">MemberODbOperation</span>
    <span class="kn">from</span> <span class="nn">catalog</span> <span class="kn">import</span> <span class="n">BookODbOperation</span>
    <span class="kn">from</span> <span class="nn">circulation</span> <span class="kn">import</span> <span class="n">CirculationODbOperation</span>

    <span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">ObjectDatabase</span><span class="p">()</span>
    <span class="n">gsm</span><span class="o">.</span><span class="n">registerUtility</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">IObjectDatabase</span><span class="p">)</span>

    <span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">MemberODbOperation</span><span class="p">,</span>
                        <span class="p">(</span><span class="n">IMember</span><span class="p">,),</span>
                        <span class="n">IDbOperation</span><span class="p">)</span>

    <span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">BookODbOperation</span><span class="p">,</span>
                        <span class="p">(</span><span class="n">IBook</span><span class="p">,),</span>
                        <span class="n">IDbOperation</span><span class="p">)</span>

    <span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">CirculationODbOperation</span><span class="p">,</span>
                        <span class="p">(</span><span class="n">ICirculation</span><span class="p">,),</span>
                        <span class="n">IDbOperation</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">check_use_relational_db</span><span class="p">():</span>
    <span class="n">use_rdb</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">arg</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">arg</span> <span class="o">==</span> <span class="s">&#39;-r&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">use_rdb</span>

<span class="k">def</span> <span class="nf">initialize</span><span class="p">():</span>
    <span class="n">use_rdb</span> <span class="o">=</span> <span class="n">check_use_relational_db</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">use_rdb</span><span class="p">:</span>
        <span class="n">initialize_rdb</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">initialize_odb</span><span class="p">()</span>
</pre></div>
</div>
<p>Observez la fonction <cite>initialize</cite> que nous appelons depuis le module principal
<cite>zcalib.py</cite>. Cette fonction commence par vérifier quelle base de données
utiliser : une base relationnelle (RDB) ou une base objet (ODB). Cette
vérification est effectuée dans la fonction <cite>check_use_relational_db</cite>. Si
l'option <cite>-r</cite> est passé dans la ligne de commandes, elle appelera la fonction
<cite>initialize_rdb</cite>, sinon <cite>initialize_odb</cite>. Si la fonction RDB est appelée, elle
configure tous les composants liés à la base relationnelle. Si la fonction ODB est appelée,
elle configure tous les composants liés à la base objet.</p>
<p>Voici <cite>mainwindow.py</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">gtk</span>
<span class="kn">import</span> <span class="nn">gtk.glade</span>

<span class="kn">from</span> <span class="nn">circulationwindow</span> <span class="kn">import</span> <span class="n">circulationwindow</span>
<span class="kn">from</span> <span class="nn">catalogwindow</span> <span class="kn">import</span> <span class="n">catalogwindow</span>
<span class="kn">from</span> <span class="nn">memberwindow</span> <span class="kn">import</span> <span class="n">memberwindow</span>

<span class="k">class</span> <span class="nc">MainWindow</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">curdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span>
        <span class="n">xml</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">curdir</span><span class="p">,</span> <span class="s">&#39;glade&#39;</span><span class="p">,</span> <span class="s">&#39;mainwindow.glade&#39;</span><span class="p">)</span>
        <span class="n">xmlobj</span> <span class="o">=</span> <span class="n">gtk</span><span class="o">.</span><span class="n">glade</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">xml</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;mainwindow&#39;</span><span class="p">)</span>
        <span class="n">circulation</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;circulation&#39;</span><span class="p">)</span>
        <span class="n">member</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;member&#39;</span><span class="p">)</span>
        <span class="n">quit</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;quit&#39;</span><span class="p">)</span>
        <span class="n">catalog</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;catalog&#39;</span><span class="p">)</span>
        <span class="n">about</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;about&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;delete_event&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_event</span><span class="p">)</span>
        <span class="n">quit</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;activate&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_event</span><span class="p">)</span>

        <span class="n">circulation</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;activate&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_circulation_activate</span><span class="p">)</span>
        <span class="n">member</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;activate&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_member_activate</span><span class="p">)</span>
        <span class="n">catalog</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;activate&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_catalog_activate</span><span class="p">)</span>
        <span class="n">about</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;activate&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_about_activate</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">gtk</span><span class="o">.</span><span class="n">main_quit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">on_circulation_activate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">circulationwindow</span><span class="o">.</span><span class="n">show_all</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">on_member_activate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">memberwindow</span><span class="o">.</span><span class="n">show_all</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">on_catalog_activate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">catalogwindow</span><span class="o">.</span><span class="n">show_all</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">on_about_activate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainwindow</span><span class="o">.</span><span class="n">show_all</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">mainwindow</span> <span class="o">=</span> <span class="n">MainWindow</span><span class="p">()</span>
    <span class="n">mainwindow</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="n">gtk</span><span class="o">.</span><span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>La fonction <cite>main</cite> crée une instance de la classe <cite>MainWindow</cite> qui initialise
tous les widgets.</p>
<p>Voici <cite>memberwindow.py</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">gtk</span>
<span class="kn">import</span> <span class="nn">gtk.glade</span>

<span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getAdapter</span>

<span class="kn">from</span> <span class="nn">components</span> <span class="kn">import</span> <span class="n">Member</span>
<span class="kn">from</span> <span class="nn">interfaces</span> <span class="kn">import</span> <span class="n">IDbOperation</span>


<span class="k">class</span> <span class="nc">MemberWindow</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">curdir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span>
        <span class="n">xml</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">curdir</span><span class="p">,</span> <span class="s">&#39;glade&#39;</span><span class="p">,</span> <span class="s">&#39;memberwindow.glade&#39;</span><span class="p">)</span>
        <span class="n">xmlobj</span> <span class="o">=</span> <span class="n">gtk</span><span class="o">.</span><span class="n">glade</span><span class="o">.</span><span class="n">XML</span><span class="p">(</span><span class="n">xml</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">memberwindow</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;memberwindow&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;number&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span>
        <span class="n">add</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;add&#39;</span><span class="p">)</span>
        <span class="n">update</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;update&#39;</span><span class="p">)</span>
        <span class="n">delete</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;delete&#39;</span><span class="p">)</span>
        <span class="n">close</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;close&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeview</span> <span class="o">=</span> <span class="n">xmlobj</span><span class="o">.</span><span class="n">get_widget</span><span class="p">(</span><span class="s">&#39;treeview&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">memberwindow</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;delete_event&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_delete_event</span><span class="p">)</span>
        <span class="n">add</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;clicked&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_add_clicked</span><span class="p">)</span>
        <span class="n">update</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;clicked&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_update_clicked</span><span class="p">)</span>
        <span class="n">delete</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;clicked&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_delete_clicked</span><span class="p">)</span>
        <span class="n">close</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&#39;clicked&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">on_delete_event</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">initialize_list</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">show_all</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populate_list_store</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memberwindow</span><span class="o">.</span><span class="n">show_all</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">populate_list_store</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_store</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">member</span> <span class="o">=</span> <span class="n">Member</span><span class="p">()</span>
        <span class="n">memberdboperation</span> <span class="o">=</span> <span class="n">getAdapter</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">IDbOperation</span><span class="p">)</span>
        <span class="n">members</span> <span class="o">=</span> <span class="n">memberdboperation</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">members</span><span class="p">:</span>
            <span class="n">number</span> <span class="o">=</span> <span class="n">member</span><span class="o">.</span><span class="n">number</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">member</span><span class="o">.</span><span class="n">name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_store</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">member</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">name</span><span class="p">,))</span>

    <span class="k">def</span> <span class="nf">on_delete_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memberwindow</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">initialize_list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_store</span> <span class="o">=</span> <span class="n">gtk</span><span class="o">.</span><span class="n">ListStore</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">set_model</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_store</span><span class="p">)</span>
        <span class="n">tvcolumn</span> <span class="o">=</span> <span class="n">gtk</span><span class="o">.</span><span class="n">TreeViewColumn</span><span class="p">(</span><span class="s">&#39;Member Number&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">append_column</span><span class="p">(</span><span class="n">tvcolumn</span><span class="p">)</span>

        <span class="n">cell</span> <span class="o">=</span> <span class="n">gtk</span><span class="o">.</span><span class="n">CellRendererText</span><span class="p">()</span>
        <span class="n">tvcolumn</span><span class="o">.</span><span class="n">pack_start</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">tvcolumn</span><span class="o">.</span><span class="n">add_attribute</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">tvcolumn</span> <span class="o">=</span> <span class="n">gtk</span><span class="o">.</span><span class="n">TreeViewColumn</span><span class="p">(</span><span class="s">&#39;Member Name&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">append_column</span><span class="p">(</span><span class="n">tvcolumn</span><span class="p">)</span>

        <span class="n">cell</span> <span class="o">=</span> <span class="n">gtk</span><span class="o">.</span><span class="n">CellRendererText</span><span class="p">()</span>
        <span class="n">tvcolumn</span><span class="o">.</span><span class="n">pack_start</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">tvcolumn</span><span class="o">.</span><span class="n">add_attribute</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="s">&#39;text&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">on_add_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
        <span class="n">member</span> <span class="o">=</span> <span class="n">Member</span><span class="p">()</span>
        <span class="n">member</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">number</span>
        <span class="n">member</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">member</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_store</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">member</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">name</span><span class="p">,))</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">member</span><span class="p">):</span>
        <span class="n">memberdboperation</span> <span class="o">=</span> <span class="n">getAdapter</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">IDbOperation</span><span class="p">)</span>
        <span class="n">memberdboperation</span><span class="o">.</span><span class="n">add</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">on_update_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
        <span class="n">treeselection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">get_selection</span><span class="p">()</span>
        <span class="n">model</span><span class="p">,</span> <span class="nb">iter</span> <span class="o">=</span> <span class="n">treeselection</span><span class="o">.</span><span class="n">get_selected</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">iter</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">member</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_store</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="nb">iter</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">member</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">number</span>
        <span class="n">member</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">member</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_store</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="nb">iter</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">member</span><span class="p">):</span>
        <span class="n">memberdboperation</span> <span class="o">=</span> <span class="n">getAdapter</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">IDbOperation</span><span class="p">)</span>
        <span class="n">memberdboperation</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">on_delete_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">treeselection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">treeview</span><span class="o">.</span><span class="n">get_selection</span><span class="p">()</span>
        <span class="n">model</span><span class="p">,</span> <span class="nb">iter</span> <span class="o">=</span> <span class="n">treeselection</span><span class="o">.</span><span class="n">get_selected</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">iter</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">member</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_store</span><span class="o">.</span><span class="n">get_value</span><span class="p">(</span><span class="nb">iter</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">member</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_store</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="nb">iter</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">member</span><span class="p">):</span>
        <span class="n">memberdboperation</span> <span class="o">=</span> <span class="n">getAdapter</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">IDbOperation</span><span class="p">)</span>
        <span class="n">memberdboperation</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>

<span class="n">memberwindow</span> <span class="o">=</span> <span class="n">MemberWindow</span><span class="p">()</span>
</pre></div>
</div>
<p>Voici <cite>components.py</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="kn">from</span> <span class="nn">interfaces</span> <span class="kn">import</span> <span class="n">IBook</span>
<span class="kn">from</span> <span class="nn">interfaces</span> <span class="kn">import</span> <span class="n">IMember</span>
<span class="kn">from</span> <span class="nn">interfaces</span> <span class="kn">import</span> <span class="n">ICirculation</span>

<span class="k">class</span> <span class="nc">Book</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="n">implements</span><span class="p">(</span><span class="n">IBook</span><span class="p">)</span>

    <span class="n">barcode</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="n">author</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>

<span class="k">class</span> <span class="nc">Member</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="n">implements</span><span class="p">(</span><span class="n">IMember</span><span class="p">)</span>

    <span class="n">number</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>

<span class="k">class</span> <span class="nc">Circulation</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="n">implements</span><span class="p">(</span><span class="n">ICirculation</span><span class="p">)</span>

    <span class="n">book</span> <span class="o">=</span> <span class="n">Book</span><span class="p">()</span>
    <span class="n">member</span> <span class="o">=</span> <span class="n">Member</span><span class="p">()</span>
</pre></div>
</div>
<p>Voici <cite>interfaces.py</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>


<span class="k">class</span> <span class="nc">IBook</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>

    <span class="n">barcode</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Barcode&quot;</span><span class="p">)</span>
    <span class="n">author</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Author of book&quot;</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Title of book&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">IMember</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>

    <span class="n">number</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;ID number&quot;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of member&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">ICirculation</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>

    <span class="n">book</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;A book&quot;</span><span class="p">)</span>
    <span class="n">member</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;A member&quot;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">IRelationalDatabase</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">commit</span><span class="p">():</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">rollback</span><span class="p">():</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">cursor</span><span class="p">():</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">get_next_id</span><span class="p">():</span>
        <span class="k">pass</span>


<span class="k">class</span> <span class="nc">IObjectDatabase</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">commit</span><span class="p">():</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">rollback</span><span class="p">():</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">container</span><span class="p">():</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">get_next_id</span><span class="p">():</span>
        <span class="k">pass</span>


<span class="k">class</span> <span class="nc">IDbOperation</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">():</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">():</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">():</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">delete</span><span class="p">():</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p>Voici <cite>member.py</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getUtility</span>
<span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="kn">from</span> <span class="nn">components</span> <span class="kn">import</span> <span class="n">Member</span>

<span class="kn">from</span> <span class="nn">interfaces</span> <span class="kn">import</span> <span class="n">IRelationalDatabase</span>
<span class="kn">from</span> <span class="nn">interfaces</span> <span class="kn">import</span> <span class="n">IObjectDatabase</span>
<span class="kn">from</span> <span class="nn">interfaces</span> <span class="kn">import</span> <span class="n">IMember</span>
<span class="kn">from</span> <span class="nn">interfaces</span> <span class="kn">import</span> <span class="n">IDbOperation</span>


<span class="k">class</span> <span class="nc">MemberRDbOperation</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="n">implements</span><span class="p">(</span><span class="n">IDbOperation</span><span class="p">)</span>
    <span class="n">adapts</span><span class="p">(</span><span class="n">IMember</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">member</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">member</span> <span class="o">=</span> <span class="n">member</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">getUtility</span><span class="p">(</span><span class="n">IRelationalDatabase</span><span class="p">)</span>
        <span class="n">cr</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="n">number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="o">.</span><span class="n">number</span>
        <span class="k">if</span> <span class="n">number</span><span class="p">:</span>
            <span class="n">cr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&quot;&quot;&quot;SELECT</span>
<span class="s">                            id,</span>
<span class="s">                            number,</span>
<span class="s">                            name</span>
<span class="s">                          FROM members</span>
<span class="s">                          WHERE number = ?&quot;&quot;&quot;</span><span class="p">,</span>
                       <span class="p">(</span><span class="n">number</span><span class="p">,))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&quot;&quot;&quot;SELECT</span>
<span class="s">                            id,</span>
<span class="s">                            number,</span>
<span class="s">                            name</span>
<span class="s">                          FROM members&quot;&quot;&quot;</span><span class="p">)</span>
        <span class="n">rst</span> <span class="o">=</span> <span class="n">cr</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>
        <span class="n">cr</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">rst</span><span class="p">:</span>
            <span class="nb">id</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">]</span>
            <span class="n">number</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="s">&#39;number&#39;</span><span class="p">]</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
            <span class="n">member</span> <span class="o">=</span> <span class="n">Member</span><span class="p">()</span>
            <span class="n">member</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
            <span class="n">member</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">number</span>
            <span class="n">member</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
            <span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">member</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">members</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">getUtility</span><span class="p">(</span><span class="n">IRelationalDatabase</span><span class="p">)</span>
        <span class="n">cr</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="n">next_id</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_next_id</span><span class="p">(</span><span class="s">&quot;members&quot;</span><span class="p">)</span>
        <span class="n">number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="o">.</span><span class="n">number</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="o">.</span><span class="n">name</span>
        <span class="n">cr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&quot;&quot;&quot;INSERT INTO members</span>
<span class="s">                        (id, number, name)</span>
<span class="s">                      VALUES (?, ?, ?)&quot;&quot;&quot;</span><span class="p">,</span>
                   <span class="p">(</span><span class="n">next_id</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
        <span class="n">cr</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">next_id</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">getUtility</span><span class="p">(</span><span class="n">IRelationalDatabase</span><span class="p">)</span>
        <span class="n">cr</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="n">number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="o">.</span><span class="n">number</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="o">.</span><span class="n">name</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="o">.</span><span class="n">id</span>
        <span class="n">cr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&quot;&quot;&quot;UPDATE members</span>
<span class="s">                        SET</span>
<span class="s">                           number = ?,</span>
<span class="s">                           name = ?</span>
<span class="s">                      WHERE id = ?&quot;&quot;&quot;</span><span class="p">,</span>
                   <span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">id</span><span class="p">))</span>
        <span class="n">cr</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">getUtility</span><span class="p">(</span><span class="n">IRelationalDatabase</span><span class="p">)</span>
        <span class="n">cr</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="o">.</span><span class="n">id</span>
        <span class="n">cr</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s">&quot;&quot;&quot;DELETE FROM members</span>
<span class="s">                      WHERE id = ?&quot;&quot;&quot;</span><span class="p">,</span>
                   <span class="p">(</span><span class="nb">id</span><span class="p">,))</span>
        <span class="n">cr</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">MemberODbOperation</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="n">implements</span><span class="p">(</span><span class="n">IDbOperation</span><span class="p">)</span>
    <span class="n">adapts</span><span class="p">(</span><span class="n">IMember</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">member</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">member</span> <span class="o">=</span> <span class="n">member</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">getUtility</span><span class="p">(</span><span class="n">IObjectDatabase</span><span class="p">)</span>
        <span class="n">zcalibdb</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">container</span><span class="p">()</span>
        <span class="n">members</span> <span class="o">=</span> <span class="n">zcalibdb</span><span class="p">[</span><span class="s">&#39;members&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">members</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">getUtility</span><span class="p">(</span><span class="n">IObjectDatabase</span><span class="p">)</span>
        <span class="n">zcalibdb</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">container</span><span class="p">()</span>
        <span class="n">members</span> <span class="o">=</span> <span class="n">zcalibdb</span><span class="p">[</span><span class="s">&#39;members&#39;</span><span class="p">]</span>
        <span class="n">number</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="o">.</span><span class="n">number</span>
        <span class="k">if</span> <span class="n">number</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">number</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">members</span><span class="o">.</span><span class="n">values</span><span class="p">()]:</span>
            <span class="n">db</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;Duplicate key&quot;</span><span class="p">)</span>
        <span class="n">next_id</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">get_next_id</span><span class="p">(</span><span class="s">&#39;members&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">next_id</span>
        <span class="n">members</span><span class="p">[</span><span class="n">next_id</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">member</span>
        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">getUtility</span><span class="p">(</span><span class="n">IObjectDatabase</span><span class="p">)</span>
        <span class="n">zcalibdb</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">container</span><span class="p">()</span>
        <span class="n">members</span> <span class="o">=</span> <span class="n">zcalibdb</span><span class="p">[</span><span class="s">&#39;members&#39;</span><span class="p">]</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="o">.</span><span class="n">id</span>
        <span class="n">members</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">member</span>
        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">db</span> <span class="o">=</span> <span class="n">getUtility</span><span class="p">(</span><span class="n">IObjectDatabase</span><span class="p">)</span>
        <span class="n">zcalibdb</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">container</span><span class="p">()</span>
        <span class="n">members</span> <span class="o">=</span> <span class="n">zcalibdb</span><span class="p">[</span><span class="s">&#39;members&#39;</span><span class="p">]</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">member</span><span class="o">.</span><span class="n">id</span>
        <span class="k">del</span> <span class="n">members</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span>
        <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="pysqlite">
<h3>PySQLite<a class="headerlink" href="#pysqlite" title="Lien permanent vers ce titre">¶</a></h3>
</div>
<div class="section" id="zodb">
<h3>ZODB<a class="headerlink" href="#zodb" title="Lien permanent vers ce titre">¶</a></h3>
</div>
<div class="section" id="conclusions">
<h3>Conclusions<a class="headerlink" href="#conclusions" title="Lien permanent vers ce titre">¶</a></h3>
</div>
</div>
<div class="section" id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="adaptedby">
<h3>adaptedBy<a class="headerlink" href="#adaptedby" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette fonction permet de trouver les interfaces adaptées.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>adaptedBy(object)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adaptedBy</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FrontDeskNG</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDesk</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guest</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">guest</span> <span class="o">=</span> <span class="n">guest</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">adaptedBy</span><span class="p">(</span><span class="n">FrontDeskNG</span><span class="p">)</span>
<span class="go">(&lt;InterfaceClass __builtin__.IGuest&gt;,)</span>
</pre></div>
</div>
</div>
<div class="section" id="adapter">
<h3>adapter<a class="headerlink" href="#adapter" title="Lien permanent vers ce titre">¶</a></h3>
<p>Un adaptateur peut être n'importe quel objet appelable. Vous pouvez
utiliser le décorateur <cite>adapter</cite> pour déclarer qu'un objet appelable s'adapte à
des interfaces (ou des classes).</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>adapter(*interfaces)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implementer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IJob</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;A job&quot;&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Job</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IJob</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">job</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Job&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IPerson</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="bp">None</span>
<span class="gp">... </span>    <span class="n">job</span> <span class="o">=</span> <span class="bp">None</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nd">@implementer</span><span class="p">(</span><span class="n">IJob</span><span class="p">)</span>
<span class="gp">... </span><span class="nd">@adapter</span><span class="p">(</span><span class="n">IPerson</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">personJob</span><span class="p">(</span><span class="n">person</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">person</span><span class="o">.</span><span class="n">job</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Person</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Jack&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">job</span> <span class="o">=</span> <span class="n">Job</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">personJob</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span> 
<span class="go">&lt;Job object at ...&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="adapts">
<h3>adapts<a class="headerlink" href="#adapts" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette fonction permet de déclarer les classes adaptateurs.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>adapts(*interfaces)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FrontDeskNG</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDesk</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guest</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">guest</span> <span class="o">=</span> <span class="n">guest</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">next_id</span> <span class="o">=</span> <span class="n">get_next_id</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">bookings_db</span><span class="p">[</span><span class="n">next_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;place&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">place</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;phone&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">phone</span>
<span class="gp">... </span>        <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="alsoprovides">
<h3>alsoProvides<a class="headerlink" href="#alsoprovides" title="Lien permanent vers ce titre">¶</a></h3>
<p>Déclare des interfaces additionnelles fournies par un objet. Les arguments après
l'objet sont une ou plusieurs interfaces. Les interfaces données sont ajoutées
aux interfaces précédemment déclarées pour l'objet.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.interface</span></tt></li>
<li>Signature : <cite>alsoProvides(object, *interfaces)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">alsoProvides</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of person&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IStudent</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">college</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of college&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDesk</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Person</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Jack&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">college</span> <span class="o">=</span> <span class="s">&quot;New College&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alsoProvides</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">IStudent</span><span class="p">)</span>

<span class="go">Vous pouvez tester de cette façon:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">providedBy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IStudent</span> <span class="ow">in</span> <span class="n">providedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="attribute">
<h3>Attribute<a class="headerlink" href="#attribute" title="Lien permanent vers ce titre">¶</a></h3>
<p>En utilisant cette classe, vous pouvez définir des attributs dans une interface.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.interface</span></tt></li>
<li>Signature : <cite>Attribute(name, doc='')</cite></li>
<li>Voir aussi : <a class="reference internal" href="#interface">Interface</a></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of person&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">email</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Email Address&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="classimplements">
<h3>classImplements<a class="headerlink" href="#classimplements" title="Lien permanent vers ce titre">¶</a></h3>
<p>Déclare des interfaces additionnelles qui doivent être fournies par les
instances d'une classe. Les arguments après la classe sont une ou plusieurs
interfaces. Les interfaces données sont ajoutées aux interfaces précédemment
déclarées.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.interface</span></tt></li>
<li>Signature : <cite>classImplements(cls, *interfaces)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">classImplements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of person&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IStudent</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">college</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of college&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDesk</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>
<span class="gp">... </span>    <span class="n">college</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">classImplements</span><span class="p">(</span><span class="n">Person</span><span class="p">,</span> <span class="n">IStudent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Person</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Jack&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">college</span> <span class="o">=</span> <span class="s">&quot;New College&quot;</span>

<span class="go">Vous pouvez tester de cette façon :</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">providedBy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IStudent</span> <span class="ow">in</span> <span class="n">providedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="classimplementsonly">
<h3>classImplementsOnly<a class="headerlink" href="#classimplementsonly" title="Lien permanent vers ce titre">¶</a></h3>
<p>Déclare les seules interfaces qui devront être fournies par les instances d'une
classe. Les arguments après la classe sont une ou plusieurs interfaces. Les
interfaces fournies vont remplacer toutes les interfaces des déclarations
précédentes.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.interface</span></tt></li>
<li>Signature : <cite>classImplementsOnly(cls, *interfaces)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">classImplementsOnly</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of person&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IStudent</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">college</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of college&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IPerson</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">college</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">classImplementsOnly</span><span class="p">(</span><span class="n">Person</span><span class="p">,</span> <span class="n">IStudent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Person</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">college</span> <span class="o">=</span> <span class="s">&quot;New College&quot;</span>

<span class="go">Vous pouvez tester de cette façon :</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">providedBy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IPerson</span> <span class="ow">in</span> <span class="n">providedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IStudent</span> <span class="ow">in</span> <span class="n">providedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="classprovides">
<h3>classProvides<a class="headerlink" href="#classprovides" title="Lien permanent vers ce titre">¶</a></h3>
<p>Normalement si une classe implémente une interface particulière, les instances
de cette classe fourniront l'interface implémentée par la classe. Mais si vous
voulez qu'une classe fournisse une interface, vous pouvez le déclarer grâce à la
fonction <tt class="docutils literal"><span class="pre">classProvides</span></tt>.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.interface</span></tt></li>
<li>Signature : <cite>classProvides(*interfaces)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">classProvides</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of person&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">classProvides</span><span class="p">(</span><span class="n">IPerson</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="s">u&quot;Jack&quot;</span>

<span class="go">Vous pouvez tester de cette façon :</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">providedBy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IPerson</span> <span class="ow">in</span> <span class="n">providedBy</span><span class="p">(</span><span class="n">Person</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="componentlookuperror">
<h3>ComponentLookupError<a class="headerlink" href="#componentlookuperror" title="Lien permanent vers ce titre">¶</a></h3>
<p>C'est l'exception levée quand une recherche de composant échoue.</p>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of person&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">person</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">getAdapter</span><span class="p">(</span><span class="n">person</span><span class="p">,</span> <span class="n">IPerson</span><span class="p">,</span> <span class="s">&#39;not-exists&#39;</span><span class="p">)</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ComponentLookupError</span>: <span class="n">...</span>
</pre></div>
</div>
</div>
<div class="section" id="createobject">
<h3>createObject<a class="headerlink" href="#createobject" title="Lien permanent vers ce titre">¶</a></h3>
<p>Crée un objet en utilisant une fabrique.</p>
<p>Cette fonction trouve une fabrique nommée dans le site courant et l'appelle avec
les arguments donnés. Si la bonne fabrique ne peut pas être trouvée, une erreur
<tt class="docutils literal"><span class="pre">ComponentLookupError</span></tt> est déclenchée. Sinon l'objet créé est renvoyé.</p>
<p>Un argument mot-clé contextuel peut être fourni pour rechercher une fabrique
dans un emplacement différent du site courant. (Bien sûr, cela signifie qu'il
est impossible de transmettre à la fabrique un argument mot-clé nommé « context ».</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>createObject(factory_name, *args, **kwargs)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDatabase</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">getConnection</span><span class="p">():</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Return connection object&quot;&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FakeDb</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDatabase</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">getConnection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;connection&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.factory</span> <span class="kn">import</span> <span class="n">Factory</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">factory</span> <span class="o">=</span> <span class="n">Factory</span><span class="p">(</span><span class="n">FakeDb</span><span class="p">,</span> <span class="s">&#39;FakeDb&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.interfaces</span> <span class="kn">import</span> <span class="n">IFactory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerUtility</span><span class="p">(</span><span class="n">factory</span><span class="p">,</span> <span class="n">IFactory</span><span class="p">,</span> <span class="s">&#39;fakedb&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">createObject</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">createObject</span><span class="p">(</span><span class="s">&#39;fakedb&#39;</span><span class="p">)</span> 
<span class="go">&lt;FakeDb object at ...&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="declaration">
<h3>Declaration<a class="headerlink" href="#declaration" title="Lien permanent vers ce titre">¶</a></h3>
<p>N'a pas besoin d'être utilisé directement.</p>
</div>
<div class="section" id="directlyprovidedby">
<h3>directlyProvidedBy<a class="headerlink" href="#directlyprovidedby" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette fonction renvoie les interfaces fournies directement par un objet donné.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.interface</span></tt></li>
<li>Signature : <cite>directlyProvidedBy(object)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of person&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IStudent</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">college</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of college&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">ISmartPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IPerson</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Person</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">u&quot;Jack&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">college</span> <span class="o">=</span> <span class="s">&quot;New College&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alsoProvides</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">ISmartPerson</span><span class="p">,</span> <span class="n">IStudent</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">directlyProvidedBy</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack_dp</span> <span class="o">=</span> <span class="n">directlyProvidedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IPerson</span> <span class="ow">in</span> <span class="n">jack_dp</span><span class="o">.</span><span class="n">interfaces</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IStudent</span> <span class="ow">in</span> <span class="n">jack_dp</span><span class="o">.</span><span class="n">interfaces</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ISmartPerson</span> <span class="ow">in</span> <span class="n">jack_dp</span><span class="o">.</span><span class="n">interfaces</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="directlyprovides">
<h3>directlyProvides<a class="headerlink" href="#directlyprovides" title="Lien permanent vers ce titre">¶</a></h3>
<p>Déclare que des interfaces sont fournies directement par un objet. Les arguments
après l'objet sont une ou plusieurs interfaces. Les interfaces données
remplacent celles précédemment déclarées pour l'objet.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.interface</span></tt></li>
<li>Signature : <cite>directlyProvides(object, *interfaces)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of person&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IStudent</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">college</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of college&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">ISmartPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IPerson</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Person</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">u&quot;Jack&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">college</span> <span class="o">=</span> <span class="s">&quot;New College&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alsoProvides</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">ISmartPerson</span><span class="p">,</span> <span class="n">IStudent</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">directlyProvidedBy</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack_dp</span> <span class="o">=</span> <span class="n">directlyProvidedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ISmartPerson</span> <span class="ow">in</span> <span class="n">jack_dp</span><span class="o">.</span><span class="n">interfaces</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IPerson</span> <span class="ow">in</span> <span class="n">jack_dp</span><span class="o">.</span><span class="n">interfaces</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IStudent</span> <span class="ow">in</span> <span class="n">jack_dp</span><span class="o">.</span><span class="n">interfaces</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">providedBy</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ISmartPerson</span> <span class="ow">in</span> <span class="n">providedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">directlyProvides</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directlyProvides</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">IStudent</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack_dp</span> <span class="o">=</span> <span class="n">directlyProvidedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ISmartPerson</span> <span class="ow">in</span> <span class="n">jack_dp</span><span class="o">.</span><span class="n">interfaces</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IPerson</span> <span class="ow">in</span> <span class="n">jack_dp</span><span class="o">.</span><span class="n">interfaces</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IStudent</span> <span class="ow">in</span> <span class="n">jack_dp</span><span class="o">.</span><span class="n">interfaces</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">ISmartPerson</span> <span class="ow">in</span> <span class="n">providedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<div class="section" id="getadapter">
<h3>getAdapter<a class="headerlink" href="#getadapter" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette fonction récupère un adaptateur (nommé) vers une interface, pour un objet
donné. Elle renvoie un adaptateur qui peut adapter les objets à l'interface
voulue. Si aucun adaptateur ne peut être trouvé, une erreur
<tt class="docutils literal"><span class="pre">ComponentLookupError</span></tt> est émise.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.interface</span></tt></li>
<li>Signature : <cite>getAdapter(object, interface=Interface, name=u'', context=None)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDesk</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;A frontdesk will register object&#39;s details&quot;&quot;&quot;</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Register object&#39;s details&quot;&quot;&quot;</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FrontDeskNG</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDesk</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guest</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">guest</span> <span class="o">=</span> <span class="n">guest</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">next_id</span> <span class="o">=</span> <span class="n">get_next_id</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">bookings_db</span><span class="p">[</span><span class="n">next_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;place&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">place</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;phone&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">phone</span>
<span class="gp">... </span>        <span class="p">}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Guest</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">place</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">place</span> <span class="o">=</span> <span class="n">place</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Guest</span><span class="p">(</span><span class="s">&quot;Jack&quot;</span><span class="p">,</span> <span class="s">&quot;Bangalore&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack_frontdesk</span> <span class="o">=</span> <span class="n">FrontDeskNG</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">IDesk</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">jack_frontdesk</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">FrontDeskNG</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="p">(</span><span class="n">IGuest</span><span class="p">,),</span> <span class="n">IDesk</span><span class="p">,</span> <span class="s">&#39;ng&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">getAdapter</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">IDesk</span><span class="p">,</span> <span class="s">&#39;ng&#39;</span><span class="p">)</span> 
<span class="go">&lt;FrontDeskNG object at ...&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="getadapterincontext">
<h3>getAdapterInContext<a class="headerlink" href="#getadapterincontext" title="Lien permanent vers ce titre">¶</a></h3>
<p>Au lieu d'utiliser cette fonction, utilisez <a class="reference internal" href="#getadapter">getAdapter</a> avec un argument
<cite>context</cite>.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>getAdapterInContext(object, interface, context)</cite></li>
<li>Voir aussi : <a class="reference internal" href="#queryadapterincontext">queryAdapterInContext</a></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.globalregistry</span> <span class="kn">import</span> <span class="n">BaseGlobalComponents</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">IComponentLookup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sm</span> <span class="o">=</span> <span class="n">BaseGlobalComponents</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Context</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sm</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">sm</span> <span class="o">=</span> <span class="n">sm</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__conform__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">interface</span><span class="o">.</span><span class="n">isOrExtends</span><span class="p">(</span><span class="n">IComponentLookup</span><span class="p">):</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sm</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">sm</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDesk</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;A frontdesk will register object&#39;s details&quot;&quot;&quot;</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Register object&#39;s details&quot;&quot;&quot;</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FrontDeskNG</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDesk</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guest</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">guest</span> <span class="o">=</span> <span class="n">guest</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">next_id</span> <span class="o">=</span> <span class="n">get_next_id</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">bookings_db</span><span class="p">[</span><span class="n">next_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;place&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">place</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;phone&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">phone</span>
<span class="gp">... </span>        <span class="p">}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Guest</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">place</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">place</span> <span class="o">=</span> <span class="n">place</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Guest</span><span class="p">(</span><span class="s">&quot;Jack&quot;</span><span class="p">,</span> <span class="s">&quot;Bangalore&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack_frontdesk</span> <span class="o">=</span> <span class="n">FrontDeskNG</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">IDesk</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">jack_frontdesk</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">FrontDeskNG</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="p">(</span><span class="n">IGuest</span><span class="p">,),</span> <span class="n">IDesk</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getAdapterInContext</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">getAdapterInContext</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">IDesk</span><span class="p">,</span> <span class="n">sm</span><span class="p">)</span> 
<span class="go">&lt;FrontDeskNG object at ...&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="getadapters">
<h3>getAdapters<a class="headerlink" href="#getadapters" title="Lien permanent vers ce titre">¶</a></h3>
<p>Recherche pour des objets tous les adaptateurs fournissant une interface donnée.
Une liste d'adaptateurs est renvoyée. Si un adaptateur est nommé, seul
l'adaptateur le plus spécifique pour un nom donné est renvoyé.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>getAdapters(objects, provided, context=None)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FrontDeskNG</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDesk</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guest</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">guest</span> <span class="o">=</span> <span class="n">guest</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">next_id</span> <span class="o">=</span> <span class="n">get_next_id</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">bookings_db</span><span class="p">[</span><span class="n">next_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;place&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">place</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;phone&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">phone</span>
<span class="gp">... </span>        <span class="p">}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Guest</span><span class="p">(</span><span class="s">&quot;Jack&quot;</span><span class="p">,</span> <span class="s">&quot;Bangalore&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack_frontdesk</span> <span class="o">=</span> <span class="n">FrontDeskNG</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">FrontDeskNG</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;ng&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getAdapters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">getAdapters</span><span class="p">((</span><span class="n">jack</span><span class="p">,),</span> <span class="n">IDesk</span><span class="p">))</span> 
<span class="go">[(u&#39;ng&#39;, &lt;FrontDeskNG object at ...&gt;)]</span>
</pre></div>
</div>
</div>
<div class="section" id="getallutilitiesregisteredfor">
<h3>getAllUtilitiesRegisteredFor<a class="headerlink" href="#getallutilitiesregisteredfor" title="Lien permanent vers ce titre">¶</a></h3>
<p>Renvoie tous les utilitaires inscrits pour une interface. Ceci inclut les
utilitaires surchargés. La valeur renvoyée est un objet iterable listant les
instances d'utilitaires correspondants.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>getAllUtilitiesRegisteredFor(interface)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IGreeter</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="s">&quot;say hello&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Greeter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="s">&quot;Hello&quot;</span><span class="p">,</span> <span class="n">name</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">greet</span> <span class="o">=</span> <span class="n">Greeter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerUtility</span><span class="p">(</span><span class="n">greet</span><span class="p">,</span> <span class="n">IGreeter</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getAllUtilitiesRegisteredFor</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">getAllUtilitiesRegisteredFor</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">)</span> 
<span class="go">[&lt;Greeter object at ...&gt;]</span>
</pre></div>
</div>
</div>
<div class="section" id="getfactoriesfor">
<h3>getFactoriesFor<a class="headerlink" href="#getfactoriesfor" title="Lien permanent vers ce titre">¶</a></h3>
<p>Renvoie un tuple (nom, fabrique) de fabriques inscrites capables de créer des
objets qui fournissent une interface donnée.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>getFactoriesFor(interface, context=None)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDatabase</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">getConnection</span><span class="p">():</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Return connection object&quot;&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FakeDb</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDatabase</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">getConnection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;connection&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.factory</span> <span class="kn">import</span> <span class="n">Factory</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">factory</span> <span class="o">=</span> <span class="n">Factory</span><span class="p">(</span><span class="n">FakeDb</span><span class="p">,</span> <span class="s">&#39;FakeDb&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.interfaces</span> <span class="kn">import</span> <span class="n">IFactory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerUtility</span><span class="p">(</span><span class="n">factory</span><span class="p">,</span> <span class="n">IFactory</span><span class="p">,</span> <span class="s">&#39;fakedb&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getFactoriesFor</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">getFactoriesFor</span><span class="p">(</span><span class="n">IDatabase</span><span class="p">))</span>
<span class="go">[(u&#39;fakedb&#39;, &lt;Factory for &lt;class &#39;FakeDb&#39;&gt;&gt;)]</span>
</pre></div>
</div>
</div>
<div class="section" id="getfactoryinterfaces">
<h3>getFactoryInterfaces<a class="headerlink" href="#getfactoryinterfaces" title="Lien permanent vers ce titre">¶</a></h3>
<p>Récupère les interfaces implémentées par une fabrique. Cette fonction trouve la
fabrique possédant le nom donné la plus proche du contexte, puis renvoie
l'interface ou le tuple d'interfaces que les instances créées par la fabrique
vont fournir.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>getFactoryInterfaces(name, context=None)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDatabase</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">getConnection</span><span class="p">():</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Return connection object&quot;&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FakeDb</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDatabase</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">getConnection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;connection&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.factory</span> <span class="kn">import</span> <span class="n">Factory</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">factory</span> <span class="o">=</span> <span class="n">Factory</span><span class="p">(</span><span class="n">FakeDb</span><span class="p">,</span> <span class="s">&#39;FakeDb&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.interfaces</span> <span class="kn">import</span> <span class="n">IFactory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerUtility</span><span class="p">(</span><span class="n">factory</span><span class="p">,</span> <span class="n">IFactory</span><span class="p">,</span> <span class="s">&#39;fakedb&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getFactoryInterfaces</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">getFactoryInterfaces</span><span class="p">(</span><span class="s">&#39;fakedb&#39;</span><span class="p">)</span>
<span class="go">&lt;implementedBy __builtin__.FakeDb&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="getglobalsitemanager">
<h3>getGlobalSiteManager<a class="headerlink" href="#getglobalsitemanager" title="Lien permanent vers ce titre">¶</a></h3>
<p>Renvoie le gestionnaire global de site. Cette fonction ne doit jamais échouer
et doit toujours renvoyer un objet qui fournit <cite>IGlobalSiteManager</cite>.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>getGlobalSiteManager()</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">globalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="ow">is</span> <span class="n">globalSiteManager</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="getmultiadapter">
<h3>getMultiAdapter<a class="headerlink" href="#getmultiadapter" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette fonction recherche pour des objets un multi-adaptateur vers une interface
donnée. Elle renvoie un multi-adaptateur qui peut s'adapter aux objets donnés et
fournir l'interface voulue. Si aucun adaptateur ne peut être trouvé, une erreur
<cite>ComponentLookupError</cite> est émise. Le nom constitué de la chaîne vide est réservé
aux adaptateur sans nom. Les méthodes des adaptateurs sans nom appellent souvent
les méthodes des adaptateurs nommés en fournissant un nom vide ('').</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>getMultiAdapter(objects, interface=Interface, name='',
context=None)</cite></li>
<li>Voir aussi : <a class="reference internal" href="#querymultiadapter">queryMultiAdapter</a></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IAdapteeOne</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IAdapteeTwo</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IFunctionality</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyFunctionality</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IFunctionality</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IAdapteeOne</span><span class="p">,</span> <span class="n">IAdapteeTwo</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">one</span><span class="p">,</span> <span class="n">two</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">one</span> <span class="o">=</span> <span class="n">one</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">two</span> <span class="o">=</span> <span class="n">two</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">MyFunctionality</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">One</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IAdapteeOne</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Two</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IAdapteeTwo</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">one</span> <span class="o">=</span> <span class="n">One</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two</span> <span class="o">=</span> <span class="n">Two</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getMultiAdapter</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">getMultiAdapter</span><span class="p">((</span><span class="n">one</span><span class="p">,</span><span class="n">two</span><span class="p">),</span> <span class="n">IFunctionality</span><span class="p">)</span> 
<span class="go">&lt;MyFunctionality object at ...&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">myfunctionality</span> <span class="o">=</span> <span class="n">getMultiAdapter</span><span class="p">((</span><span class="n">one</span><span class="p">,</span><span class="n">two</span><span class="p">),</span> <span class="n">IFunctionality</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myfunctionality</span><span class="o">.</span><span class="n">one</span> 
<span class="go">&lt;One object at ...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myfunctionality</span><span class="o">.</span><span class="n">two</span> 
<span class="go">&lt;Two object at ...&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="getsitemanager">
<h3>getSiteManager<a class="headerlink" href="#getsitemanager" title="Lien permanent vers ce titre">¶</a></h3>
<p>Récupère le gestionnaire de site le plus proche du contexte donné. Si <cite>context</cite>
est <cite>None</cite>, cette fonction renvoie le gestionnaire global de site. Si le
<cite>context</cite> n'est pas <cite>None</cite>, on s'attend à ce qu'un adaptateur sur le contexte
vers <cite>IComponentLookup</cite> soit trouvé. Si aucun adaptateur n'est trouvé, une
erreur <cite>ComponentLookupError</cite> est émise.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>getSiteManager(context=None)</cite></li>
</ul>
</div></blockquote>
<p>Exemple 1</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.globalregistry</span> <span class="kn">import</span> <span class="n">BaseGlobalComponents</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">IComponentLookup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sm</span> <span class="o">=</span> <span class="n">BaseGlobalComponents</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Context</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sm</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">sm</span> <span class="o">=</span> <span class="n">sm</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__conform__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">interface</span><span class="o">.</span><span class="n">isOrExtends</span><span class="p">(</span><span class="n">IComponentLookup</span><span class="p">):</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sm</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">sm</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getSiteManager</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">lsm</span> <span class="o">=</span> <span class="n">getSiteManager</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lsm</span> <span class="ow">is</span> <span class="n">sm</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Exemple 2</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">sm</span> <span class="o">=</span> <span class="n">getSiteManager</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="ow">is</span> <span class="n">sm</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="getutilitiesfor">
<h3>getUtilitiesFor<a class="headerlink" href="#getutilitiesfor" title="Lien permanent vers ce titre">¶</a></h3>
<p>Récupère les utilitaires inscrits pour une interface particulière. Renvoie un
objet iterable listant les paires nom/utilitaire.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>getUtilitiesFor(interface)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IGreeter</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="s">&quot;say hello&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Greeter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="s">&quot;Hello&quot;</span><span class="p">,</span> <span class="n">name</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">greet</span> <span class="o">=</span> <span class="n">Greeter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerUtility</span><span class="p">(</span><span class="n">greet</span><span class="p">,</span> <span class="n">IGreeter</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getUtilitiesFor</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">getUtilitiesFor</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">))</span> 
<span class="go">[(u&#39;&#39;, &lt;Greeter object at ...&gt;)]</span>
</pre></div>
</div>
</div>
<div class="section" id="getutility">
<h3>getUtility<a class="headerlink" href="#getutility" title="Lien permanent vers ce titre">¶</a></h3>
<p>Récupère l'utilitaire qui fournit une interface donnée. Cette fonction renvoie
l'utilitaire le plus proche du contexte et qui fournit l'interface donnée. Si
aucun n'est trouvé, une erreur <tt class="docutils literal"><span class="pre">ComponentLookupError</span></tt> est levée.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>getUtility(interface, name='', context=None)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IGreeter</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="s">&quot;say hello&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Greeter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;Hello &quot;</span> <span class="o">+</span> <span class="n">name</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">greet</span> <span class="o">=</span> <span class="n">Greeter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerUtility</span><span class="p">(</span><span class="n">greet</span><span class="p">,</span> <span class="n">IGreeter</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getUtility</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">getUtility</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">)</span><span class="o">.</span><span class="n">greet</span><span class="p">(</span><span class="s">&#39;Jack&#39;</span><span class="p">)</span>
<span class="go">&#39;Hello Jack&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="handle">
<h3>handle<a class="headerlink" href="#handle" title="Lien permanent vers ce titre">¶</a></h3>
<p>Appelle tous les gestionnaires pour un objet donné. Les gestionnaires sont des
fabriques d'abonnés qui ne produisent rien. Ils font tout leur travail lors de
l'appel. Ils sont typiquement utilisés pour gérer des événements.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>handle(*objects)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">documentCreated</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">event</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDocumentCreated</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">doc</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;The document that was created&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">DocumentCreated</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDocumentCreated</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span>


<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">documentCreated</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">event</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapter</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nd">@adapter</span><span class="p">(</span><span class="n">IDocumentCreated</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">documentCreated</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">event</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>


<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerHandler</span><span class="p">(</span><span class="n">documentCreated</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">handle</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span><span class="p">(</span><span class="n">DocumentCreated</span><span class="p">(</span><span class="n">doc</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">created</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span>
<span class="go">&#39;datetime&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="implementedby">
<h3>implementedBy<a class="headerlink" href="#implementedby" title="Lien permanent vers ce titre">¶</a></h3>
<p>Renvoie les interfaces implémentées par une classe.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.interface</span></tt></li>
<li>Signature : <cite>implementedBy(class_)</cite></li>
</ul>
</div></blockquote>
<p>Exemple 1</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IGreeter</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="s">&quot;say hello&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Greeter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="s">&quot;Hello&quot;</span><span class="p">,</span> <span class="n">name</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implementedBy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">implementedBy</span><span class="p">(</span><span class="n">Greeter</span><span class="p">)</span>
<span class="go">&lt;implementedBy __builtin__.Greeter&gt;</span>
</pre></div>
</div>
<p>Exemple 2</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of person&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">ISpecial</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IPerson</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">classImplements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">classImplements</span><span class="p">(</span><span class="n">Person</span><span class="p">,</span> <span class="n">ISpecial</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implementedBy</span>

<span class="go">Pour récupérer une liste de toutes les interfaces implémentées par cette</span>
<span class="go">classe ::</span>

<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">__name__</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">implementedBy</span><span class="p">(</span><span class="n">Person</span><span class="p">)]</span>
<span class="go">[&#39;IPerson&#39;, &#39;ISpecial&#39;]</span>
</pre></div>
</div>
</div>
<div class="section" id="implementer">
<h3>implementer<a class="headerlink" href="#implementer" title="Lien permanent vers ce titre">¶</a></h3>
<p>Créer un décorateur permettant de déclarer des interfaces implémentées par une
fabrique. Un objet appelable est renvoyé, qui fait une déclaration
d'implémentation sur les objets qui lui sont transmis.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.interface</span></tt></li>
<li>Signature : <cite>implementer(*interfaces)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implementer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IFoo</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IFoo</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nd">@implementer</span><span class="p">(</span><span class="n">IFoo</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">foocreator</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">foo</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">foo</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">implementedBy</span><span class="p">(</span><span class="n">foocreator</span><span class="p">))</span>
<span class="go">[&lt;InterfaceClass __builtin__.IFoo&gt;]</span>
</pre></div>
</div>
</div>
<div class="section" id="implements">
<h3>implements<a class="headerlink" href="#implements" title="Lien permanent vers ce titre">¶</a></h3>
<p>Déclare que des interfaces seront fournies par une classe. Cette fonction est
appelée dans une définition de classe. Les arguments sont une ou plusieurs
interfaces. Les interfaces données sont ajoutées aux interfaces précédemment
déclarées. Les déclarations précédentes incluent les déclarations des classes
debase, à moins que <cite>implementsOnly</cite> ne soit utilisé.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.interface</span></tt></li>
<li>Signature : <cite>implements(*interfaces)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of person&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IPerson</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Person</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Jack&quot;</span>

<span class="go">You can test it like this:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">providedBy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IPerson</span> <span class="ow">in</span> <span class="n">providedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="implementsonly">
<h3>implementsOnly<a class="headerlink" href="#implementsonly" title="Lien permanent vers ce titre">¶</a></h3>
<p>Déclare les seules interfaces qui doivent être implémentées par une classe.
Cette fonction est appelée dans la définition de classe. Les arguments sont une
ou plusieurs interfaces. Les déclarations précédentes, y compris celles des
classes de base, sont remplacées.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.interface</span></tt></li>
<li>Signature : <cite>implementsOnly(*interfaces)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implementsOnly</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of person&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IStudent</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">college</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of college&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IPerson</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">NewPerson</span><span class="p">(</span><span class="n">Person</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implementsOnly</span><span class="p">(</span><span class="n">IStudent</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">college</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">NewPerson</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">college</span> <span class="o">=</span> <span class="s">&quot;New College&quot;</span>

<span class="go">You can test it like this:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">providedBy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IPerson</span> <span class="ow">in</span> <span class="n">providedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IStudent</span> <span class="ow">in</span> <span class="n">providedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="interface">
<h3>Interface<a class="headerlink" href="#interface" title="Lien permanent vers ce titre">¶</a></h3>
<p>Grâce à cette classe, vous pouvez définir une interface. Pour définir une
interface, contentez-vous d'hériter de cette classe.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.interface</span></tt></li>
<li>Signature : <cite>Interface(name, doc='')</cite></li>
</ul>
</div></blockquote>
<p>Exemple 1</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of person&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">email</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Email Address&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Exemple 2</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IHost</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">goodmorning</span><span class="p">(</span><span class="n">guest</span><span class="p">):</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Say good morning to guest&quot;&quot;&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="moduleprovides">
<h3>moduleProvides<a class="headerlink" href="#moduleprovides" title="Lien permanent vers ce titre">¶</a></h3>
<p>Déclare les interfaces fournies par un module. Cette fonction est utilisée dans
une définition de module. Les arguments sont une ou plusieurs interfaces. Les
interfaces fournies sont utilisées pour créer la spécification d'interface objet
du module. Une erreur est levée si le module a déjà une spécification
d'interface. Autrement dit, c'est une erreur d'appeler cette fonction plus d'une
fois dans une définition de module.</p>
<p>Cette fonction est fournie pour des raisons pratiques. Elle fournit une manière
plus pratique d'appeler <tt class="docutils literal"><span class="pre">directlyProvides</span></tt> pour un module.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.interface</span></tt></li>
<li>Signature : <cite>moduleProvides(*interfaces)</cite></li>
<li>Voir aussi : <a class="reference internal" href="#directlyprovides">directlyProvides</a></li>
</ul>
</div></blockquote>
<p>Vous pouvez consulter un exemple d'utilisation dans le code source de
<cite>zope.component</cite> lui-même. Le fichier <cite>__init__.py</cite> possède celle
instruction</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">moduleProvides</span><span class="p">(</span><span class="n">IComponentArchitecture</span><span class="p">,</span>
               <span class="n">IComponentRegistrationConvenience</span><span class="p">)</span>
</pre></div>
</div>
<p>Ainsi, le paquet <cite>zope.component</cite> fournit deux interfaces :
<cite>IComponentArchitecture</cite> et <cite>IComponentRegistrationConvenience</cite>.</p>
</div>
<div class="section" id="nolongerprovides">
<h3>noLongerProvides<a class="headerlink" href="#nolongerprovides" title="Lien permanent vers ce titre">¶</a></h3>
<p>Retire une interface de la liste des interfaces directement fournies par un
objet.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.interface</span></tt></li>
<li>Signature : <cite>noLongerProvides(object, interface)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">classImplements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of person&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IStudent</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">college</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of college&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IPerson</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Person</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Jack&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">college</span> <span class="o">=</span> <span class="s">&quot;New College&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">directlyProvides</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">IStudent</span><span class="p">)</span>

<span class="go">You can test it like this:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">providedBy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IPerson</span> <span class="ow">in</span> <span class="n">providedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IStudent</span> <span class="ow">in</span> <span class="n">providedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">noLongerProvides</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noLongerProvides</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">IStudent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IPerson</span> <span class="ow">in</span> <span class="n">providedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IStudent</span> <span class="ow">in</span> <span class="n">providedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</div>
<div class="section" id="provideadapter">
<h3>provideAdapter<a class="headerlink" href="#provideadapter" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il est recommandé d'utilier <a class="reference internal" href="#registeradapter">registerAdapter</a> .</p>
</div>
<div class="section" id="providehandler">
<h3>provideHandler<a class="headerlink" href="#providehandler" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il est recommandé d'utiliser <a class="reference internal" href="#registerhandler">registerHandler</a> .</p>
</div>
<div class="section" id="providesubscriptionadapter">
<h3>provideSubscriptionAdapter<a class="headerlink" href="#providesubscriptionadapter" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il est recommandé d'utiliser <a class="reference internal" href="#registersubscriptionadapter">registerSubscriptionAdapter</a> .</p>
</div>
<div class="section" id="provideutility">
<h3>provideUtility<a class="headerlink" href="#provideutility" title="Lien permanent vers ce titre">¶</a></h3>
<p>Il est recommandé d'utiliser <a class="reference internal" href="#registerutility">registerUtility</a> .</p>
</div>
<div class="section" id="providedby">
<h3>providedBy<a class="headerlink" href="#providedby" title="Lien permanent vers ce titre">¶</a></h3>
<p>Teste si l'interface est implémentée par l'objet. Renvoie True si l'objet
affirme qu'il implémente l'interface, y compris les interfaces étendues.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.interface</span></tt></li>
<li>Signature : <cite>providedBy(object)</cite></li>
</ul>
</div></blockquote>
<p>Exemple 1</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of person&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IPerson</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Person</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Jack&quot;</span>

<span class="go">You can test it like this:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">providedBy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">IPerson</span> <span class="ow">in</span> <span class="n">providedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Exemple 2</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IPerson</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Name of person&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">ISpecial</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IPerson</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">name</span> <span class="o">=</span> <span class="s">u&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">classImplements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">classImplements</span><span class="p">(</span><span class="n">Person</span><span class="p">,</span> <span class="n">ISpecial</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">providedBy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Person</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;Jack&quot;</span>

<span class="go">Pour obtenir une liste de toutes les interfaces fournies par cet objet ::</span>

<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">__name__</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">providedBy</span><span class="p">(</span><span class="n">jack</span><span class="p">)]</span>
<span class="go">[&#39;IPerson&#39;, &#39;ISpecial&#39;]</span>
</pre></div>
</div>
</div>
<div class="section" id="queryadapter">
<h3>queryAdapter<a class="headerlink" href="#queryadapter" title="Lien permanent vers ce titre">¶</a></h3>
<p>Recherche pour un objet un adaptateur nommé vers une interface. Renvoie un
adaptateur qui peut s'adapter à un objet et fournir une interface. Si aucun
adaptateur ne peut être trouvé, la valeur par défaut est renvoyée.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>queryAdapter(object, interface=Interface, name=u'',
default=None, context=None)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDesk</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;A frontdesk will register object&#39;s details&quot;&quot;&quot;</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Register object&#39;s details&quot;&quot;&quot;</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FrontDeskNG</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDesk</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guest</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">guest</span> <span class="o">=</span> <span class="n">guest</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">next_id</span> <span class="o">=</span> <span class="n">get_next_id</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">bookings_db</span><span class="p">[</span><span class="n">next_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;place&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">place</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;phone&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">phone</span>
<span class="gp">... </span>        <span class="p">}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Guest</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">place</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">place</span> <span class="o">=</span> <span class="n">place</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Guest</span><span class="p">(</span><span class="s">&quot;Jack&quot;</span><span class="p">,</span> <span class="s">&quot;Bangalore&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack_frontdesk</span> <span class="o">=</span> <span class="n">FrontDeskNG</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">IDesk</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">jack_frontdesk</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">FrontDeskNG</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="p">(</span><span class="n">IGuest</span><span class="p">,),</span> <span class="n">IDesk</span><span class="p">,</span> <span class="s">&#39;ng&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">queryAdapter</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">IDesk</span><span class="p">,</span> <span class="s">&#39;ng&#39;</span><span class="p">)</span> 
<span class="go">&lt;FrontDeskNG object at ...&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="queryadapterincontext">
<h3>queryAdapterInContext<a class="headerlink" href="#queryadapterincontext" title="Lien permanent vers ce titre">¶</a></h3>
<p>Recherche pour un objet un adaptateur spécial vers une interface.</p>
<p>NOTE : cette méthode ne doit être utilisée que si un contexte personnalisé doit
être fourni lors d'une recherche de composant personnalisée. Sinon, appelez
l'interface comme ci-dessous</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">interface</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
</pre></div>
</div>
<p>Renvoie un adaptateur qui peut s'adapter à l'objet et fournir l'interface. Si
aucun adaptateur n'est fourni, la valeur par défaut est renvoyée.</p>
<p>Le contexte est adapté à IServiceService, et ce service d'adaptateurs, fourni par
l'adaptateur, est utilisé.</p>
<p>Si l'objet possède une méthode __conform__, cette méthode est appelée avec
l'interface demandée. Si la méthode renvoie une valeur différente de None, cette
valeur est retournée. Sinon, si l'objet implémente déjà l'interface, cet objet
est renvoyé.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>queryAdapterInContext(object, interface, context,
default=None)</cite></li>
<li>Voir aussi : <a class="reference internal" href="#getadapterincontext">getAdapterInContext</a></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component.globalregistry</span> <span class="kn">import</span> <span class="n">BaseGlobalComponents</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">IComponentLookup</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sm</span> <span class="o">=</span> <span class="n">BaseGlobalComponents</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Context</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sm</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">sm</span> <span class="o">=</span> <span class="n">sm</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__conform__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">interface</span><span class="o">.</span><span class="n">isOrExtends</span><span class="p">(</span><span class="n">IComponentLookup</span><span class="p">):</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sm</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">sm</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDesk</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;A frontdesk will register object&#39;s details&quot;&quot;&quot;</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Register object&#39;s details&quot;&quot;&quot;</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FrontDeskNG</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDesk</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guest</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">guest</span> <span class="o">=</span> <span class="n">guest</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">next_id</span> <span class="o">=</span> <span class="n">get_next_id</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">bookings_db</span><span class="p">[</span><span class="n">next_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;place&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">place</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;phone&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">phone</span>
<span class="gp">... </span>        <span class="p">}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Guest</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">place</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">place</span> <span class="o">=</span> <span class="n">place</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Guest</span><span class="p">(</span><span class="s">&quot;Jack&quot;</span><span class="p">,</span> <span class="s">&quot;Bangalore&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack_frontdesk</span> <span class="o">=</span> <span class="n">FrontDeskNG</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">IDesk</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">jack_frontdesk</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">FrontDeskNG</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="p">(</span><span class="n">IGuest</span><span class="p">,),</span> <span class="n">IDesk</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">queryAdapterInContext</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">queryAdapterInContext</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">IDesk</span><span class="p">,</span> <span class="n">sm</span><span class="p">)</span> 
<span class="go">&lt;FrontDeskNG object at ...&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="querymultiadapter">
<h3>queryMultiAdapter<a class="headerlink" href="#querymultiadapter" title="Lien permanent vers ce titre">¶</a></h3>
<p>Recherche pour des objets un multi-adaptateur vers une interface. Cette fonction
renvoie un multi-adaptateur qui peut adapter les objets à l'interface. Si aucun
adaptateur ne peut être trouvé, la valeur par défaut est renvoyée. Le nom
correspondant à la chaîne vide est réservé aux adaptateurs sans nom. Les
methodes des adaptateurs sans nom appellent souvent les méthodes des adaptateurs
nommés avec un nom vide ('').</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>queryMultiAdapter(objects, interface=Interface,
name=u'', default=None, context=None)</cite></li>
<li>Voir aussi : <a class="reference internal" href="#getmultiadapter">getMultiAdapter</a></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IAdapteeOne</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IAdapteeTwo</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IFunctionality</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyFunctionality</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IFunctionality</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IAdapteeOne</span><span class="p">,</span> <span class="n">IAdapteeTwo</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">one</span><span class="p">,</span> <span class="n">two</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">one</span> <span class="o">=</span> <span class="n">one</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">two</span> <span class="o">=</span> <span class="n">two</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">MyFunctionality</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">One</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IAdapteeOne</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Two</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IAdapteeTwo</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">one</span> <span class="o">=</span> <span class="n">One</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">two</span> <span class="o">=</span> <span class="n">Two</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">queryMultiAdapter</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">getMultiAdapter</span><span class="p">((</span><span class="n">one</span><span class="p">,</span><span class="n">two</span><span class="p">),</span> <span class="n">IFunctionality</span><span class="p">)</span> 
<span class="go">&lt;MyFunctionality object at ...&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">myfunctionality</span> <span class="o">=</span> <span class="n">queryMultiAdapter</span><span class="p">((</span><span class="n">one</span><span class="p">,</span><span class="n">two</span><span class="p">),</span> <span class="n">IFunctionality</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myfunctionality</span><span class="o">.</span><span class="n">one</span> 
<span class="go">&lt;One object at ...&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">myfunctionality</span><span class="o">.</span><span class="n">two</span> 
<span class="go">&lt;Two object at ...&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="queryutility">
<h3>queryUtility<a class="headerlink" href="#queryutility" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette fonction est utilisée pour rechercher un utilitaire qui fournit une
interface. Si aucun n'est trouvé, la valeur par défaut est renvoyée.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span></tt></li>
<li>Signature : <cite>queryUtility(interface, name='', default=None)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IGreeter</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="s">&quot;say hello&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Greeter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;Hello &quot;</span> <span class="o">+</span> <span class="n">name</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">greet</span> <span class="o">=</span> <span class="n">Greeter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerUtility</span><span class="p">(</span><span class="n">greet</span><span class="p">,</span> <span class="n">IGreeter</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">queryUtility</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">queryUtility</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">)</span><span class="o">.</span><span class="n">greet</span><span class="p">(</span><span class="s">&#39;Jack&#39;</span><span class="p">)</span>
<span class="go">&#39;Hello Jack&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="registeradapter">
<h3>registerAdapter<a class="headerlink" href="#registeradapter" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette fonction est utilisée pour inscrire une fabrique d'adaptateur.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span> <span class="pre">-</span> <span class="pre">IComponentRegistry</span></tt></li>
<li>Signature : <cite>registerAdapter(factory, required=None, provided=None,
name=u'', info=u'')</cite></li>
<li>Voir aussi : <a class="reference internal" href="#unregisteradapter">unregisterAdapter</a></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDesk</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;A frontdesk will register object&#39;s details&quot;&quot;&quot;</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Register object&#39;s details&quot;&quot;&quot;</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FrontDeskNG</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDesk</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guest</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">guest</span> <span class="o">=</span> <span class="n">guest</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">next_id</span> <span class="o">=</span> <span class="n">get_next_id</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">bookings_db</span><span class="p">[</span><span class="n">next_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;place&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">place</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;phone&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">phone</span>
<span class="gp">... </span>        <span class="p">}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Guest</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">place</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">place</span> <span class="o">=</span> <span class="n">place</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Guest</span><span class="p">(</span><span class="s">&quot;Jack&quot;</span><span class="p">,</span> <span class="s">&quot;Bangalore&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack_frontdesk</span> <span class="o">=</span> <span class="n">FrontDeskNG</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">IDesk</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">jack_frontdesk</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">FrontDeskNG</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="p">(</span><span class="n">IGuest</span><span class="p">,),</span> <span class="n">IDesk</span><span class="p">,</span> <span class="s">&#39;ng&#39;</span><span class="p">)</span>

<span class="go">Vous pouvez tester de cette façon :</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">queryAdapter</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">IDesk</span><span class="p">,</span> <span class="s">&#39;ng&#39;</span><span class="p">)</span> 
<span class="go">&lt;FrontDeskNG object at ...&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="registeredadapters">
<h3>registeredAdapters<a class="headerlink" href="#registeredadapters" title="Lien permanent vers ce titre">¶</a></h3>
<p>Renvoie un objet iterable listant les <cite>IAdapterRegistrations</cite>. Ces inscriptions
décrivent les inscriptions d'adaptateurs actuelles valables.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span> <span class="pre">-</span> <span class="pre">IComponentRegistry</span></tt></li>
<li>Signature : <cite>registeredAdapters()</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDesk</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;A frontdesk will register object&#39;s details&quot;&quot;&quot;</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Register object&#39;s details&quot;&quot;&quot;</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FrontDeskNG</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDesk</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guest</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">guest</span> <span class="o">=</span> <span class="n">guest</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">next_id</span> <span class="o">=</span> <span class="n">get_next_id</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">bookings_db</span><span class="p">[</span><span class="n">next_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;place&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">place</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;phone&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">phone</span>
<span class="gp">... </span>        <span class="p">}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Guest</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">place</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">place</span> <span class="o">=</span> <span class="n">place</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Guest</span><span class="p">(</span><span class="s">&quot;Jack&quot;</span><span class="p">,</span> <span class="s">&quot;Bangalore&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack_frontdesk</span> <span class="o">=</span> <span class="n">FrontDeskNG</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">IDesk</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">jack_frontdesk</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">FrontDeskNG</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="p">(</span><span class="n">IGuest</span><span class="p">,),</span> <span class="n">IDesk</span><span class="p">,</span> <span class="s">&#39;ng2&#39;</span><span class="p">)</span>


<span class="gp">&gt;&gt;&gt; </span><span class="n">reg_adapter</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">gsm</span><span class="o">.</span><span class="n">registeredAdapters</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;ng2&#39;</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">reg_adapter</span><span class="p">]</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="registeredhandlers">
<h3>registeredHandlers<a class="headerlink" href="#registeredhandlers" title="Lien permanent vers ce titre">¶</a></h3>
<p>Renvoie un objet iterable listant les <cite>IHandlerRegistrations</cite>. Ces inscriptions
décrivent les inscriptions de gestionnaires actuelles.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span> <span class="pre">-</span> <span class="pre">IComponentRegistry</span></tt></li>
<li>Signature : <cite>registeredHandlers()</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">documentCreated</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">event</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDocumentCreated</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">doc</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;The document that was created&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">DocumentCreated</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDocumentCreated</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span>


<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">documentCreated</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">event</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapter</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nd">@adapter</span><span class="p">(</span><span class="n">IDocumentCreated</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">documentCreated</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">event</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>


<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerHandler</span><span class="p">(</span><span class="n">documentCreated</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&#39;ng3&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">reg_adapter</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">gsm</span><span class="o">.</span><span class="n">registeredHandlers</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;ng3&#39;</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">info</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">reg_adapter</span><span class="p">]</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerHandler</span><span class="p">(</span><span class="n">documentCreated</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;ng4&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Named handlers are not yet supported</span>
</pre></div>
</div>
</div>
<div class="section" id="registeredsubscriptionadapters">
<h3>registeredSubscriptionAdapters<a class="headerlink" href="#registeredsubscriptionadapters" title="Lien permanent vers ce titre">¶</a></h3>
<p>Renvoie un objet iterable listant les <cite>ISubscriptionAdapterRegistrations</cite>. Ces
inscriptions décrivent les inscriptions d'adaptateurs d'abonnement actuelles.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span> <span class="pre">-</span> <span class="pre">IComponentRegistry</span></tt></li>
<li>Signature : <cite>registeredSubscriptionAdapters()</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IValidate</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="n">ob</span><span class="p">):</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Determine whether the object is valid</span>
<span class="gp">...</span><span class="sd"></span>
<span class="gp">... </span><span class="sd">        Return a string describing a validation problem.</span>
<span class="gp">... </span><span class="sd">        An empty string is returned to indicate that the</span>
<span class="gp">... </span><span class="sd">        object is valid.</span>
<span class="gp">... </span><span class="sd">        &quot;&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDocument</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">summary</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Document summary&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">body</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Document text&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Document</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDocument</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">summary</span><span class="p">,</span> <span class="n">body</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">AdequateLength</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IDocument</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IValidate</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="s">&#39;too short&#39;</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="s">&#39;&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerSubscriptionAdapter</span><span class="p">(</span><span class="n">AdequateLength</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&#39;ng4&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">reg_adapter</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">gsm</span><span class="o">.</span><span class="n">registeredSubscriptionAdapters</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;ng4&#39;</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">info</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">reg_adapter</span><span class="p">]</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="registeredutilities">
<h3>registeredUtilities<a class="headerlink" href="#registeredutilities" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette fonction renvoie un objet iterable listant les <cite>IUtilityRegistrations</cite>.
Ces inscriptions décrivent les inscriptions d'utilitaires actuelles.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span> <span class="pre">-</span> <span class="pre">IComponentRegistry</span></tt></li>
<li>Signature : <cite>registeredUtilities()</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IGreeter</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="s">&quot;say hello&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Greeter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="s">&quot;Hello&quot;</span><span class="p">,</span> <span class="n">name</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">greet</span> <span class="o">=</span> <span class="n">Greeter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerUtility</span><span class="p">(</span><span class="n">greet</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="s">&#39;ng5&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">reg_adapter</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">gsm</span><span class="o">.</span><span class="n">registeredUtilities</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&#39;ng5&#39;</span> <span class="ow">in</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">info</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">reg_adapter</span><span class="p">]</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="registerhandler">
<h3>registerHandler<a class="headerlink" href="#registerhandler" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette fonction est utilisée pour inscrire un gestionnaire. Un gestionnaire est
un abonné qui ne crée pas d'adaptateur, mais effectue un traitement lorsqu'il
est appelé.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span> <span class="pre">-</span> <span class="pre">IComponentRegistry</span></tt></li>
<li>Signature : <cite>registerHandler(handler, required=None, name=u'', info='')</cite></li>
<li>Voir aussi : <a class="reference internal" href="#unregisterhandler">unregisterHandler</a></li>
</ul>
</div></blockquote>
<p>Note : l'implémentation actuelle de <tt class="docutils literal"><span class="pre">zope.component</span></tt> ne prend pas en charge
l'attribut <cite>name</cite>.</p>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">documentCreated</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">event</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDocumentCreated</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">doc</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;The document that was created&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">DocumentCreated</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDocumentCreated</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span>


<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">documentCreated</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">event</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapter</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nd">@adapter</span><span class="p">(</span><span class="n">IDocumentCreated</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">documentCreated</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">event</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span>


<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerHandler</span><span class="p">(</span><span class="n">documentCreated</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">handle</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span><span class="p">(</span><span class="n">DocumentCreated</span><span class="p">(</span><span class="n">doc</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">created</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span>
<span class="go">&#39;datetime&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="registersubscriptionadapter">
<h3>registerSubscriptionAdapter<a class="headerlink" href="#registersubscriptionadapter" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette fonction est utilisée pour inscrire une fabrique d'abonnés.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span> <span class="pre">-</span> <span class="pre">IComponentRegistry</span></tt></li>
<li>Signature : <cite>registerSubscriptionAdapter(factory, required=None,
provides=None, name=u'', info='')</cite></li>
<li>Voir aussi : <a class="reference internal" href="#unregistersubscriptionadapter">unregisterSubscriptionAdapter</a></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IValidate</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="n">ob</span><span class="p">):</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Determine whether the object is valid</span>
<span class="gp">...</span><span class="sd"></span>
<span class="gp">... </span><span class="sd">        Return a string describing a validation problem.</span>
<span class="gp">... </span><span class="sd">        An empty string is returned to indicate that the</span>
<span class="gp">... </span><span class="sd">        object is valid.</span>
<span class="gp">... </span><span class="sd">        &quot;&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDocument</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">summary</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Document summary&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">body</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Document text&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Document</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDocument</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">summary</span><span class="p">,</span> <span class="n">body</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">AdequateLength</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IDocument</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IValidate</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="s">&#39;too short&#39;</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="s">&#39;&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerSubscriptionAdapter</span><span class="p">(</span><span class="n">AdequateLength</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="registerutility">
<h3>registerUtility<a class="headerlink" href="#registerutility" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette fonction est utilisée pour inscrire un utilitaire.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span> <span class="pre">-</span> <span class="pre">IComponentRegistry</span></tt></li>
<li>Signature : <cite>registerUtility(component, provided=None, name=u'',
info=u'')</cite></li>
<li>Voir aussi : <a class="reference internal" href="#unregisterutility">unregisterUtility</a></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IGreeter</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="s">&quot;say hello&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Greeter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">print</span> <span class="s">&quot;Hello&quot;</span><span class="p">,</span> <span class="n">name</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">greet</span> <span class="o">=</span> <span class="n">Greeter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerUtility</span><span class="p">(</span><span class="n">greet</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="subscribers">
<h3>subscribers<a class="headerlink" href="#subscribers" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette fonction est utilisée pour récupérer les abonnés. Les abonnés qui
fournissent l'interface souhaités et qui dépendent de la séquence d'objets
fournie sont renvoyés.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span> <span class="pre">-</span> <span class="pre">IComponentRegistry</span></tt></li>
<li>Signature : <cite>subscribers(required, provided, context=None)</cite></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IValidate</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="n">ob</span><span class="p">):</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Determine whether the object is valid</span>
<span class="gp">...</span><span class="sd"></span>
<span class="gp">... </span><span class="sd">        Return a string describing a validation problem.</span>
<span class="gp">... </span><span class="sd">        An empty string is returned to indicate that the</span>
<span class="gp">... </span><span class="sd">        object is valid.</span>
<span class="gp">... </span><span class="sd">        &quot;&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDocument</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">summary</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Document summary&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">body</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Document text&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Document</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDocument</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">summary</span><span class="p">,</span> <span class="n">body</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">SingleLineSummary</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IDocument</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IValidate</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">summary</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="s">&#39;Summary should only have one line&#39;</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="s">&#39;&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">AdequateLength</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IDocument</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IValidate</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="s">&#39;too short&#39;</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="s">&#39;&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerSubscriptionAdapter</span><span class="p">(</span><span class="n">SingleLineSummary</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerSubscriptionAdapter</span><span class="p">(</span><span class="n">AdequateLength</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">subscribers</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="s">&quot;A</span><span class="se">\n</span><span class="s">Document&quot;</span><span class="p">,</span> <span class="s">&quot;blah&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">adapter</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<span class="gp">... </span> <span class="k">for</span> <span class="n">adapter</span> <span class="ow">in</span> <span class="n">subscribers</span><span class="p">([</span><span class="n">doc</span><span class="p">],</span> <span class="n">IValidate</span><span class="p">)</span>
<span class="gp">... </span> <span class="k">if</span> <span class="n">adapter</span><span class="o">.</span><span class="n">validate</span><span class="p">()]</span>
<span class="go">[&#39;Summary should only have one line&#39;, &#39;too short&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="s">&quot;A</span><span class="se">\n</span><span class="s">Document&quot;</span><span class="p">,</span> <span class="s">&quot;blah&quot;</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">adapter</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<span class="gp">... </span> <span class="k">for</span> <span class="n">adapter</span> <span class="ow">in</span> <span class="n">subscribers</span><span class="p">([</span><span class="n">doc</span><span class="p">],</span> <span class="n">IValidate</span><span class="p">)</span>
<span class="gp">... </span> <span class="k">if</span> <span class="n">adapter</span><span class="o">.</span><span class="n">validate</span><span class="p">()]</span>
<span class="go">[&#39;Summary should only have one line&#39;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="s">&quot;A Document&quot;</span><span class="p">,</span> <span class="s">&quot;blah&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">adapter</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<span class="gp">... </span> <span class="k">for</span> <span class="n">adapter</span> <span class="ow">in</span> <span class="n">subscribers</span><span class="p">([</span><span class="n">doc</span><span class="p">],</span> <span class="n">IValidate</span><span class="p">)</span>
<span class="gp">... </span> <span class="k">if</span> <span class="n">adapter</span><span class="o">.</span><span class="n">validate</span><span class="p">()]</span>
<span class="go">[&#39;too short&#39;]</span>
</pre></div>
</div>
</div>
<div class="section" id="unregisteradapter">
<h3>unregisterAdapter<a class="headerlink" href="#unregisteradapter" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette fonction est utilisée pour désinscrire une fabrique d'adaptateur. Un
booléen est renvoyé, indiquant si le registre a été modifié. Si le composant
donné est None et qu'il n'y a aucun composant inscrit, ou si le composant donné
n'est pas None mais n'est pas inscrit, alors la fonction renvoie False. Sinon True.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span> <span class="pre">-</span> <span class="pre">IComponentRegistry</span></tt></li>
<li>Signature : <cite>unregisterAdapter(factory=None, required=None,
provided=None, name=u'')</cite></li>
<li>Voir aussi : <a class="reference internal" href="#registeradapter">registerAdapter</a></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDesk</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;A frontdesk will register object&#39;s details&quot;&quot;&quot;</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">():</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Register object&#39;s details&quot;&quot;&quot;</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">FrontDeskNG</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDesk</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">guest</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">guest</span> <span class="o">=</span> <span class="n">guest</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">next_id</span> <span class="o">=</span> <span class="n">get_next_id</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">bookings_db</span><span class="p">[</span><span class="n">next_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;place&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">place</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s">&#39;phone&#39;</span><span class="p">:</span> <span class="n">guest</span><span class="o">.</span><span class="n">phone</span>
<span class="gp">... </span>        <span class="p">}</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Guest</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IGuest</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">place</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">place</span> <span class="o">=</span> <span class="n">place</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">jack</span> <span class="o">=</span> <span class="n">Guest</span><span class="p">(</span><span class="s">&quot;Jack&quot;</span><span class="p">,</span> <span class="s">&quot;Bangalore&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jack_frontdesk</span> <span class="o">=</span> <span class="n">FrontDeskNG</span><span class="p">(</span><span class="n">jack</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">IDesk</span><span class="o">.</span><span class="n">providedBy</span><span class="p">(</span><span class="n">jack_frontdesk</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerAdapter</span><span class="p">(</span><span class="n">FrontDeskNG</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="p">(</span><span class="n">IGuest</span><span class="p">,),</span> <span class="n">IDesk</span><span class="p">,</span> <span class="s">&#39;ng6&#39;</span><span class="p">)</span>

<span class="go">Vous pouvez tester de cette façon :</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">queryAdapter</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">IDesk</span><span class="p">,</span> <span class="s">&#39;ng6&#39;</span><span class="p">)</span> 
<span class="go">&lt;FrontDeskNG object at ...&gt;</span>

<span class="go">Maintenant on peut faire la désinscriptin :</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">unregisterAdapter</span><span class="p">(</span><span class="n">FrontDeskNG</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;ng6&#39;</span><span class="p">)</span>
<span class="go">True</span>

<span class="go">Après la désinscription :</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">queryAdapter</span><span class="p">(</span><span class="n">jack</span><span class="p">,</span> <span class="n">IDesk</span><span class="p">,</span> <span class="s">&#39;ng6&#39;</span><span class="p">)</span>
<span class="go">None</span>
</pre></div>
</div>
</div>
<div class="section" id="unregisterhandler">
<h3>unregisterHandler<a class="headerlink" href="#unregisterhandler" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette fonction est utilisée pour désinscrire un gestionnaire. Un gestionnaire
est un abonné qui ne crée pas d'adaptateur, mais effectue un traitement lors de
son appel. Un booléen et renvoyé, indiquant si le registre a été modifié.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span> <span class="pre">-</span> <span class="pre">IComponentRegistry</span></tt></li>
<li>Signature : <cite>unregisterHandler(handler=None, required=None,
name=u'')</cite></li>
<li>Voir aussi : <a class="reference internal" href="#registerhandler">registerHandler</a></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDocument</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">summary</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Document summary&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">body</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Document text&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Document</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDocument</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">summary</span><span class="p">,</span> <span class="n">body</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="s">&quot;A</span><span class="se">\n</span><span class="s">Document&quot;</span><span class="p">,</span> <span class="s">&quot;blah&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDocumentAccessed</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">doc</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;The document that was accessed&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">DocumentAccessed</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDocumentAccessed</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapter</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nd">@adapter</span><span class="p">(</span><span class="n">IDocumentAccessed</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">documentAccessed</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">event</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerHandler</span><span class="p">(</span><span class="n">documentAccessed</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">handle</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span><span class="p">(</span><span class="n">DocumentAccessed</span><span class="p">(</span><span class="n">doc</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">count</span>
<span class="go">1</span>

<span class="go">Now unregister:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">unregisterHandler</span><span class="p">(</span><span class="n">documentAccessed</span><span class="p">)</span>
<span class="go">True</span>

<span class="go">After unregistration:</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">handle</span><span class="p">(</span><span class="n">DocumentAccessed</span><span class="p">(</span><span class="n">doc</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span><span class="o">.</span><span class="n">count</span>
<span class="go">0</span>
</pre></div>
</div>
</div>
<div class="section" id="unregistersubscriptionadapter">
<h3>unregisterSubscriptionAdapter<a class="headerlink" href="#unregistersubscriptionadapter" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette fonction est utilisée pour désinscrire une fabrique d'abonné. Un
booléen est renvoyé, indiquant si le registre a été modifié. Si le composant
donné est None et qu'il n'y a aucun composant inscrit, ou si le composant donné
n'est pas None mais n'est pas inscrit, alors la fonction renvoie False. Sinon True.</p>
<blockquote>
<div><ul class="simple">
<li>Emplacement : <tt class="docutils literal"><span class="pre">zope.component</span> <span class="pre">-</span> <span class="pre">IComponentRegistry</span></tt></li>
<li>Signature : <cite>unregisterSubscriptionAdapter(factory=None,
required=None, provides=None, name=u'')</cite></li>
<li>Voir aussi : <a class="reference internal" href="#registersubscriptionadapter">registerSubscriptionAdapter</a></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Attribute</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IValidate</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="n">ob</span><span class="p">):</span>
<span class="gp">... </span>        <span class="sd">&quot;&quot;&quot;Determine whether the object is valid</span>
<span class="gp">...</span><span class="sd"></span>
<span class="gp">... </span><span class="sd">        Return a string describing a validation problem.</span>
<span class="gp">... </span><span class="sd">        An empty string is returned to indicate that the</span>
<span class="gp">... </span><span class="sd">        object is valid.</span>
<span class="gp">... </span><span class="sd">        &quot;&quot;&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IDocument</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">summary</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Document summary&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">body</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">(</span><span class="s">&quot;Document text&quot;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Document</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IDocument</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">summary</span><span class="p">,</span> <span class="n">body</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">summary</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">summary</span><span class="p">,</span> <span class="n">body</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">adapts</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">AdequateLength</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">adapts</span><span class="p">(</span><span class="n">IDocument</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IValidate</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">doc</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">doc</span> <span class="o">=</span> <span class="n">doc</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">body</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="s">&#39;too short&#39;</span>
<span class="gp">... </span>        <span class="k">else</span><span class="p">:</span>
<span class="gp">... </span>            <span class="k">return</span> <span class="s">&#39;&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerSubscriptionAdapter</span><span class="p">(</span><span class="n">AdequateLength</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">subscribers</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">doc</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="s">&quot;A</span><span class="se">\n</span><span class="s">Document&quot;</span><span class="p">,</span> <span class="s">&quot;blah&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">adapter</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<span class="gp">... </span> <span class="k">for</span> <span class="n">adapter</span> <span class="ow">in</span> <span class="n">subscribers</span><span class="p">([</span><span class="n">doc</span><span class="p">],</span> <span class="n">IValidate</span><span class="p">)</span>
<span class="gp">... </span> <span class="k">if</span> <span class="n">adapter</span><span class="o">.</span><span class="n">validate</span><span class="p">()]</span>
<span class="go">[&#39;too short&#39;]</span>

<span class="go">Mainenant on peut effectuer la désinscription :</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">unregisterSubscriptionAdapter</span><span class="p">(</span><span class="n">AdequateLength</span><span class="p">)</span>
<span class="go">True</span>

<span class="go">Après la désinscription :</span>

<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">adapter</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<span class="gp">... </span> <span class="k">for</span> <span class="n">adapter</span> <span class="ow">in</span> <span class="n">subscribers</span><span class="p">([</span><span class="n">doc</span><span class="p">],</span> <span class="n">IValidate</span><span class="p">)</span>
<span class="gp">... </span> <span class="k">if</span> <span class="n">adapter</span><span class="o">.</span><span class="n">validate</span><span class="p">()]</span>
<span class="go">[]</span>
</pre></div>
</div>
</div>
<div class="section" id="unregisterutility">
<h3>unregisterUtility<a class="headerlink" href="#unregisterutility" title="Lien permanent vers ce titre">¶</a></h3>
<p>Cette fonction est utilisée pour désinscrire un utilitaire. Un
booléen est renvoyé, indiquant si le registre a été modifié. Si le composant
donné est None et qu'il n'y a aucun composant inscrit, ou si le composant donné
n'est pas None mais n'est pas inscrit, alors la fonction renvoie False. Sinon True.</p>
<blockquote>
<div><ul class="simple">
<li>Location: <tt class="docutils literal"><span class="pre">zope.component</span> <span class="pre">-</span> <span class="pre">IComponentRegistry</span></tt></li>
<li>Signature: <cite>unregisterUtility(component=None, provided=None,
name=u'')</cite></li>
<li>See also: <a class="reference internal" href="#registerutility">registerUtility</a></li>
</ul>
</div></blockquote>
<p>Exemple</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">Interface</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.interface</span> <span class="kn">import</span> <span class="n">implements</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">IGreeter</span><span class="p">(</span><span class="n">Interface</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="s">&quot;say hello&quot;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Greeter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="n">implements</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">greet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="s">&quot;Hello &quot;</span> <span class="o">+</span> <span class="n">name</span>

<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">zope.component</span> <span class="kn">import</span> <span class="n">getGlobalSiteManager</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span> <span class="o">=</span> <span class="n">getGlobalSiteManager</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">greet</span> <span class="o">=</span> <span class="n">Greeter</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">registerUtility</span><span class="p">(</span><span class="n">greet</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">queryUtility</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">)</span><span class="o">.</span><span class="n">greet</span><span class="p">(</span><span class="s">&#39;Jack&#39;</span><span class="p">)</span>
<span class="go">&#39;Hello Jack&#39;</span>

<span class="go">Maintenant on peut effectuer la désinscription :</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">gsm</span><span class="o">.</span><span class="n">unregisterUtility</span><span class="p">(</span><span class="n">greet</span><span class="p">)</span>
<span class="go">True</span>

<span class="go">Après la désinscription :</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">queryUtility</span><span class="p">(</span><span class="n">IGreeter</span><span class="p">)</span>
<span class="go">None</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table des matières</a></h3>
  <ul>
<li><a class="reference internal" href="#">Le guide complet de l'Architecture de Composants de Zope</a><ul>
<li><a class="reference internal" href="#mise-en-route">Mise en route</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#petit-historique">Petit historique</a></li>
<li><a class="reference internal" href="#installation">Installation</a></li>
<li><a class="reference internal" href="#methode-pour-experimenter">Méthode pour expérimenter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#un-exemple">Un exemple</a><ul>
<li><a class="reference internal" href="#id11">Introduction</a></li>
<li><a class="reference internal" href="#approche-procedurale">Approche procédurale</a></li>
<li><a class="reference internal" href="#approche-orientee-objet">Approche orientée objet</a></li>
<li><a class="reference internal" href="#le-motif-adaptateur">Le motif <cite>adaptateur</cite></a></li>
</ul>
</li>
<li><a class="reference internal" href="#interfaces">Interfaces</a><ul>
<li><a class="reference internal" href="#id13">Introduction</a></li>
<li><a class="reference internal" href="#declarer-des-interfaces">Déclarer des interfaces</a></li>
<li><a class="reference internal" href="#implementation-des-interfaces">Implémentation des interfaces</a></li>
<li><a class="reference internal" href="#l-exemple-revisite">L'exemple revisité</a></li>
<li><a class="reference internal" href="#interfaces-marqueurs">Interfaces marqueurs</a></li>
<li><a class="reference internal" href="#invariants">Invariants</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adaptateurs">Adaptateurs</a><ul>
<li><a class="reference internal" href="#implementation">Implémentation</a></li>
<li><a class="reference internal" href="#inscription">Inscription</a></li>
<li><a class="reference internal" href="#recuperation-d-un-adaptateur">récupération d'un adaptateur</a></li>
<li><a class="reference internal" href="#recuperer-un-adaptateur-en-utilisant-l-interface">Récupérer un adaptateur en utilisant l'interface</a></li>
<li><a class="reference internal" href="#motif-adaptateur">Motif adaptateur</a></li>
</ul>
</li>
<li><a class="reference internal" href="#utilitaires">Utilitaires</a><ul>
<li><a class="reference internal" href="#id18">Introduction</a></li>
<li><a class="reference internal" href="#utilitaire-simple">Utilitaire simple</a></li>
<li><a class="reference internal" href="#utilitaire-nomme">Utilitaire nommé</a></li>
<li><a class="reference internal" href="#fabrique">Fabrique</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adaptateurs-avances">Adaptateurs avancés</a><ul>
<li><a class="reference internal" href="#multi-adaptateur">Multi-adaptateur</a></li>
<li><a class="reference internal" href="#adaptateur-d-abonnement">Adaptateur d'abonnement</a></li>
<li><a class="reference internal" href="#gestionnaire">Gestionnaire</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage-de-la-zca-dans-zope">Usage de la ZCA dans Zope</a><ul>
<li><a class="reference internal" href="#zcml">ZCML</a></li>
<li><a class="reference internal" href="#surchargements">Surchargements</a></li>
<li><a class="reference internal" href="#namechooser">NameChooser</a></li>
<li><a class="reference internal" href="#locationphysicallylocatable">LocationPhysicallyLocatable</a></li>
<li><a class="reference internal" href="#defaultsized">DefaultSized</a></li>
<li><a class="reference internal" href="#zopeversionutility">ZopeVersionUtility</a></li>
</ul>
</li>
<li><a class="reference internal" href="#etude-de-cas">Étude de cas</a><ul>
<li><a class="reference internal" href="#id19">Introduction</a></li>
<li><a class="reference internal" href="#cas-d-utilisation">Cas d'utilisation</a></li>
<li><a class="reference internal" href="#survol-du-code-pygtk">Survol du code PyGTK</a></li>
<li><a class="reference internal" href="#le-code">Le code</a></li>
<li><a class="reference internal" href="#pysqlite">PySQLite</a></li>
<li><a class="reference internal" href="#zodb">ZODB</a></li>
<li><a class="reference internal" href="#conclusions">Conclusions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reference">Reference</a><ul>
<li><a class="reference internal" href="#adaptedby">adaptedBy</a></li>
<li><a class="reference internal" href="#adapter">adapter</a></li>
<li><a class="reference internal" href="#adapts">adapts</a></li>
<li><a class="reference internal" href="#alsoprovides">alsoProvides</a></li>
<li><a class="reference internal" href="#attribute">Attribute</a></li>
<li><a class="reference internal" href="#classimplements">classImplements</a></li>
<li><a class="reference internal" href="#classimplementsonly">classImplementsOnly</a></li>
<li><a class="reference internal" href="#classprovides">classProvides</a></li>
<li><a class="reference internal" href="#componentlookuperror">ComponentLookupError</a></li>
<li><a class="reference internal" href="#createobject">createObject</a></li>
<li><a class="reference internal" href="#declaration">Declaration</a></li>
<li><a class="reference internal" href="#directlyprovidedby">directlyProvidedBy</a></li>
<li><a class="reference internal" href="#directlyprovides">directlyProvides</a></li>
<li><a class="reference internal" href="#getadapter">getAdapter</a></li>
<li><a class="reference internal" href="#getadapterincontext">getAdapterInContext</a></li>
<li><a class="reference internal" href="#getadapters">getAdapters</a></li>
<li><a class="reference internal" href="#getallutilitiesregisteredfor">getAllUtilitiesRegisteredFor</a></li>
<li><a class="reference internal" href="#getfactoriesfor">getFactoriesFor</a></li>
<li><a class="reference internal" href="#getfactoryinterfaces">getFactoryInterfaces</a></li>
<li><a class="reference internal" href="#getglobalsitemanager">getGlobalSiteManager</a></li>
<li><a class="reference internal" href="#getmultiadapter">getMultiAdapter</a></li>
<li><a class="reference internal" href="#getsitemanager">getSiteManager</a></li>
<li><a class="reference internal" href="#getutilitiesfor">getUtilitiesFor</a></li>
<li><a class="reference internal" href="#getutility">getUtility</a></li>
<li><a class="reference internal" href="#handle">handle</a></li>
<li><a class="reference internal" href="#implementedby">implementedBy</a></li>
<li><a class="reference internal" href="#implementer">implementer</a></li>
<li><a class="reference internal" href="#implements">implements</a></li>
<li><a class="reference internal" href="#implementsonly">implementsOnly</a></li>
<li><a class="reference internal" href="#interface">Interface</a></li>
<li><a class="reference internal" href="#moduleprovides">moduleProvides</a></li>
<li><a class="reference internal" href="#nolongerprovides">noLongerProvides</a></li>
<li><a class="reference internal" href="#provideadapter">provideAdapter</a></li>
<li><a class="reference internal" href="#providehandler">provideHandler</a></li>
<li><a class="reference internal" href="#providesubscriptionadapter">provideSubscriptionAdapter</a></li>
<li><a class="reference internal" href="#provideutility">provideUtility</a></li>
<li><a class="reference internal" href="#providedby">providedBy</a></li>
<li><a class="reference internal" href="#queryadapter">queryAdapter</a></li>
<li><a class="reference internal" href="#queryadapterincontext">queryAdapterInContext</a></li>
<li><a class="reference internal" href="#querymultiadapter">queryMultiAdapter</a></li>
<li><a class="reference internal" href="#queryutility">queryUtility</a></li>
<li><a class="reference internal" href="#registeradapter">registerAdapter</a></li>
<li><a class="reference internal" href="#registeredadapters">registeredAdapters</a></li>
<li><a class="reference internal" href="#registeredhandlers">registeredHandlers</a></li>
<li><a class="reference internal" href="#registeredsubscriptionadapters">registeredSubscriptionAdapters</a></li>
<li><a class="reference internal" href="#registeredutilities">registeredUtilities</a></li>
<li><a class="reference internal" href="#registerhandler">registerHandler</a></li>
<li><a class="reference internal" href="#registersubscriptionadapter">registerSubscriptionAdapter</a></li>
<li><a class="reference internal" href="#registerutility">registerUtility</a></li>
<li><a class="reference internal" href="#subscribers">subscribers</a></li>
<li><a class="reference internal" href="#unregisteradapter">unregisterAdapter</a></li>
<li><a class="reference internal" href="#unregisterhandler">unregisterHandler</a></li>
<li><a class="reference internal" href="#unregistersubscriptionadapter">unregisterSubscriptionAdapter</a></li>
<li><a class="reference internal" href="#unregisterutility">unregisterUtility</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Sujet précédent</h4>
  <p class="topless"><a href="zodb/prog-zodb.html"
                        title="Chapitre précédent">Programmation ZODB</a></p>
  <h4>Sujet suivant</h4>
  <p class="topless"><a href="zcml/index.html"
                        title="Chapitre suivant">Le langage ZCML</a></p>
  <h3>Cette page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/izca-fr.txt"
           rel="nofollow">Montrer la source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Recherche rapide</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Saisissez un mot clef ou un nom de module, classe ou fonction.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="Index général"
             >index</a></li>
        <li class="right" >
          <a href="zcml/index.html" title="Le langage ZCML"
             >suivant</a> |</li>
        <li class="right" >
          <a href="zodb/prog-zodb.html" title="Programmation ZODB"
             >précédent</a> |</li>
        <li><a href="index.html">Formation Plone</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010-2013, Communauté Plone francophone.
      Mis à jour le  07-February-2013.
      Créé avec <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>