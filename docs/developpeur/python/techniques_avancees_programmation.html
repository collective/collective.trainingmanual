

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Quelques Techniques avancées de programmation &mdash; Plone pour les développeurs 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Recherchez dans Plone pour les développeurs 1.0.0 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="top" title="Plone pour les développeurs 1.0.0 documentation" href="../index.html" />
    <link rel="up" title="Presentation de Python" href="index.html" />
    <link rel="next" title="ZODB - Une Base de données objet native pour python" href="../zodb/index.html" />
    <link rel="prev" title="La programmation Orientée Objet" href="programmation_orientee_objet.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../zodb/index.html" title="ZODB - Une Base de données objet native pour python"
             accesskey="N">suivant</a> |</li>
        <li class="right" >
          <a href="programmation_orientee_objet.html" title="La programmation Orientée Objet"
             accesskey="P">précédent</a> |</li>
        <li><a href="../index.html">Formation Plone</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Presentation de Python</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="quelques-techniques-avancees-de-programmation">
<span id="python-techniques-avancees-programmation"></span><h1>Quelques Techniques avancées de programmation<a class="headerlink" href="#quelques-techniques-avancees-de-programmation" title="Lien permanent vers ce titre">¶</a></h1>
<p>Ce chapitre présente quelques exemples de techniques avancées dans les trois
paradigmes que supporte Python, les programmations procédurale, objet et
fonctionnelle.</p>
<div class="section" id="techniques-procedurales">
<h2>Techniques procédurales<a class="headerlink" href="#techniques-procedurales" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="ameliorer-la-documentation">
<h3>Améliorer la documentation<a class="headerlink" href="#ameliorer-la-documentation" title="Lien permanent vers ce titre">¶</a></h3>
<p>La fonction utilitaire <tt class="xref py py-func docutils literal"><span class="pre">printApi</span></tt> filtre les méthodes disponibles de
element, et affiche les docstrings associés sous une forme plus lisible que
<tt class="xref py py-func docutils literal"><span class="pre">help</span></tt> :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">printApi</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
    <span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="n">el</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">el</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">meth</span> <span class="ow">in</span> <span class="n">methods</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">meth</span><span class="p">)</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">printApi</span><span class="p">([])</span>
</pre></div>
</div>
<p>Son exécution produit :</p>
<div class="highlight-text"><div class="highlight"><pre>L.append(object) -- append object to end
L.count(value) -&gt; integer -- return number of occurrences of value
L.extend(iterable) -- extend list by appending elements from the iterable
L.index(value, [start, [stop]]) -&gt; integer -- return first index of value.
Raises ValueError if the value is not present.
L.insert(index, object) -- insert object before index
L.pop([index]) -&gt; item -- remove and return item at index (default last).
Raises IndexError if list is empty or index is out of range.
L.remove(value) -- remove first occurrence of value.
Raises ValueError if the value is not present.
L.reverse() -- reverse *IN PLACE*
L.sort(cmp=None, key=None, reverse=False) -- stable sort *IN PLACE*;
cmp(x, y) -&gt; -1, 0, 1
</pre></div>
</div>
</div>
<div class="section" id="faire-des-menus-avec-un-dictionnaire">
<h3>Faire des menus avec un dictionnaire<a class="headerlink" href="#faire-des-menus-avec-un-dictionnaire" title="Lien permanent vers ce titre">¶</a></h3>
<p>On peut utiliser le couple clé : valeur d'un dictionnaire pour implémenter un
menu, de la façon suivante :</p>
<blockquote>
<div><ul class="simple">
<li>on donne à <em>cle</em> le nom d'un élément du menu ;</li>
<li>la valeur correspondante est une référence : l'appel à une procédure sans argument.</li>
</ul>
</div></blockquote>
<p>L'exemple proposé est la programmation d'une queue FIFO, une structure de
données illustrée par la file d'attente à un guichet : le premier arrivé est le
premier servi.</p>
<p>Source du module de fonctions :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;Module de gestion d&#39;une queue FIFO.&quot;&quot;&quot;</span>

<span class="n">queue</span> <span class="o">=</span> <span class="p">[]</span> <span class="c"># initialisation</span>

<span class="k">def</span> <span class="nf">enQueue</span><span class="p">():</span>
    <span class="n">queue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s">&quot;Entrez un entier : &quot;</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">deQueue</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">queue</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Impossible : la queue est vide !&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Elément &#39;</span><span class="si">%d</span><span class="s">&#39; supprimé&quot;</span> <span class="o">%</span> <span class="n">queue</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">afficheQueue</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">queue :&quot;</span><span class="p">,</span> <span class="n">queue</span><span class="p">)</span>
</pre></div>
</div>
<p>Source du menu de gestion :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;Implémentation d&#39;une queue FIFO avec une liste.</span>

<span class="sd">  Un menu (utilisant un dictionnaire)</span>
<span class="sd">  appelle des procédures sans argument.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="c"># import</span>
<span class="kn">from</span> <span class="nn">queue_FIFO_menu_m</span> <span class="kn">import</span> <span class="n">enQueue</span><span class="p">,</span> <span class="n">deQueue</span><span class="p">,</span> <span class="n">afficheQueue</span>

<span class="c"># programme principal -----------------------------------------------</span>
<span class="n">afficheQueue</span><span class="p">()</span>

<span class="n">CMDs</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;a&#39;</span><span class="p">:</span><span class="n">enQueue</span><span class="p">,</span> <span class="s">&#39;v&#39;</span><span class="p">:</span><span class="n">afficheQueue</span><span class="p">,</span> <span class="s">&#39;s&#39;</span><span class="p">:</span><span class="n">deQueue</span><span class="p">}</span>

<span class="n">menu</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;</span>
<span class="s">(A)jouter</span>
<span class="s">(V)oir</span>
<span class="s">(S)upprimer</span>
<span class="s">(Q)uitter</span>
<span class="s">Votre choix ? &quot;&quot;&quot;</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">choix</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="n">menu</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">choix</span> <span class="o">=</span> <span class="s">&#39;q&#39;</span>

    <span class="k">if</span> <span class="n">choix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="s">&#39;avsq&#39;</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;Option invalide ! Réessayez&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">break</span>
<span class="k">if</span> <span class="n">choix</span> <span class="o">==</span> <span class="s">&#39;q&#39;</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Au revoir !&quot;</span><span class="p">)</span>
    <span class="k">break</span>
<span class="n">CMDs</span><span class="p">[</span><span class="n">choix</span><span class="p">]()</span>
</pre></div>
</div>
</div>
<div class="section" id="expressions-regulieres">
<h3>Expressions régulières<a class="headerlink" href="#expressions-regulieres" title="Lien permanent vers ce titre">¶</a></h3>
<p>Le module <tt class="xref py py-mod docutils literal"><span class="pre">re</span></tt> permet d'accéder à la richesse des expressions rationnelles
(&quot;régulière&quot; est une traduction malheureuse du terme anglais &quot;regular&quot;).</p>
<dl class="glossary docutils">
<dt id="term-expression-rationnelle">Expression rationnelle</dt>
<dd>C'est une suite de caractères qui permet de décrire d'autres chaînes de
caractères (les motifs) afin de les retrouver dans un bloc de caractères.</dd>
</dl>
<p>La construction de l'expression repose sur l'usage de caractères qui seront
interprétés comme joker, répéteur ou groupe et des autres caractères
interprétés comme motif.</p>
<p>Ainsi :</p>
<ul class="simple">
<li><tt class="samp docutils literal"><span class="pre">(</span><em><span class="pre">experssion</span></em><span class="pre">)</span></tt> indique un groupe,</li>
<li><tt class="samp docutils literal"><span class="pre">[</span><em><span class="pre">caractères</span></em><span class="pre">]</span></tt> indique un ensemble de caractère, ex :<ul>
<li><tt class="samp docutils literal"><span class="pre">[aez]</span></tt> soit <tt class="docutils literal"><span class="pre">a</span></tt>, soit <tt class="docutils literal"><span class="pre">e</span></tt>, soit <tt class="docutils literal"><span class="pre">z</span></tt></li>
<li><tt class="samp docutils literal"><span class="pre">[a-z]</span></tt> tout de <tt class="docutils literal"><span class="pre">a</span></tt> à <tt class="docutils literal"><span class="pre">z</span></tt></li>
</ul>
</li>
<li><tt class="samp docutils literal"><span class="pre">[^</span><em><span class="pre">caractères</span></em><span class="pre">]</span></tt> indique tout caractère autres que ceux de l'ensemble, ex <tt class="samp docutils literal"><span class="pre">[^a-c]</span></tt>
tout sauf <tt class="docutils literal"><span class="pre">a</span></tt>, <tt class="docutils literal"><span class="pre">b</span></tt>, <tt class="docutils literal"><span class="pre">c</span></tt>,</li>
<li><tt class="docutils literal"><span class="pre">.</span></tt> tout caractère,</li>
<li><tt class="docutils literal"><span class="pre">|</span></tt> indique une alternative,</li>
<li><tt class="docutils literal"><span class="pre">?</span></tt> indique que le motif précédent peut être ou non présent,</li>
<li><tt class="docutils literal"><span class="pre">*</span></tt> indique la possibilité de répéter le motif indéfiniment ou aucune fois,</li>
<li><tt class="docutils literal"><span class="pre">+</span></tt> indique la possibilité de répéter le motif au moins une fois.</li>
</ul>
<p>Les symboles peuvent être échappés par exemple : <tt class="samp docutils literal"><span class="pre">[[]</span></tt> indique le
caractère <tt class="samp docutils literal"><span class="pre">[</span></tt></p>
<p>Beaucoup d'autres symboles ont un sens. Le module <tt class="xref py py-mod docutils literal"><span class="pre">sre</span></tt> plus riche en donne
la liste.</p>
<p>Une fois l'expression construite nous allons l'utiliser pour trouver les motifs
d'une chaine :</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">re</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expression_rationnelle</span> <span class="o">=</span> <span class="s">&quot;[a-zA-Z]*&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phrase</span> <span class="o">=</span> <span class="s">&quot;Cette phrase contient cinq motifs&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">phrase</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">start</span><span class="p">():</span> <span class="n">x</span><span class="o">.</span><span class="n">end</span><span class="p">()]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span>
<span class="gp">... </span><span class="n">re</span><span class="o">.</span><span class="n">finditer</span><span class="p">(</span><span class="n">expression_rationnelle</span><span class="p">,</span> <span class="n">phrase</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">end</span><span class="p">()</span> <span class="o">!=</span> <span class="n">x</span><span class="o">.</span><span class="n">start</span><span class="p">()]</span>
<span class="go">[&#39;Cette&#39;, &#39;phrase&#39;, &#39;contient&#39;, &#39;cinq&#39;, &#39;motifs&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">expression_rationnelle</span><span class="p">,</span> <span class="n">phrase</span><span class="p">)</span>
<span class="go">&lt;_sre.SRE_Match object at ...&gt;</span>
</pre></div>
</div>
<p>La fonction <tt class="xref py py-func docutils literal"><span class="pre">finditer</span></tt> permet de retourner un liste d'objet
<tt class="xref py py-class docutils literal"><span class="pre">Match</span></tt>.</p>
<p>Les objets <tt class="xref py py-class docutils literal"><span class="pre">Match</span></tt> permettent de connaitre le début et la fin d'un motif,
si la fin est égale au début c'est qu'il ne s'agit pas d'un motif reconnu.</p>
<p>L'expression rationnelle est analysée à chaque demande ce qui consomme de la
puissance pour rien. On peut alors optimiser en compilant l'expression :</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">re</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">expression_rationnelle</span> <span class="o">=</span> <span class="s">&quot;[a-zA-Z]*&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phrase</span> <span class="o">=</span> <span class="s">&quot;Cette phrase contient cinq motifs&quot;</span>
<span class="go">    &gt;&gt;&gt; erc = re.compile(expression_rationnelle)</span>
<span class="go">    &gt;&gt;&gt; re.match(erc, phrase)</span>
<span class="go">    &lt;_sre.SRE_Match object at ...</span>
</pre></div>
</div>
</div>
<div class="section" id="les-fonctions-recursives">
<h3>Les fonctions récursives<a class="headerlink" href="#les-fonctions-recursives" title="Lien permanent vers ce titre">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-fonction-recursive">Fonction récursive</dt>
<dd>Une fonction récursive peut s'appeler elle-même.</dd>
</dl>
<p>Par exemple, trier un tableau de <tt class="docutils literal"><span class="pre">N</span></tt> éléments par ordre croissant c'est extraire
le plus petit élément puis trier le tableau restant à <tt class="docutils literal"><span class="pre">N</span> <span class="pre">-</span> <span class="pre">1</span></tt> éléments.</p>
<p>Bien que cette méthode soit souvent plus difficile à comprendre et à coder que
la méthode classique dite itérative, elle est, dans certains cas, l'application
la plus directe de sa définition mathématique.</p>
<p>Voici l'exemple classique de définition par récurrence de la fonction
factorielle :</p>
<div class="highlight-text"><div class="highlight"><pre>n! = | 1 si n = 0
     | n (n - 1)! si n &gt; 1
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Son code est très exactement calqué sur sa définition mathématique :</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">factorielle</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c"># cas de base : condition terminale</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span> <span class="c"># cas récursif</span>
        <span class="k">return</span> <span class="n">n</span><span class="o">*</span><span class="n">factorielle</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Dans cette définition, la valeur de <tt class="docutils literal"><span class="pre">n</span></tt> n'est pas connue tant que l'on n'a pas
atteint la condition terminale (ici <tt class="docutils literal"><span class="pre">n</span> <span class="pre">==</span> <span class="pre">0</span></tt>). Le programme empile les appels
récursifs jusqu'à atteindre la condition terminale puis dépile les valeurs.</p>
</div>
<div class="section" id="les-generateurs-et-les-expressions-generatrices">
<h3>Les générateurs et les expressions génératrices<a class="headerlink" href="#les-generateurs-et-les-expressions-generatrices" title="Lien permanent vers ce titre">¶</a></h3>
<p class="rubric">Les générateurs</p>
<p>Les générateurs fournissent un moyen de générer des exécutions paresseuses
<a class="footnote-reference" href="#lazy" id="id1">[1]</a>, ce qui signifie qu'elles ne calculent que les valeurs réellement
demandées. Les générateurs s'appuient sur le mot-clé <tt class="docutils literal"><span class="pre">yield</span></tt>.</p>
<p>Cette instruction suspend l'exécution de la fonction qui l'exécute, à la façon
de <tt class="docutils literal"><span class="pre">return</span></tt> et retourne l'argument à sa droite. Lors de l'appel suivant,
l'exécution reprend à la suite de la ligne contenant le <tt class="docutils literal"><span class="pre">yield</span></tt>.</p>
<table class="docutils footnote" frame="void" id="lazy" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>&quot;Paresseux&quot; est une traduction littérale du terme anglais &quot;lazy&quot;.</td></tr>
</tbody>
</table>
<p>Ceci peut s'avérer beaucoup plus efficace (en terme de mémoire) que le calcul,
par exemple, d'une énorme liste en une seule fois.</p>
<p>Voici un exemple de générateur qui fournit autant de valeurs que demandées :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">quarters</span><span class="p">(</span><span class="n">next_quarter</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">next_quarter</span>
        <span class="n">next_quarter</span> <span class="o">+=</span> <span class="mf">0.25</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">quarters</span><span class="p">():</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="k">break</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;Liste résultante : &quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
<span class="c"># Liste résultante : [0.0, 0.25, 0.5, 0.75, 1.0]</span>
</pre></div>
</div>
<p>Il est aussi possible de passer une initialisation au générateur :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>

<span class="k">def</span> <span class="nf">quarters</span><span class="p">(</span><span class="n">next_quarter</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">received</span> <span class="o">=</span> <span class="p">(</span><span class="k">yield</span> <span class="n">next_quarter</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">received</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">next_quarter</span> <span class="o">+=</span> <span class="mf">0.25</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">next_quarter</span> <span class="o">+=</span> <span class="n">received</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">generator</span> <span class="o">=</span> <span class="n">quarters</span><span class="p">()</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">sys</span><span class="o">.</span><span class="n">float_info</span><span class="o">.</span><span class="n">epsilon</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="c"># réinitialise le générarteur</span>
        <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s">&quot;Liste résultante : &quot;</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
    <span class="c"># Liste résultante : [0.0, 0.25, 1.5, 1.75, 2.0]</span>
</pre></div>
</div>
<p class="rubric">Syntaxe</p>
<p><em>Une expression génératrice possède une syntaxe presque identique à celle des
listes en intension ; la différence est qu'une expression génératrice est
entourée de parenthèses.</em></p>
<p class="rubric">Utilisation</p>
<p>Les expressions génératrices sont aux générateurs ce que les listes en
intension sont aux fonctions.</p>
</div>
<div class="section" id="les-fonctions-incluses">
<h3>Les fonctions incluses<a class="headerlink" href="#les-fonctions-incluses" title="Lien permanent vers ce titre">¶</a></h3>
<p>La syntaxe de définition des fonctions en Python permet tout à fait d'emboîter
leur définition. Distinguons deux cas d'emplois :</p>
<ul class="simple">
<li>Idiome de la fonction fabrique renvoyant une fermeture :</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">creer_plus</span><span class="p">(</span><span class="n">ajout</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fonction &#39;fabrique&#39;.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">plus</span><span class="p">(</span><span class="n">increment</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Fonction &#39;fermeture&#39; : utilise des noms locaux à creer_plus().&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">increment</span> <span class="o">+</span> <span class="n">ajout</span>
    <span class="k">return</span> <span class="n">plus</span>

<span class="c"># Programme principal -----------------------------------------------</span>
<span class="c">## création de deux fabriques distinctes</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">creer_plus</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">creer_plus</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="c">## utilisation</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;p(100) =&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;q(100) =&quot;</span><span class="p">,</span> <span class="n">q</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
<p>Fonction fabrique renvoyant une classe :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># classes</span>
<span class="k">class</span> <span class="nc">CasNormal</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">uneMethode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;normal&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">CasSpecial</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">uneMethode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&quot;spécial&quot;</span><span class="p">)</span>

<span class="c"># fonction</span>
<span class="k">def</span> <span class="nf">casQuiConvient</span><span class="p">(</span><span class="n">estNormal</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fonction fabrique renvoyant une classe.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">CasNormal</span><span class="p">()</span> <span class="k">if</span> <span class="n">estNormal</span> <span class="k">else</span> <span class="n">CasSpecial</span><span class="p">()</span>

<span class="c"># Programme principal -----------------------------------------------</span>
<span class="n">une_instance</span> <span class="o">=</span> <span class="n">casQuiConvient</span><span class="p">()</span>
<span class="n">une_instance</span><span class="o">.</span><span class="n">uneMethode</span><span class="p">()</span> <span class="c"># normal</span>

<span class="n">autre_instance</span> <span class="o">=</span> <span class="n">casQuiConvient</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="n">autre_instance</span><span class="o">.</span><span class="n">uneMethode</span><span class="p">()</span> <span class="c"># spécial</span>
</pre></div>
</div>
</div>
<div class="section" id="les-decorateurs">
<h3>Les décorateurs<a class="headerlink" href="#les-decorateurs" title="Lien permanent vers ce titre">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">On utilise un décorateur lorsqu'on a besoin d'effectuer un prétraitement lors
de l'appel d'une fonction ou un post-traitement à la suite de l'appel d'une
fonction.</p>
</div>
<p>Soit le prétraitement suivant :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">pretraitement</span><span class="p">(</span><span class="n">fonction</span><span class="p">):</span>
    <span class="n">fonction</span><span class="o">.</span><span class="n">__doc__</span> <span class="o">+=</span> <span class="s">&quot;(fonction décorée).&quot;</span>
    <span class="k">return</span> <span class="n">fonction</span>

<span class="k">def</span> <span class="nf">traitement</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;ma fonction &quot;&quot;&quot;</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;traitement&quot;</span><span class="p">)</span>

<span class="n">traitement</span> <span class="o">=</span> <span class="n">pretraitement</span><span class="p">(</span><span class="n">traitement</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">traitement</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span> <span class="c"># ma fonction (fonction décorée).</span>
</pre></div>
</div>
<p>Nous obtenons le même résultat en utilisant un décorateur :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">pretraitement</span><span class="p">(</span><span class="n">fonction</span><span class="p">):</span>
    <span class="n">fonction</span><span class="o">.</span><span class="n">__doc__</span> <span class="o">+=</span> <span class="s">&quot;(fonction décorée).&quot;</span>
    <span class="k">return</span> <span class="n">fonction</span>

<span class="nd">@pretraitement</span>
<span class="k">def</span> <span class="nf">traitement</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;ma fonction &quot;&quot;&quot;</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&quot;traitement&quot;</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">traitement</span><span class="o">.</span><span class="n">__doc__</span><span class="p">)</span> <span class="c"># ma fonction (fonction décorée).</span>
</pre></div>
</div>
<p>Enfin il est possible d'enchaîner les décorateurs (à l'image de la composition
des fonctions en mathématique) :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@f1</span> <span class="nd">@f2</span> <span class="nd">@f3</span>
<span class="k">def</span> <span class="nf">fonction</span><span class="p">():</span>
    <span class="k">pass</span>
<span class="c"># Notation équivalente à : fonction = f1(f2(f3(fonction)))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="techniques-objets">
<h2>Techniques objets<a class="headerlink" href="#techniques-objets" title="Lien permanent vers ce titre">¶</a></h2>
<p>Comme nous l'avons vu lors du chapitre précédent, Python est un langage
complètement objet.</p>
<p>Tous les types de base ou dérivés sont en réalité des types abstrait de données
implémentés sous forme de classe.</p>
<p>Toutes ces classes dérivent d'une unique classe de base, ancêtre de tous les
autres : la classe <tt class="xref py py-class docutils literal"><span class="pre">object</span></tt>.</p>
<div class="section" id="slot-et-dict">
<h3><tt class="xref py py-meth docutils literal"><span class="pre">__slot__</span></tt> et <tt class="xref py py-meth docutils literal"><span class="pre">__dict__</span></tt><a class="headerlink" href="#slot-et-dict" title="Lien permanent vers ce titre">¶</a></h3>
<p>Examinons le code suivant :</p>
<div class="highlight-python"><pre>&gt;&gt;&gt; class Point:
...    __slots__ = ("x", "y")
...    def __init__(self, x=0, y=0):
...        self.x = x
...        self.y = y
&gt;&gt;&gt; p=Point()
&gt;&gt;&gt; p.v = "Interdit"
Traceback (most recent call last):
File "&lt;stdin&gt;", line 1, in &lt;module&gt;
AttributeError: 'Point' object has no attribute 'v'</pre>
</div>
<p>Quand une classe est créée sans utiliser l'attribut <tt class="xref py py-attr docutils literal"><span class="pre">__slots__</span></tt>, ce que
nous avons fait jusqu'à maintenant, Python crée de manière transparente un
dictionnaire privé appelé <tt class="xref py py-attr docutils literal"><span class="pre">__dict__</span></tt> pour chaque instance de la classe, et
ce dictionnaire contient les attributs de l'instance.</p>
<p>Voici pourquoi il est possible d'ajouter ou de retirer des attributs d'un objet.</p>
<p>Mais si l'on se contente d'objets sur lesquels nous accédons aux attributs sans
en ajouter ou en ôter, nous pouvons créer des classes sans dictionnaire privé,
ce qui économisera de la mémoire à chaque instanciation.</p>
<p>C'est ce qui est réalisé dans l'exemple ci-dessus en définissant un attribut de
classe <tt class="xref py py-attr docutils literal"><span class="pre">__slots__</span></tt> dont la valeur est un tuple formé des noms des
attributs.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Sous python 2 la classe utilisant slots doit être dérivée de object.</p>
</div>
</div>
<div class="section" id="functor">
<h3>Functor<a class="headerlink" href="#functor" title="Lien permanent vers ce titre">¶</a></h3>
<p>En Python un objet fonction ou fonctor est une référence à tout objet
<strong>appelable</strong> (callable) : fonction, fonction lambda, méthode, classe.</p>
<p>La fonction prédéfinie <tt class="xref py py-func docutils literal"><span class="pre">callable</span></tt> permet de tester cette propriété :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">maFonction</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">print</span><span class="p">(</span><span class="s">&#39;Ceci est &quot;appelable&quot;&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">callable</span><span class="p">(</span><span class="n">maFonction</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chaine</span> <span class="o">=</span> <span class="s">&#39;Ceci est &quot;appelable&quot;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">callable</span><span class="p">(</span><span class="n">chaine</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Il est possible de transformer les instances d'une classe en functor si la
méthode spéciale <tt class="xref py py-meth docutils literal"><span class="pre">__call__</span></tt> est définie dans la la classe :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
<span class="go">def __call__(self, un , deux):</span>
<span class="go">    return un + deux</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">callable</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">7</span>
</pre></div>
</div>
</div>
<div class="section" id="les-gestionnaires-de-contexte">
<h3>Les gestionnaires de contexte<a class="headerlink" href="#les-gestionnaires-de-contexte" title="Lien permanent vers ce titre">¶</a></h3>
<p>Les gestionnaires de contexte simplifient nos codes en assurant que certaines
opérations sont effectuées avant et après un bloc d'instruction donné.</p>
<p class="rubric">Syntaxe</p>
<p>On utilise l'instruction <tt class="docutils literal"><span class="pre">with</span></tt>.</p>
<pre>
<strong id="grammar-token-with_block">with_block</strong> ::=  &quot;with&quot; <tt class="xref docutils literal"><span class="pre">expression</span></tt> &quot;as&quot; <tt class="xref docutils literal"><span class="pre">symbol</span></tt> &quot;:&quot; <tt class="xref docutils literal"><span class="pre">suite</span></tt>
</pre>
<p>Une utilisation classique est d'assurer la fermeture d'un fichier :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;hello.txt&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">line</span>
</pre></div>
</div>
<p>L' &lt;expression&gt; retourne un <strong>gestionnaire de contexte</strong> associé à
&lt;variable&gt;. un gestionnaire de contexte est un objet quelconque fournissant les
méthodes <tt class="xref py py-meth docutils literal"><span class="pre">__enter__</span></tt> et <tt class="xref py py-meth docutils literal"><span class="pre">__exit__</span></tt>.</p>
<p>La méthode <tt class="xref py py-meth docutils literal"><span class="pre">__enter__</span></tt> de l'objet retourné par l'expression est exécutée
par le mot-clé <tt class="docutils literal"><span class="pre">with</span></tt>. L'objet retourné par cette méthode est associé au
symbole suivant le mot-clé <tt class="docutils literal"><span class="pre">as</span></tt>. Généralement, il s'agit du gestionnaire de
contexte lui-même (donc <tt class="samp docutils literal"><span class="pre">return</span> <span class="pre">self</span></tt>).</p>
<p>Lors de la cloture du bloc commencé par <tt class="docutils literal"><span class="pre">with</span></tt>, la méthode <tt class="xref py py-meth docutils literal"><span class="pre">__exit__</span></tt> du
gestionnaire de ocontexte est appellée, avec les informations sur une éventuelle
exception survenue dans le bloc. Le rôle de cette méthode est d'effectuer
l'éventuel &quot;nettoyage&quot; associé à la fin d'utilisation du gestionnaire de
contexte.</p>
</div>
</div>
<div class="section" id="techniques-fonctionnelles">
<h2>Techniques fonctionnelles<a class="headerlink" href="#techniques-fonctionnelles" title="Lien permanent vers ce titre">¶</a></h2>
<div class="section" id="directive-lambda">
<h3>Directive lambda<a class="headerlink" href="#directive-lambda" title="Lien permanent vers ce titre">¶</a></h3>
<p>Issue de langages fonctionnels (comme Lisp), la directive lambda permet de
définir un objet fonction anonyme dont le retour est limité à une expression.</p>
<p class="rubric">Syntaxe</p>
<pre>
<strong id="grammar-token-lambda_stmt">lambda_stmt</strong> ::=  &quot;lambda&quot; [<tt class="xref docutils literal"><span class="pre">parametres</span></tt>] &quot;:&quot; <tt class="xref docutils literal"><span class="pre">expression</span></tt>
</pre>
<p>Par exemple cette fonction retourne &quot;s&quot; si son argument est différent de 1,
une chaîne vide sinon :</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s">&quot;&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="s">&quot;s&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&#39;s&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;&#39;</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Dans la présentation des interfaces graphiques, on verra que les callbacks sont
souvent codés ainsi :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mi">0</span><span class="p">:</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">z</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="p">())</span> <span class="c"># 5</span>

<span class="k">def</span> <span class="nf">make_increment</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">n</span>

<span class="n">f2</span><span class="p">,</span> <span class="n">f6</span> <span class="o">=</span> <span class="n">make_increment</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">make_increment</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f2</span><span class="p">(</span><span class="mi">42</span><span class="p">),</span> <span class="n">f6</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span> <span class="c"># 44 48</span>

<span class="n">lc</span> <span class="o">=</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span><span class="p">]</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">lc</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s">&quot; &quot;</span><span class="p">)</span> <span class="c"># 4 8 16</span>
</pre></div>
</div>
</div>
<div class="section" id="les-fonctions-map-filter-et-reduce">
<h3>Les fonctions map, filter et reduce<a class="headerlink" href="#les-fonctions-map-filter-et-reduce" title="Lien permanent vers ce titre">¶</a></h3>
<p>La programmation fonctionnelle est un paradigme de programmation qui considère
le calcul en tant qu'évaluation de fonctions mathématiques et rejette le
changement d'état et la mutation des données.</p>
<p>Elle souligne l'application des fonctions, contrairement au modèle de
programmation impérative qui met en avant les changements d'état.</p>
<p>Le paradigme fonctionnel n'utilise pas de machine d'états pour décrire un
programme, mais un emboîtement de fonctions que l'on peut voir comme des
&quot;boîtes noires&quot; que l'on peut imbriquer les unes dans les autres.</p>
<p>Chaque boîte possédant plusieurs paramètres en entrée mais une seule sortie,
elle ne peut sortir qu'une seule valeur possible pour chaque n-uplet de valeurs
présentées en entrée.
Ainsi, les fonctions n'introduisent pas d'effets de bord.</p>
<p>Un programme est donc une application, au sens mathématique, qui ne donne
qu'un seul résultat pour chaque ensemble de valeurs en entrée.</p>
<p>La programmation fonctionnelle repose sur trois concepts : mapping, filtering
et reducing qui sont implémentésen Python par trois fonctions :
<tt class="xref py py-func docutils literal"><span class="pre">map</span></tt>, <tt class="xref py py-func docutils literal"><span class="pre">filter</span></tt> et <tt class="xref py py-func docutils literal"><span class="pre">reduce</span></tt>.</p>
<p class="rubric">La fonction map()</p>
<p><tt class="xref py py-func docutils literal"><span class="pre">map</span></tt> applique une fonction à chaque élément d'une séquence et
retourne un itérateur :</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">renvoiTitres</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">element</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">map</span><span class="p">(</span><span class="n">renvoiTitres</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;fiat lux&#39;</span><span class="p">,</span> <span class="s">&quot;lord of the fly&quot;</span><span class="p">])</span>
<span class="go">[&#39;Fiat Lux&#39;, &#39;Lord Of The Fly&#39;]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;fiat lux&#39;</span><span class="p">,</span> <span class="s">&quot;lord of the fly&quot;</span><span class="p">]]</span>
<span class="go">[&#39;Fiat Lux&#39;, &#39;Lord Of The Fly&#39;]</span>
</pre></div>
</div>
<p>On remarque que <tt class="xref py py-func docutils literal"><span class="pre">map</span></tt> peut être remplacée par une liste en intension. Voir
<a class="reference internal" href="conteneurs_standard.html#python-listes-en-intention"><em>Les listes en intension</em></a>.</p>
<p class="rubric">La fonction filter()</p>
<p><tt class="xref py py-func docutils literal"><span class="pre">filter</span></tt> construit et renvoie un itérateur sur une liste qui contient tous
les éléments de la séquence initiale répondant au critère <tt class="docutils literal"><span class="pre">function(element)</span> <span class="pre">==</span> <span class="pre">True</span></tt> :</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">])</span>
<span class="go">[1, 3]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">[1, 3]</span>
</pre></div>
</div>
<p>On remarque que <tt class="xref py py-func docutils literal"><span class="pre">filter</span></tt> peut être remplacée par une liste en
intension avec un test.</p>
<p class="rubric">La fonction reduce()</p>
<p><tt class="xref py py-func docutils literal"><span class="pre">reduce</span></tt> est une fonction du module functools.  Elle applique de façon
cumulative une fonction de deux arguments aux éléments d'une séquence, de gauche
à droite, de façon à réduire cette séquence à une seule valeur qu'elle renvoie :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">somme</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">x</span><span class="p">,</span> <span class="s">&#39;+&#39;</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">reduce</span><span class="p">(</span><span class="n">somme</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="go">1 + 2</span>
<span class="go">3 + 3</span>
<span class="go">6 + 4</span>
<span class="go">10</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="go">10</span>
</pre></div>
</div>
<p>On remarque que <tt class="xref py py-func docutils literal"><span class="pre">reduce</span></tt> peut être remplacée par une des fonctions
suivantes : <tt class="xref py py-func docutils literal"><span class="pre">all</span></tt>, <tt class="xref py py-func docutils literal"><span class="pre">any</span></tt>, func:<cite>max</cite>, <tt class="xref py py-func docutils literal"><span class="pre">min</span></tt> ou func:<cite>sum</cite>.</p>
</div>
<div class="section" id="les-applications-partielles-de-fonctions">
<h3>Les applications partielles de fonctions<a class="headerlink" href="#les-applications-partielles-de-fonctions" title="Lien permanent vers ce titre">¶</a></h3>
<p>Issue de la programmation fonctionnelle, une PFA (application partielle de
fonction) de n paramètres prend le premier argument comme paramètre fixe et
retourne un objet fonction (ou instance) utilisant les n-1 arguments restants.</p>
<p>Exemple simple :</p>
<div class="highlight-pycon"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">baseTwo</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">baseTwo</span><span class="p">(</span><span class="s">&#39;10010&#39;</span><span class="p">)</span>
<span class="go">18</span>
</pre></div>
</div>
<p>Les PFA sont très utiles pour fournir des modèles partiels de widgets, qui ont
souvent de nombreux paramètres.  Dans l'exemple suivant, on redéfinie la classe
<tt class="xref py py-class docutils literal"><span class="pre">Button</span></tt> en fixant certains de ses attributs (qui peuvent toujours être
surchargés) :</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">tkinter</span> <span class="kn">as</span> <span class="nn">tk</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
<span class="c"># instanciation partielle de classe :</span>
<span class="n">MonBouton</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s">&#39;purple&#39;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s">&#39;green&#39;</span><span class="p">)</span>
<span class="n">MonBouton</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">&quot;Bouton 1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
<span class="n">MonBouton</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">&quot;Bouton 2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">()</span>
<span class="n">MonBouton</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">&quot;QUITTER&quot;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s">&#39;red&#39;</span><span class="p">,</span> <span class="n">fg</span><span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">,</span>
    <span class="n">command</span><span class="o">=</span><span class="n">root</span><span class="o">.</span><span class="n">quit</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">root</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s">&quot;PFA !&quot;</span><span class="p">)</span>
<span class="n">root</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="exercice">
<h2>Exercice<a class="headerlink" href="#exercice" title="Lien permanent vers ce titre">¶</a></h2>
<p>Lecture d'un fichier, traitement avec une expression régulière et écriture des
résultats dans un fichier.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table des matières</a></h3>
  <ul>
<li><a class="reference internal" href="#">Quelques Techniques avancées de programmation</a><ul>
<li><a class="reference internal" href="#techniques-procedurales">Techniques procédurales</a><ul>
<li><a class="reference internal" href="#ameliorer-la-documentation">Améliorer la documentation</a></li>
<li><a class="reference internal" href="#faire-des-menus-avec-un-dictionnaire">Faire des menus avec un dictionnaire</a></li>
<li><a class="reference internal" href="#expressions-regulieres">Expressions régulières</a></li>
<li><a class="reference internal" href="#les-fonctions-recursives">Les fonctions récursives</a></li>
<li><a class="reference internal" href="#les-generateurs-et-les-expressions-generatrices">Les générateurs et les expressions génératrices</a></li>
<li><a class="reference internal" href="#les-fonctions-incluses">Les fonctions incluses</a></li>
<li><a class="reference internal" href="#les-decorateurs">Les décorateurs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#techniques-objets">Techniques objets</a><ul>
<li><a class="reference internal" href="#slot-et-dict"><tt class="docutils literal"><span class="pre">__slot__</span></tt> et <tt class="docutils literal"><span class="pre">__dict__</span></tt></a></li>
<li><a class="reference internal" href="#functor">Functor</a></li>
<li><a class="reference internal" href="#les-gestionnaires-de-contexte">Les gestionnaires de contexte</a></li>
</ul>
</li>
<li><a class="reference internal" href="#techniques-fonctionnelles">Techniques fonctionnelles</a><ul>
<li><a class="reference internal" href="#directive-lambda">Directive lambda</a></li>
<li><a class="reference internal" href="#les-fonctions-map-filter-et-reduce">Les fonctions map, filter et reduce</a></li>
<li><a class="reference internal" href="#les-applications-partielles-de-fonctions">Les applications partielles de fonctions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exercice">Exercice</a></li>
</ul>
</li>
</ul>

  <h4>Sujet précédent</h4>
  <p class="topless"><a href="programmation_orientee_objet.html"
                        title="Chapitre précédent">La programmation Orientée Objet</a></p>
  <h4>Sujet suivant</h4>
  <p class="topless"><a href="../zodb/index.html"
                        title="Chapitre suivant">ZODB - Une Base de données objet native pour python</a></p>
  <h3>Cette page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/python/techniques_avancees_programmation.txt"
           rel="nofollow">Montrer la source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Recherche rapide</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Saisissez un mot clef ou un nom de module, classe ou fonction.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             >index</a></li>
        <li class="right" >
          <a href="../zodb/index.html" title="ZODB - Une Base de données objet native pour python"
             >suivant</a> |</li>
        <li class="right" >
          <a href="programmation_orientee_objet.html" title="La programmation Orientée Objet"
             >précédent</a> |</li>
        <li><a href="../index.html">Formation Plone</a> &raquo;</li>
          <li><a href="index.html" >Presentation de Python</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010-2013, Communauté Plone francophone.
      Mis à jour le  07-February-2013.
      Créé avec <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>