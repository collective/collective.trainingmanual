
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Introduction &mdash; Plone pour les développeurs 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/plone.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Recherchez dans Plone pour les développeurs 1.0.0 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="top" title="Plone pour les développeurs 1.0.0 documentation" href="../index.html" />
    <link rel="up" title="ZODB - Une Base de données objet native pour python" href="index.html" />
    <link rel="next" title="Tutoriel" href="tutorial.html" />
    <link rel="prev" title="ZODB - Une Base de données objet native pour python" href="index.html" />
<script language="javascript">
//<![CDATA[

Documentation.addTranslations({"locale": "fr", "plural_expr": "(n > 1)", "messages": {"See the definition": "Voir la d\u00e9finition"}});

// See http://disqus.disqus.com/general_integration_help/
var disqus_developer = 1;
if (document.location.protocol == 'http:') {
    disqus_developer = 0;
}

// Some HTML/CSS transforms we can't do in pure CSS (waiting for CSS3 support)
$(document).ready(function () {

    // Style of .. verisonmodified:: , .. versionadded:: ...
    $('p:has(span.versionmodified)').addClass('p-versionmodified');

    // Style of the TOC tree
    $('ul:has(li.toctree-l1)').addClass('toctree');

    // Decorate links to other sites
    $('a[class~=external]').attr('target', '_blank');

    // Glossary terms
    $('em.xref').attr('title', _('See the definition'));

    // We need to have all <pre> in a <div class="highlight"> to mimic pygments
    // to work around a pygments (?) bug
    var suffixes = {cfg: null, python:null};
    for (var suffix in suffixes) {
        var pattern = 'div.highlight-' + suffix + ' > pre';
        $(pattern).wrap('<div class="highlight" />');
    }
    return true;
});
//]]>
</script>

  </head>
  <body>
<!--[if lte IE 6]>
<style type="text/css">
#ie6msg{border:3px solid #090; margin:8px 0; background:#cfc; color:#000;}
#ie6msg h4{margin:8px; padding:0;}
#ie6msg p{margin:8px; padding:0;}
#ie6msg p a.getie8{font-weight:bold; color:#006;}
#ie6msg p a.ie6expl{font-weight:normal; color:#006;}
</style>
<div id="ie6msg">
<h4>Did you know that your browser is out of date?</h4>
<p>If the layout of this site seems ugly, that's because you're actually using
an outdated browser. And we wont put any effort to provide a nice layout to IE6
users.</p>
<p>To get the best possible experience using our website we recommend that you
upgrade your browser to a newer version. The current version
is <a class="getie8"
href="http://upgradeie.s3.amazonaws.com/eng/index.html">Internet Explorer
8</a>. The upgrade is free. If you're using a PC at work you should contact your
IT administrator.</p>
<p>If you want to you may also try some other popular Internet browsers
like <a class="ie6expl"
href="http://getfirefox.com">Firefox</a>, <a class="ie6expl"
href="http://www.google.com/chrome">Chrome</a>, <a class="ie6expl"
href="http://www.opera.com">Opera</a>, or <a class="ie6expl"
href="http://www.apple.com/safari/download/">Safari</a></p>
</div>
<![endif]-->

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="tutorial.html" title="Tutoriel"
             accesskey="N">suivant</a> |</li>
        <li class="right" >
          <a href="index.html" title="ZODB - Une Base de données objet native pour python"
             accesskey="P">précédent</a> |</li>
        <li><a href="../index.html">Formation Plone</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">ZODB - Une Base de données objet native pour python</a> &raquo;</li> 
      </ul>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="introduction"></span><div class="section" id="id1">
<h1>Introduction<a class="headerlink" href="#id1" title="Lien permanent vers ce titre">¶</a></h1>
<p>Ce guide explique comment écrire des programmes Python qui utilise  la Z Objects
Database (ZODB) et le Zope Enterprise Objects (ZEO). La dernière version de ce
guide est accessible en anglais à <a class="reference external" href="http://www.zope.org/Wikis/ZODB/guide/index.html">http://www.zope.org/Wikis/ZODB/guide/index.html</a>.</p>
<div class="section" id="qu-est-ce-que-la-zodb">
<h2>Qu'est ce que la ZODB ?<a class="headerlink" href="#qu-est-ce-que-la-zodb" title="Lien permanent vers ce titre">¶</a></h2>
<p>La ZODB est un système de persistance pour les objets Python. Les langages de
programmation persistants offrent la possibilité d'écrire automatiquement les
objets vers le disque et de les relire quand ils sont requis par le programme.
En installant la ZODB, vous ajoutez cette possibilité à Python.</p>
<p>Il vous est possible de créer votre propre système de persistance des objets
Python. Le point de départ habituel d'une telle construction est d'utiliser le
module <tt class="xref py py-mod docutils literal"><span class="pre">pickle</span></tt>, qui convertit les objets en une représentation texte, ainsi
que différents modules de base de données, tels que les modules <tt class="xref py py-mod docutils literal"><span class="pre">gdbm</span></tt> ou
<tt class="xref py py-mod docutils literal"><span class="pre">bsdbd</span></tt>, qui fournissent un moyen d'écrire des chaînes vers le disque et de
les relire. Il est très puissant de combiner le module <tt class="xref py py-mod docutils literal"><span class="pre">pickle</span></tt> et un
module de base de données pour stocker et restituer les objets ; le
module <tt class="xref py py-mod docutils literal"><span class="pre">shelve</span></tt> qui fait partie de la bibliothèque standard de Python, fait
exactement cela.</p>
<p>La difficulté pour le développeur est de gérer explicitement  les
objets, lire un objet quand il en a besoin et l'écrire sur le disque lorsque
l'objet n'est plus requis. La ZODB gère les objets pour vous, les gardes en
cache, les écrit sur le disque lorsqu'ils sont modifiés et les supprime du
cache s'ils n'ont pas été utilisés depuis un moment.</p>
</div>
<div class="section" id="oodbs-vs-dbs-relationnelles">
<h2>OODBs vs. DBs relationnelles<a class="headerlink" href="#oodbs-vs-dbs-relationnelles" title="Lien permanent vers ce titre">¶</a></h2>
<p>La ZODB est une base de
données orientée objet (OODB) spécifique à Python. Les bases de données objets
commerciales pour le C++ et Java réclament souvent de surmonter
certains obstacles tels que l'usage d'un préprocesseur dédié ou que vous
n'utilisiez pas certains types. Comme nous allons le voir, la ZODB a aussi
quelques pièges à éviter, mais en comparaison la simplicité de la ZODB est à
couper le souffle.</p>
<p>Les bases de données relationnelles (RDBs) sont plus communes que les OOBDs. Les
bases de données relationnelles stockent les informations dans des tables. Une
table consiste en un ensemble de lignes, chaque ligne contient plusieurs
colonnes d'informations. (Les lignes sont généralement appelées des relations,
et c'est de là que vient le nom de base de données relationnelles).</p>
<p>Mais regardons un cas concret. Notre exemple est issu d'une journée de travail
de l'auteur initial à MEMS Exchange, en version simplifiée. Le
travail consiste à tracer l'exécution de processus, qui sont constitués d'une
liste d'étapes de fabrication dans une usine de semi-conducteurs. L'exécution
est réalisée par un utilisateur unique, identifié par un nom et un numéro
d'identification. L'exécution est constituée par un nombre déterminé
d'opérations, comme déposer quelque chose sur le wafer ou en enlever quelque
chose.</p>
<p>Les opérations peuvent avoir des paramètres, qui sont des informations
additionnelles requises pour réaliser l'opération. Par exemple, si vous déposez
quelque chose sur wafer, vous avez besoins de savoir deux choses :
1) qu'est ce que vous déposez,
2) quelle quantité vous devez déposer.
Par exemple vous déposez 100 microns d'oxide de silicium ou 1 micron de cuivre.</p>
<p>Mapper cette structure vers une base de données relationnelles est direct :</p>
<div class="highlight-python"><pre>CREATE TABLE runs (
  int      run_id,
  varchar  owner,
  varchar  title,
  int      acct_num,
  primary key(run_id)
);

CREATE TABLE operations (
  int      run_id,
  int      step_num,
  varchar  process_id,
  PRIMARY KEY(run_id, step_num),
  FOREIGN KEY(run_id) REFERENCES runs(run_id),
);

CREATE TABLE parameters (
  int      run_id,
  int      step_num,
  varchar  param_name,
  varchar  param_value,
  PRIMARY KEY(run_id, step_num, param_name)
  FOREIGN KEY(run_id, step_num)
     REFERENCES operations(run_id, step_num),
);</pre>
</div>
<p>En Python, vous pouvez écrire trois classes nommées <tt class="xref py py-class docutils literal"><span class="pre">Run</span></tt>,
<tt class="xref py py-class docutils literal"><span class="pre">Operation</span></tt>, and <tt class="xref py py-class docutils literal"><span class="pre">Parameter</span></tt>. Je ne présenterai pas le code de
définition des ces classes, car le code est en dehors du propos. Chaque classe
devra contenir un constructeur <tt class="xref py py-meth docutils literal"><span class="pre">__init__</span></tt> qui créera les attributs et leur
assignera des valeurs par défaut.</p>
<p>Il n'est pas difficile d'écrire du code Python qui instanciera la classe
<tt class="xref py py-class docutils literal"><span class="pre">Run</span></tt> et la remplira avec les données venant d'une base de données
relationnelle, vous pouvez aussi créer directement un utilitaire pour cette
tâche classiquement appelée un mapper objet-relationnel. (Voir
<a class="reference external" href="http://www.amk.ca/python/unmaintained/ordb.html">http://www.amk.ca/python/unmaintained/ordb.html</a> pour un aperçu rapide d'un
test de mapper objet - relationnel en Python, et
<a class="reference external" href="http://www.python.org/workshops/1997-10/proceedings/shprentz.html">http://www.python.org/workshops/1997-10/proceedings/shprentz.html</a> pour un
autre qui est basé sur la même idée mais qui est utilisé en production).</p>
<p>Néanmoins, il est difficile de réaliser un mapper objet-relationnel rapide; une
implémentation simple comme celle réalisée est très lente car elle doit réaliser
plusieurs requêtes pour accéder à toutes les données des objets. Plusieurs
techniques de cache peuvent optimiser les requêtes SQL et les limiter au strict
nécessaire.</p>
<p>Cela aide si vous souhaitez accéder à l'exécution numéro 123. Mais qu'en est il
si vous voulez trouver toutes les exécutions dont l'une des étapes possède un
paramètre nommé 'thickness' avec une valeur de 2,0 ? Dans une version
relationnelle, vous avez deux possibilités peu attrayantes :</p>
<ol class="arabic">
<li><p class="first">Écrire une requête SQL spécialement pour ce cas : <tt class="docutils literal"><span class="pre">SELECT</span> <span class="pre">run_id</span> <span class="pre">FROM</span>
<span class="pre">operations</span> <span class="pre">WHERE</span> <span class="pre">param_name</span> <span class="pre">=</span> <span class="pre">'thickness'</span> <span class="pre">AND</span> <span class="pre">param_value</span> <span class="pre">=</span> <span class="pre">2.0</span></tt></p>
<p>Si de telles requêtes sont communes, vous pouvez vous retrouver avec
énormément de requêtes de ce type. Quand vous modifierez la structure de
votre base ou de votre code vous aurez à maintenir toutes vos requêtes.</p>
</li>
<li><p class="first">Utiliser un mapper objet relationnel ne vous aidera pas beaucoup plus. Chercher
parmi les exécutions signifie que le mapper déroulera la requête SQL pour
lire l'exécution numéro 1 et qu'un code Python vérifiera si l'une de ses
étapes possède le paramètre que nous cherchons. Même chose pour l'exécution
2 puis 3 etc. Ce qui aboutit a traitement de nombreuses requêtes SQL, et
risque d'être extrêmement long.</p>
</li>
</ol>
<p>Une base de données comme la ZODB va simplement stocker la référence interne
entre objets, en conséquence lire un objet unique est plus rapide qu'envoyer une
série de requêtes et d'assembler les résultats. Scanner toute les exécutions,
est également inefficace.</p>
</div>
<div class="section" id="qu-est-ce-que-la-zeo">
<h2>Qu'est ce que la ZEO ?<a class="headerlink" href="#qu-est-ce-que-la-zeo" title="Lien permanent vers ce titre">¶</a></h2>
<p>La ZODB est fournie avec quelques classes qui implémentent l'interface
<tt class="xref py py-class docutils literal"><span class="pre">Storage</span></tt>. Ces classes sont responsables du travail d'écriture des objets
Python vers un média de stockage, qui peut être un fichier sur le disque (la
classe <tt class="xref py py-class docutils literal"><span class="pre">FileStorage</span></tt>), un fichier BerkleyDB (<tt class="xref py py-class docutils literal"><span class="pre">BDBFullStorage</span></tt>),
une base de données relationnelle (<tt class="xref py py-class docutils literal"><span class="pre">DCOracleStorage</span></tt>), ou tout autre
média. La ZEO ajoute <tt class="xref py py-class docutils literal"><span class="pre">ClientStorage</span></tt>, un nouveau <tt class="xref py py-class docutils literal"><span class="pre">Storage</span></tt> qui
n'écrit pas vers un média physique mais qui envoie chaque requête à travers le
réseau vers un serveur. Le serveur qui fait fonctionner une instance de la
classe <tt class="xref py py-class docutils literal"><span class="pre">StorageServer</span></tt>, va simplement agir comme le 'front end' d'un
média physique de la classe <tt class="xref py py-class docutils literal"><span class="pre">Storage</span></tt>. C'est une idée simple et efficace
qui comme on le verra dans la suite du document ouvre énormément de
possibilités.</p>
</div>
<div class="section" id="a-propos-de-ce-guide">
<h2>À propos de ce guide<a class="headerlink" href="#a-propos-de-ce-guide" title="Lien permanent vers ce titre">¶</a></h2>
<p>Les premiers auteurs de ce guide travaillaient sur un projet qui
utilisait la ZODB et ZEO comme principale technologie de stockage. Ils
utilisaient la ZODB pour y stocker les processus, les opérations, un catalogue
des processus possibles, des informations utilisateurs, des informations sur les
comptes et autres données. Un des objectifs de ce document et de partager notre
expérience. Ce guide est un concentré de toute l'expérience acquise lors des
nombreuses heures passées à essayer de résoudre un problème. Il a pour but
d'éviter à d'autres de passer du temps sur les même erreurs que celles que nous
avons faites lors de notre apprentissage.</p>
<p>Les auteurs du projet ZODB sont présentés dans un article accessible ici
<a class="reference external" href="http://www.amk.ca/python/writing/mx-architecture/">http://www.amk.ca/python/writing/mx-architecture/</a></p>
<p>Ce guide et en évolution constante. Si vous souhaitez contribuer et suggérer des
éclaircissements ou de nouveau chapitre, envoyez vos commentaires à <a class="reference external" href="mailto:de&#37;&#52;&#48;zope&#46;org">de<span>&#64;</span>zope<span>&#46;</span>org</a>.</p>
</div>
<div class="section" id="remerciements">
<h2>Remerciements<a class="headerlink" href="#remerciements" title="Lien permanent vers ce titre">¶</a></h2>
<p>Andrew Kuchling est l'auteur initial de la première version anglaise de ce
guide, il a fournit la première documentation de la ZODB pour les programmeur
Python. Sa version a été complété de nombreuse fois par Jeremy Hylton et Tim
Peters.</p>
<p>Les auteurs remercient les personnes qui ont relevé les inexactitudes et les
bogues, qui ont proposé des suggestions sur le texte, ou de nouveau sujet qui
ont put être traités : Jeff Bauer, Willem Broekema, Thomas Guettler, Chris
McDonough, George Runyan.</p>
<p>Traduction en Français par Michael Launay</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<p class="logo"><a href="../index.html"><img src="../_static/plone-icon-64.png" />
</a></p>

  <h3><a href="../index.html">Table des matières</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction</a><ul>
<li><a class="reference internal" href="#qu-est-ce-que-la-zodb">Qu'est ce que la ZODB ?</a></li>
<li><a class="reference internal" href="#oodbs-vs-dbs-relationnelles">OODBs vs. DBs relationnelles</a></li>
<li><a class="reference internal" href="#qu-est-ce-que-la-zeo">Qu'est ce que la ZEO ?</a></li>
<li><a class="reference internal" href="#a-propos-de-ce-guide">À propos de ce guide</a></li>
<li><a class="reference internal" href="#remerciements">Remerciements</a></li>
</ul>
</li>
</ul>

  <h4>Sujet précédent</h4>
  <p class="topless"><a href="index.html"
                        title="Chapitre précédent">ZODB - Une Base de données objet native pour python</a></p>
  <h4>Sujet suivant</h4>
  <p class="topless"><a href="tutorial.html"
                        title="Chapitre suivant">Tutoriel</a></p>
  <h3>Cette page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/zodb/introduction.txt"
           rel="nofollow">Montrer la source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Recherche rapide</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Saisissez un mot clef ou un nom de module, classe ou fonction.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="Index général"
             >index</a></li>
        <li class="right" >
          <a href="tutorial.html" title="Tutoriel"
             >suivant</a> |</li>
        <li class="right" >
          <a href="index.html" title="ZODB - Une Base de données objet native pour python"
             >précédent</a> |</li>
        <li><a href="../index.html">Formation Plone</a> &raquo;</li>
          <li><a href="index.html" >ZODB - Une Base de données objet native pour python</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2010-2013, Communauté Plone francophone.
      Mis à jour le  07-February-2013.
      Créé avec <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>

<hr />
<div id="disqus_thread">
</div>
<script type="text/javascript"
        src="http://disqus.com/forums/plonepourlesintgrateurs/embed.js">
</script>
<noscript>
  <a href="http://disqus.com/forums/plonepourlesintgrateurs/?url=ref">
    View the discussion thread.
  </a>
</noscript>
<a href="http://disqus.com"
   class="dsq-brlink">blog comments powered by
  <span class="logo-disqus">Disqus</span>
</a>
<script type="text/javascript">
//<![CDATA[
(function() {
  var links = document.getElementsByTagName('a');
  var query = '?';
  for(var i = 0; i < links.length; i++) {
    if(links[i].href.indexOf('#disqus_thread') >= 0) {
      query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
    }
    // Not a Jinja end block
  }
  document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/plonepourlesintgrateurs/get_num_replies.js' + query + '"></' + 'script>');
})();
//]]>
</script>


  </body>
</html>